!function(e){function t(t){for(var n,s,r=t[0],l=t[1],c=t[2],h=0,d=[];h<r.length;h++)s=r[h],Object.prototype.hasOwnProperty.call(a,s)&&a[s]&&d.push(a[s][0]),a[s]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n]);for(u&&u(t);d.length;)d.shift()();return o.push.apply(o,c||[]),i()}function i(){for(var e,t=0;t<o.length;t++){for(var i=o[t],n=!0,r=1;r<i.length;r++){var l=i[r];0!==a[l]&&(n=!1)}n&&(o.splice(t--,1),e=s(s.s=i[0]))}return e}var n={},a={2:0},o=[];function s(t){if(n[t])return n[t].exports;var i=n[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,s),i.l=!0,i.exports}s.m=e,s.c=n,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(i,n,function(t){return e[t]}.bind(null,n));return i},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="./assets/js/";var r=window.webpackJsonp=window.webpackJsonp||[],l=r.push.bind(r);r.push=t,r=r.slice();for(var c=0;c<r.length;c++)t(r[c]);var u=l;o.push([116,1,4,0]),i()}({10:function(e,t,i){"use strict";function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}i.d(t,"a",(function(){return o}));var o=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.origin=new PIXI.Point,this._ln,this._rn,this._length,this._lcalcX,this._lcalcY,this._lorigX,this._lorigY,this.x=t,this.y=i,this.origin=new PIXI.Point("number"==typeof n?n:t,"number"==typeof a?a:i)}return a(e,null,[{key:"distance",value:function(t,i){return new e(t.x,t.y,i.x,i.y).length}}]),a(e,[{key:"dotProduct",value:function(e){return this.length*e.length*this.cosineTo(e)}},{key:"perpProduct",value:function(e){return this.leftNormal.length*e.length*this.perpCosineTo(e)}},{key:"project",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new e;t.clone(i);var n=this.length*this.cosineTo(i);return i.normalize(n),i}},{key:"angleTo",value:function(e){return Math.acos(this.cosineTo(e))}},{key:"cosineTo",value:function(e){return(this.vx*e.vx+this.vy*e.vy)/(this.length*e.length)}},{key:"perpCosineTo",value:function(e){var t=this.leftNormal;return(t.vx*e.vx+t.vy*e.vy)/(t.length*e.length)}},{key:"add",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new e;return i.x=this.x+(t instanceof e?t.vx:t.x),i.y=this.y+(t instanceof e?t.vy:t.y),i.origin.x=this.origin.x,i.origin.y=this.origin.y,i}},{key:"subtract",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new e;return i.x=this.x-(t instanceof e?t.vx:t.x),i.y=this.y-(t instanceof e?t.vy:t.y),i.origin.x=this.origin.x,i.origin.y=this.origin.y,i}},{key:"equals",value:function(t){return this.x===t.x&&this.y===t.y&&(t instanceof e?!!t.origin.equals(this.origin):0==this.origin.x&&0==this.origin.y)}},{key:"intersection",value:function(t){var i=new e(t.origin.x,t.origin.y,this.origin.x,this.origin.y).perpProduct(t)/this.perpProduct(t),n=new PIXI.Point(this.origin.x+this.vx*i,this.origin.y+this.vy*i);return n}},{key:"normalize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this.length;if(t>0){var i=e/t;this.x=this.origin.x+this.vx*i,this.y=this.origin.y+this.vy*i}}},{key:"set",value:function(e,t){this.x=e,this.y=t}},{key:"clone",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new e;return t.set(this.x,this.y),t.origin=this.origin.clone(),t}},{key:"length",get:function(){if(this.x!=this._lcalcX||this.y!=this._lcalcY||this.origin.x!=this._lorigX||this.origin.y!=this._lorigY){var e=this.x-this.origin.x,t=this.y-this.origin.y;this._length=Math.sqrt(e*e+t*t),this._lcalcX=this.x,this._lcalcY=this.y,this._lorigX=this.origin.x,this._lorigY=this.origin.y}return this._length}},{key:"leftNormal",get:function(){return this._ln||(this._ln=new e),this._ln.origin.x=this.origin.x,this._ln.origin.y=this.origin.y,this._ln.x=this._ln.origin.x+this.vy,this._ln.y=this._ln.origin.y-this.vx,this._ln}},{key:"rightNormal",get:function(){return this._rn||(this._rn=new e),this._rn.origin.x=this.origin.x,this._rn.origin.y=this.origin.y,this._rn.x=this._rn.origin.x-this.vy,this._rn.y=this._rn.origin.y+this.vx,this._rn}},{key:"vx",get:function(){return this.x-this.origin.x}},{key:"vy",get:function(){return this.y-this.origin.y}}]),e}()},116:function(e,t,i){i(228),e.exports=i(112)},12:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i(9),a=i(14),o=i(17);function s(e){return function(e){if(Array.isArray(e)){for(var t=0,i=new Array(e.length);t<e.length;t++)i[t]=e[t];return i}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function r(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var l=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.animData=t||[],this.elements=i,this.animations={},this.numAnims=0,this.console=new a.a(this),e.DEBUG||this.console.disable()}var t,i,l;return t=e,(i=[{key:"play",value:function(e,t,i,n,a){var o,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};if(this.animations[e])o=this.animations[e];else{if(!a)return void this.console.warn("!! Animation",e,"not created. Please pass in elements and the name of the animation to create.");o=this.setupAnimation(e,n,a,s)}return o.fixed||this.refreshAnimation(e),this.console.log("Playing anim",e,t),o.timeline.play(t),i&&o.endCallbacks.push(i),o.id}},{key:"pause",value:function(e,t){this.animations[e]?this.animations[e].timeline.pause(t):this.console.warn("!! Could not pause:",e,"animation not created.")}},{key:"stop",value:function(e){if(this.animations[e]){var t=this.animations[e];t.timeline.pause(0),t.fixed||this.refreshAnimation(e)}else this.console.warn("!! Could not stop:",e,"animation not created.")}},{key:"reverse",value:function(e,t){if(this.animations[e]){var i=this.animations[e];i.fixed||this.refreshAnimation(e),i.timeline.reverse(t)}else this.console.warn("!! Could not reverse:",e,"animation not created.")}},{key:"isPlaying",value:function(e){return!!this.animations[e]&&this.animations[e].timeline.isActive()}},{key:"setTimeScale",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(!this.animations[e])return!1;var i=this.animations[e];i.timeline.timeScale(t)}},{key:"addDefinition",value:function(e){return this.animData=this.animData.concat(e),this}},{key:"setupAnimation",value:function(e,t){var i=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.elements,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},s=a.delay,r=a.repeat,l=a.yoyo,c=a.onComplete,u=a.onCompleteParams,h=a.onStart,d=a.onStartParams,f=a.onUpdate,p=a.onUpdateParams,y=a.onLabel,m=a.onLabelParams,v=a.onLabelStart,g=a.onLabelStartParams,b=a.onLabelEnd,w=a.onLabelEndParams,k=a.tweenVars,S=a.timeScale,x={},_=this.getAnimationData(t);if(e||(e="anim"+this.numAnims),_){this.console.log("Setting up animation",e,t);var I=new o.a({onComplete:function(e){return i._onAnimComplete(e)},onCompleteParams:[x],onStart:function(e){return i._onAnimStart(e)},onStartParams:[x],onUpdate:function(e){return i._onAnimUpdate(e)},onUpdateParams:[x],autoRemoveChildren:!_.fixed,delay:s||_.delay,repeat:r||_.repeat,yoyo:l||_.yoyo});return I.timeScale(_.timeScale||S||1),x.id=e,x.elements=n,x.timeline=I,x.name=t,x.fixed=_.fixed||!1,x.removeOnEnd=_.removeOnEnd,x.endCallbacks=[],x.onComplete=c,x.onCompleteParams=u,x.onStart=h,x.onStartParams=d,x.onLabel=y,x.onLabelParams=m,x.onLabelStart=v,x.onLabelStartParams=g,x.onLabelEnd=b,x.onLabelEndParams=w,x.onUpdate=f,x.onUpdateParams=p,x.tweenVars=k||{},this.animations[e]&&this.clear(e),this.animations[e]=x,x.fixed&&this.refreshAnimation(x.id),I.pause(),this.numAnims++,x}this.console.warn("!! Could not create animation for animID:",e,". Animation '",t,"' not defined.")}},{key:"refreshAnimation",value:function(e){var t=this.animations[e];if(t){t.timeline.clear(!1);var i=this.getAnimationData(t.name);i.timeline?this._setupTimeline(t.timeline,i.timeline,t.elements,i.labels,t):(i.labels&&this._setupLabels(i.labels,t),this._setupTweens(t.elements,i.tweens,t.timeline,t))}else this.console.warn("!! Animation not setup:",e)}},{key:"_setupTimeline",value:function(e,t,i,n,a){n&&this._setupLabels(n,a);for(var o=0;o<t.length;o++){var s=t[o],r=i[s.element];this._setupTweens(r,s.tweens,e,a)}return e}},{key:"_setupLabels",value:function(e,t){for(var i=this,n=0;n<e.length;n++){var a=e[n];t.timeline.addLabel(a.name,a.position),t.timeline.addCallback((function(e,t){return i._onLabel(e,t)}),a.name,[t,a.name]),a.pause&&(this.console.log("Adding pause on label",a.name),t.timeline.addPause(a.name))}}},{key:"_setupTweens",value:function(e,t,i,a){for(var o,s=0;s<t.length;s++){var r=t[s],l=void 0,c=void 0,u=void 0,h={},d={};for(var f in r.hasOwnProperty("property")?(l=String(r.property).split("."),"tween"==r.property&&o?u=o:l.length>1?(u=e[l[0]],c=l[1]):(u=e,c=l[0])):u=e,r.params){var p=void 0;"rotation"==f?p=n.a.toRadians(r.params[f]):"string"==typeof(p=r.params[f])&&(p=a.tweenVars.hasOwnProperty(p)?a.tweenVars[p]:p),h[f]=p}if(r.from)for(var f in r.from){var y=void 0;"rotation"==f?y=n.a.toRadians(r.from[f]):"string"==typeof(y=r.from[f])&&(y=a.tweenVars.hasOwnProperty(y)?a.tweenVars[y]:y),d[f]=y}var m=c?u[c]:u;null==!m?this.console.warn("!! No tween target for element",c||u):o="fromTo"==r.type?i.fromTo(m,r.duration,d,h,r.label||r.time):"set"==r.type?i.set(m,h,r.label||r.time):i[r.type](m,r.duration,h,r.label||r.time)}}},{key:"clear",value:function(e){var t;if(e){if(!(t=this.animations[e]))return;t.timeline.kill().clear(),this.animations[e]=null,delete this.animations[e]}else for(var i in this.animations)(t=this.animations[i]).timeline.kill().clear(),t.elements=null,this.animations[i]=null,delete this.animations[i]}},{key:"destroy",value:function(){this.clear(),this.animations=null,this.elements=null,this.animData=null,delete this.elements,delete this.animations,delete this.animData}},{key:"getAnimationData",value:function(e){return this.animData.find((function(t){return t.name==e}))}},{key:"_onLabel",value:function(e,t){this.console.log("Now on label '",t,"' for anim id '",e.id,"'");var i=e.currentLabel;e.currentLabel=t,e.onLabel&&(e.onLabelParams?e.onLabel.apply(e,[t].concat(s([].concat(e.onLabelParams)))):e.onLabel(t)),e.onLabelStart&&(e.onLabelStartParams?e.onLabelStart.apply(e,[t].concat(s([].concat(e.onLabelStartParams)))):e.onLabelStart(t)),i&&e.onLabelEnd&&(e.onLabelEndParams?e.onLabelEnd.apply(e,[i].concat(s([].concat(e.onLabelEndParams)))):e.onLabelEnd(i))}},{key:"_onAnimComplete",value:function(e){for(this.animData[e.id],e.currentLabel&&e.onLabelEnd&&e.onLabelEnd(e.currentLabel),this.console.log("Anim complete",e.id),e.onComplete&&(e.onCompleteParams?e.onComplete.apply(e,[e.id].concat(s([].concat(e.onCompleteParams)))):e.onComplete(e.id));e.endCallbacks.length;)e.endCallbacks.shift()(e);e.currentLabel=null,e.removeOnEnd&&this.clear(e.id)}},{key:"_onAnimUpdate",value:function(e){this.animData[e.id],e.onUpdate&&(e.onUpdateParams?e.onUpdate.apply(e,[e.id].concat(s([].concat(e.onUpdateParams)))):e.onUpdate(e.id))}},{key:"_onAnimStart",value:function(e){this.animData[e.id],this.console.log("Anim started",e.id),e.onStart&&(e.onStartParams?e.onStart.apply(e,[e.id].concat(s([].concat(e.onStartParams)))):e.onStart(e.id))}}])&&r(t.prototype,i),l&&r(t,l),e}()},14:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i(15);function a(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),window.console&&(this.cls=t,this.styles={default:"",class:"color: #cccccc; font-weight: bold;"},n.a.DEBUG?this.enable():this.disable())}var t,i,o;return t=e,(i=[{key:"addStyle",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.styles[e]=this.styles[e]&&!i?"".concat(this.styles[e]," ").concat(t):"".concat(t),this.enabled&&this.enable()}},{key:"enable",value:function(){if(n.a.DEBUG){var e=this.cls;for(var t in console)"function"==typeof console[t]&&(this[t]="table"==t?console[t].bind(window.console):"time"==t||"timeEnd"==t?console[t].bind(window.console,"[".concat(e.constructor.name,"]")):console[t].bind(window.console,"%c[".concat(e.constructor.name,"]%c"),this.styles.class,this.styles.default));this.enabled=!0}}},{key:"disable",value:function(){var e=function(){};for(var t in console)"function"==typeof console[t]&&(this[t]=e);this.enabled=!1}},{key:"destroy",value:function(){this.cls=null}}])&&a(t.prototype,i),o&&a(t,o),e}()},15:function(e,t,i){"use strict";var n=i(40);function a(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=void 0!==t?t:{},this.canvas=void 0!==t.canvas?t.canvas:null,this.stage=void 0!==t.stage?t.stage:null,this.scaleController=void 0!==t.scaleController?t.scaleController:"default",this.safeSize=void 0!==t.safeSize?t.safeSize:{width:1280,height:720},this.maxSize=void 0!==t.maxSize?t.maxSize:{width:1280,height:720},null!==this.canvas&&"default"===this.scaleController&&(this.canvas.style.position="absolute",this.canvas.style.top="50%",this.canvas.style.left="50%",this.canvas.style.width=this.canvas.width=this.maxSize.width,this.canvas.style.height=this.canvas.height=this.maxSize.height),this.safeAspect=this.safeSize.width/this.safeSize.height,this.maxAspect=this.maxSize.width/this.safeSize.height,this.minAspect=this.safeSize.width/this.maxSize.height,this.scale=1,this.screenAspect=1,this.maintainAspect="fit"!=this.scaleController,this.stageBounds={top:0,right:0,bottom:0,left:0,centerX:this.maxSize.width/2,centerY:this.maxSize.height/2},this.renderer=t.hasOwnProperty("renderer")?t.renderer:null,this.layoutItems=[],this.onResize=new signals.Signal}var t,i,n;return t=e,(i=[{key:"resize",value:function(){switch(this.scaleController){case"default":this.scaleDefault();break;case"jsembed":this.scaleJsembed();break;case"fit":this.scaleFit();break;default:this.scaleDefault()}this.getStageBounds(),this.updateLayout(),this.onResize.dispatch()}},{key:"addItem",value:function(e,t){var i=void 0!==t.align?t.align:"top-left";this.layoutItems.push({displayObject:e,align:i.split("-"),x:t.x,y:t.y}),this.updateLayout()}},{key:"removeItem",value:function(e){for(var t=0;t<this.layoutItems.length;t++)if(this.layoutItems[t].displayObject===e)return void this.layoutItems.splice(t,1)}},{key:"updateLayout",value:function(){for(var e=0;e<this.layoutItems.length;e++){var t=this.layoutItems[e];"number"==typeof t.y&&t.align[0]&&("top"===t.align[0]?t.displayObject.y=t.y+this.stageBounds.top:"bottom"===t.align[0]?t.displayObject.y=this.stageBounds.bottom-t.y:t.displayObject.y=t.y+this.stageBounds.centerY),"number"==typeof t.x&&t.align[1]&&("left"===t.align[1]?t.displayObject.x=t.x+this.stageBounds.left:"right"===t.align[1]?t.displayObject.x=this.stageBounds.right-t.x:t.displayObject.x=t.x+this.stageBounds.centerX)}}},{key:"getStageBounds",value:function(){if(!this.maintainAspect||this.screenAspect>this.maxAspect)this.stageBounds.left=0;else if(this.screenAspect<this.safeAspect)this.stageBounds.left=(this.maxSize.width-this.safeSize.width)/2;else{var e=document.body.clientWidth/this.scale;this.stageBounds.left=(this.maxSize.width-e)/2}if(this.maintainAspect?this.stageBounds.right=this.maxSize.width-this.stageBounds.left:this.stageBounds.right=this.canvas.clientWidth-this.stageBounds.left,!this.maintainAspect||this.screenAspect<this.minAspect)this.stageBounds.top=0;else if(this.screenAspect>this.safeAspect)this.stageBounds.top=(this.maxSize.height-this.safeSize.height)/2;else{var t=document.body.clientHeight/this.scale;this.stageBounds.top=(this.maxSize.height-t)/2}return this.maintainAspect?this.stageBounds.bottom=this.maxSize.height-this.stageBounds.top:this.stageBounds.bottom=this.canvas.clientHeight-this.stageBounds.top,this.stageBounds.width=this.stageBounds.right-this.stageBounds.left,this.stageBounds.height=this.stageBounds.bottom-this.stageBounds.top,this.stageBounds.centerX=this.stageBounds.left+this.stageBounds.width/2,this.stageBounds.centerY=this.stageBounds.top+this.stageBounds.height/2,this.stageBounds}},{key:"getSafeBounds",value:function(){return this.safeSize.left=(this.maxSize.width-this.safeSize.width)/2,this.safeSize.right=this.maxSize.width-(this.maxSize.width-this.safeSize.width)/2,this.safeSize.top=(this.maxSize.height-this.safeSize.height)/2,this.safeSize.bottom=this.maxSize.height-(this.maxSize.height-this.safeSize.height)/2,this.safeSize.centerX=this.maxSize.width/2,this.safeSize.centerY=this.maxSize.height/2,this.safeSize}},{key:"getMaxBounds",value:function(){return this.maxSize.left=0,this.maxSize.right=this.maxSize.width,this.maxSize.top=0,this.maxSize.bottom=this.maxSize.height,this.maxSize.centerX=this.maxSize.width/2,this.maxSize.centerY=this.maxSize.height/2,this.maxSize}},{key:"scaleFit",value:function(){this.canvas.style.width="100%",this.canvas.style.height="100%";var e=this.canvas.clientWidth,t=this.canvas.clientHeight;this.renderer.resize(e,t),this.screenAspect=this.maxAspect}},{key:"scaleDefault",value:function(){var e=document.body.clientWidth,t=document.body.clientHeight;this.screenAspect=e/t,this.screenAspect<this.safeAspect?this.scale=e/this.safeSize.width:this.scale=t/this.safeSize.height;var i="translate(-50%, -50%) scale("+this.scale+")";this.canvas.style.transform=i}},{key:"scaleJsembed",value:function(){if(!jsembed.exists())throw"Cannot find JSEmbed";this.canvas.width=jsembed.scaledWidth(),this.canvas.height=jsembed.scaledHeight(),this.stage.scaleX=this.stage.scaleY=jsembed.canvasScale()}}])&&a(t.prototype,i),n&&a(t,n),e}();function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var l=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=void 0!==t?t:{},createjs.Sound.registerPlugins([createjs.WebAudioPlugin,createjs.HTMLAudioPlugin]),createjs.Sound.on("fileload",this.onSoundLoad,this),this.soundList={},this.categories={},this.paused=!1,this.muted=!1,this.volume=1,this.instances=createjs.Sound.activePlugin._soundInstances,createjs.Sound.activePlugin.context&&window.addEventListener("click",this.autoplayFix)}var t,i,n;return t=e,(i=[{key:"setVolume",value:function(e,t){var i=this;if(t){var n=this.categories[t];n?(n.volume=e,n.mute||n.list.forEach((function(e){i.getInstances(e).forEach((function(t){return i.setInstanceVolume(t,e)}))}))):console.warn("! no sound category for",t,"exists")}else"number"==typeof e&&this.volume!=e&&(this.volume=e,createjs.Sound.volume=this.volume)}},{key:"setMute",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],i=arguments.length>1?arguments[1]:void 0;if(i){var n=this.categories[i];n&&(n.mute=t,n.list.forEach((function(t){e.getInstances(t).forEach((function(i){return e.setInstanceVolume(i,t)}))})))}else this.muted!=t&&(this.muted=t,createjs.Sound.volume=this.muted?0:this.volume)}},{key:"setInstanceVolume",value:function(e,t){var i=this.findCategoryForAlias(t)||{volume:1,mute:!1},n=this.soundList[t].options;e.volume=i.mute?0:(n.volume||1)*i.volume}},{key:"addSounds",value:function(e,t,i){if(t){var n=this.categories[t];n?n.list=n.list.concat(e.filter((function(e){return-1==n.list.indexOf(e.id)})).map((function(e){return e.id}))):this.addCategory(t,e.map((function(e){return e.id})),i)}for(var a=0;a<e.length;a++){var o=e[a];this.soundList[o.id]||(this.soundList[o.id]={id:o.id,src:o.src,loaded:!1,playAfterLoad:!1,instanceAfterLoad:!1,callback:null,options:{}},!0===o.preload&&this.loadSound(this.soundList[o.id]))}}},{key:"addCategory",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=i.volume,a=i.mute;this.categories[e]&&console.warn("! Category for this sound already exist and will be overwritten");var o={};o.list=t,o.volume=n||1,o.mute=a,this.categories[e]=o}},{key:"isInCategory",value:function(e,t){return this.categories[t].list.find((function(t){return e==t}))}},{key:"findCategoryForAlias",value:function(e){for(var t in this.categories){var i=this.categories[t];if(i.list.find((function(t){return e==t})))return i}}},{key:"loadSound",value:function(e,t){void 0!==t&&(e.callback=t),createjs.Sound.registerSound(e.src,e.id)}},{key:"loadSoundThenPlay",value:function(e,t){void 0!==t&&(e.callback=t),e.playAfterLoad=!0,createjs.Sound.registerSound(e.src,e.id)}},{key:"loadSoundThenInstance",value:function(e,t){void 0!==t&&(e.callback=t),e.instanceAfterLoad=!0,createjs.Sound.registerSound(e.src,e.id)}},{key:"onSoundLoad",value:function(e){var t,i=this.soundList[e.id];if(i.loaded=!0,i.playAfterLoad){var n=Object.assign({},i.options),a=this.findCategoryForAlias(e.id);a&&(n.volume=a.mute?0:(n.volume||1)*a.volume),t=createjs.Sound.play(i.id,n),!0===this.paused&&(t.paused=!0)}else i.instanceAfterLoad&&(t=createjs.Sound.createInstance(i.id),!0===this.paused&&(t.paused=!0));i.callback&&i.callback(t)}},{key:"autoplayFix",value:function(){try{"suspended"===createjs.Sound.activePlugin.context.state&&!1===this.paused&&(createjs.Sound.activePlugin.context.resume(),window.removeEventListener("click",this.autoplayFix))}catch(e){console.error("There was an error while trying to resume the SoundJS Web Audio context..."),console.error(e)}}},{key:"getInstances",value:function(e){if(void 0!==e){var t=createjs.Sound._getSrcById(e);return"object"===s(t)&&t.hasOwnProperty("src")?(t=t.src,this.instances[t]?this.instances[t]:[]):[]}}},{key:"getInstance",value:function(e,t,i){if(t=t||{},i=i||function(){},this.soundList[e])if(!1===this.soundList[e].loaded)this.soundList[e].options=t,this.loadSoundThenInstance(this.soundList[e],i);else{var n=createjs.Sound.createInstance(e);!0===this.paused&&(n.paused=!0),i(n)}else console.error(e+" is not a registered sound"),i(!1)}},{key:"play",value:function(e,t,i){if(t=t||{},i=i||function(){},this.soundList[e])if(!1===this.soundList[e].loaded)this.soundList[e].options=t,this.loadSoundThenPlay(this.soundList[e],i);else{var n=this.findCategoryForAlias(e),a=Object.assign({},t);n&&(a.volume=n.mute?0:(t.volume||1)*n.volume);var o=createjs.Sound.play(e,a);!0===this.paused&&(o.paused=!0),i(o)}else console.error(e+" is not a registered sound"),i(!1)}},{key:"stop",value:function(e){this.soundList[e]&&(this.soundList[e].playAfterLoad=!1,this.soundList[e].instanceAfterLoad=!1,this.soundList[e].callback=null),this.getInstances(e).forEach(this.stopInstance)}},{key:"stopAll",value:function(){createjs.Sound.stop()}},{key:"stopInstance",value:function(e){e.stop()}},{key:"pause",value:function(e){void 0!==e?this.getInstances(e).forEach(this.pauseInstance):this.pauseAll()}},{key:"pauseAll",value:function(){for(var e in this.paused=!0,this.instances)this.instances[e].forEach(this.pauseInstance)}},{key:"pauseInstance",value:function(e){"playSucceeded"!==e.playState&&"playInited"!==e.playState||(e.paused=!0)}},{key:"resume",value:function(e){void 0===e&&this.resumeAll();var t=createjs.Sound._getSrcById(e);"object"===s(t)&&t.hasOwnProperty("src")&&(t=t.src,this.instances[t]&&this.instances[t].forEach(this.resumeInstance))}},{key:"isLoaded",value:function(e){return this.soundList[e]&&this.soundList[e].loaded}},{key:"resumeAll",value:function(){for(var e in this.paused=!1,this.instances)this.instances[e].forEach(this.resumeInstance)}},{key:"resumeInstance",value:function(e){"playSucceeded"!==e.playState&&"playInited"!==e.playState||(e.paused=!1)}}])&&r(t.prototype,i),n&&r(t,n),e}(),c=i(17);function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var d=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.init()}var t,i,n;return t=e,(i=[{key:"init",value:function(){this.tl=new TimelineMax,this.currentVO=null,this.currentList=[],this.completeCallback=null,this.playing=!1,this.captions=!1,this.captionsMuted=!0,this.captionPlayer=null,this._prompts={},this._promptLists={},this.listStart=new signals.Signal,this.soundStart=new signals.Signal,this.soundEnd=new signals.Signal,this.listPaused=new signals.Signal,this.listResumed=new signals.Signal}},{key:"update",value:function(e){!0===this.captions&&!1===this.captionsMuted&&this.captionPlayer.update(e.delta/1e3)}},{key:"addPrompt",value:function(e,t){this._prompts[e]=t}},{key:"requirePromptFor",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"interact",i=this._promptLists[t];i||(i=[],this._promptLists[t]=i);var n=function(e){i.find((function(t){return t==e}))||i.push(e)};Array.isArray(e)?e.forEach((function(e){return n(e)})):n(sound)}},{key:"play",value:function(e,t){var i=this,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("string"==typeof e)e=[e];else if(!Array.isArray(e)||!e.length)return void console.error("List "+e+" is not valid!");"function"!=typeof t&&(t=function(){}),this.stop(),this.currentList=this._validateList(e),this.completeCallback=t,this.playing=!0;var a=this.currentList.filter((function(e){return"string"==typeof e&&!game.sound.isLoaded(e)}));n&&a&&a.length?a.forEach((function(t,n){game.sound.getInstance(t,{},(function(n){a.splice(a.indexOf(t),1),a.length||(i.advanceTimeline(),i.listStart.dispatch({list:e.concat()}))}))})):(this.advanceTimeline(),this.listStart.dispatch({list:e.concat()}))}},{key:"pause",value:function(){this.tl.pause(),this.listPaused.dispatch({})}},{key:"resume",value:function(){this.tl.resume(),this.listResumed.dispatch({})}},{key:"stop",value:function(){c.b.killTweensOf(this),this.tl.clear(),this.tl=new TimelineMax,this.currentVO&&game.sound.stop(this.currentVO),this.currentVO=null,this.currentList=[],this.completeCallback=null,this.playing=!1}},{key:"advanceTimeline",value:function(){if(this.currentList.length){var e=this.currentList.shift();this.handleListItem(e)}else this.onComplete()}},{key:"handleListItem",value:function(e){switch(this.currentVO=null,u(e)){case"string":this.currentVO=e,game.sound.getInstance(e,{},function(t){this.playSound(e,t)}.bind(this));break;case"number":this.tl.clear(),this.tl=new TimelineMax,this.tl.set(this,{},"+="+e),this.tl.call(this.advanceTimeline,[],this);break;case"function":e(),this.advanceTimeline();break;default:console.error("Cannot add item of type "+u(e)+" to VO timeline"),this.advanceTimeline()}}},{key:"playSound",value:function(e,t){var i=this;t.on("complete",(function(n){i.soundEnd.dispatch({soundID:e,sound:t}),i.advanceTimeline()})),t.play(),this.soundStart.dispatch({soundID:e,sound:t}),!0===this.captions&&!1===this.captionsMuted&&this.captionPlayer.captions[e]&&this.captionPlayer.start(e)}},{key:"clearSignals",value:function(){this.listStart.removeAll(),this.soundStart.removeAll(),this.soundEnd.removeAll(),this.listPaused.removeAll(),this.listResumed.removeAll()}},{key:"setupCaptions",value:function(e,t){this.captions=!0,this.captionsMuted=t,this.captionPlayer=e}},{key:"setCaptionsMuted",value:function(e){"boolean"==typeof e&&(this.captionsMuted=e,!0===this.captionsMuted&&this.captionPlayer.stop())}},{key:"_validateList",value:function(e){var t=this;return e.flatMap((function(e){if("string"==typeof e){for(var i in t._prompts){var n=t._promptLists[i],a=t._prompts[i];if(n&&a&&n.find((function(t){return t==e})))return[a,e]}return e}return e}))}},{key:"onComplete",value:function(){"function"==typeof this.completeCallback&&this.completeCallback(),this.playing=!1}}])&&h(t.prototype,i),n&&h(t,n),e}();function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v(e,t){return(v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var g=function(e){function t(e,i){var n,a,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,(n=!(o=y(t).call(this,e))||"object"!==f(o)&&"function"!=typeof o?m(a):o)._cursors={},n._cursorMode="default",n.addCursor("default",e,i),n.anchor.set(.5),n.onHighlight=n.onHighlight.bind(m(n)),n.onUnhighlight=n.onUnhighlight.bind(m(n)),n.currentCursorMode="default",n.init(),n}var i,n,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v(e,t)}(t,PIXI.Sprite),i=t,(n=[{key:"init",value:function(){game.pixiApp.view.style.cursor="none"}},{key:"update",value:function(e){this.x=Math.max(0,game.renderer.plugins.interaction.mouse.global.x),this.y=Math.max(0,game.renderer.plugins.interaction.mouse.global.y),this.currentCursorMode!==game.renderer.plugins.interaction.currentCursorMode&&this.changeCursor(game.renderer.plugins.interaction.currentCursorMode)}},{key:"changeCursor",value:function(e){"pointer"===e?this.onHighlight():this.onUnhighlight(),this.currentCursorMode=e,game.pixiApp.view.style.cursor="none"}},{key:"changeCursorMode",value:function(e){this._cursorMode=e||"default",this.onUnhighlight()}},{key:"addCursor",value:function(e,t,i){this._cursors[e]={highlight:i,idle:t}}},{key:"onHighlight",value:function(){this.texture=this._cursors[this._cursorMode].highlight}},{key:"onUnhighlight",value:function(){this.texture=this._cursors[this._cursorMode].idle}},{key:"cursorMode",get:function(){return this._cursorMode}}])&&p(i.prototype,n),a&&p(i,a),t}();function b(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var w=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.onFocus=t||function(){},this.onBlur=i||function(){},this.onToggle=this.onToggle.bind(this),this._visibilityChange=null,void 0!==document.hidden?this._visibilityChange="visibilitychange":void 0!==document.mozHidden?this._visibilityChange="mozvisibilitychange":void 0!==document.msHidden?this._visibilityChange="msvisibilitychange":void 0!==document.webkitHidden&&(this._visibilityChange="webkitvisibilitychange"),this.init()}var t,i,n;return t=e,(i=[{key:"init",value:function(){var e=this;document.addEventListener(this._visibilityChange,(function(t){return e.onToggle(t)})),window.addEventListener("pagehide",this.onBlur),window.addEventListener("pageshow",this.onFocus),window.addEventListener("blur",this.onBlur),window.addEventListener("focus",this.onFocus),window.addEventListener("visibilitychange",this.onToggle,!1)}},{key:"onToggle",value:function(e){document.hidden||document.webkitHidden||document.msHidden||document.mozHidden?this.onBlur():this.onFocus()}}])&&b(t.prototype,i),n&&b(t,n),e}(),k=i(4),S=i(5),x=i(18),_=i(14),I=i(19),T=i(57),E=i(114);function A(e){return(A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function O(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function P(e,t,i){return t&&O(e.prototype,t),i&&O(e,i),e}i.d(t,"a",(function(){return C}));var C=function(){function e(t){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=void 0!==t?t:{},this.gotoScene=this.gotoScene.bind(this),this.loadScenes=this.loadScenes.bind(this),this.mountScene=this.mountScene.bind(this),this.startScene=this.startScene.bind(this),this.pause=this.pause.bind(this),this.resume=this.resume.bind(this),this.buildEnv=void 0!==t.buildEnv?t.buildEnv:"production",this.springrollApp,this.useSpringroll=void 0!==t.springroll&&t.springroll,this.canvasParent=void 0!==t.canvasParent?t.canvasParent:"game",this.maxSize=void 0!==t.maxSize?t.maxSize:{width:1280,height:720},this.safeSize=void 0!==t.safeSize?t.safeSize:{width:1280,height:720},this.scaleController=void 0!==t.scaleController?t.scaleController:"default",this.background=void 0!==t.background?t.background:"#FFFFFF",this.layers=[],this.sceneData=void 0!==t.scenes?t.scenes:{},this.loadedScenes=[],this._sceneLoading=!1,this.mountedScenes=[],this.loadQueue=[],this.transitionScene=t.transitionScene,this.mainGroup=t.mainGroup||"activities",this.initialScenes=void 0!==t.initialScenes?t.initialScenes:null,this.groupLayers={},this.preload=void 0!==t.preload?t.preload:[],this.config={},this.framerate=void 0!==t.framerate?t.framerate:60,this.timestep=void 0!==t.timestep?t.timestep:Math.ceil(1e3/this.framerate),this.frameCount=0,this.activeTime=0,this.startTime=Date.now(),this.lastTime=0,this._interval=setInterval((function(){return i.onTimestep()}),this.timestep),this.deltaArray=[],this.maxDeltaCount=20,this.averageFrameTime=0,this.lowPerformanceThreshold=60,this.perfWarningCount=0,this.perfWarningThreshold=10,this.lowPerformanceMode=!1,this.deviceScale=I.a.deviceType.match(/iPad 2/)?.5:1;for(var n=0;n<this.maxDeltaCount;n++)this.deltaArray.push(0);this.updateList=[],this.baseUrl=void 0!==t.baseUrl?t.baseUrl:"",this.isMobile=!1,this.sound=new l,this.focus=new w(this.resume,this.pause,this),this.paused=new signals.Signal,this.resumed=new signals.Signal,this.lang=void 0!==t.language?t.language:"en",this.tickerType=e.TICKER_PIXI,this.signal=new signals.Signal,this.console=new _.a(this),this.console.addStyle("class","color: #FF8888; font-weight: bold;",!0),e.DEBUG||this.console.disable(),this.init()}return P(e,[{key:"globalState",get:function(){return this.config.globalState}},{key:"isSceneLoading",get:function(){return this._sceneLoading}},{key:"scenes",get:function(){return this.mountedScenes.concat(this.loadedScenes)}},{key:"scene",get:function(){for(var e in this.mountedScenes){var t=this.mountedScenes[e];if(this.getSceneGroup(t.name)==this.mainGroup)return t}}},{key:"runtime",get:function(){return Date.now()-this.startTime}}],[{key:"TICKER_PIXI",get:function(){return 0}},{key:"TICKER_CREATEJS",get:function(){return 1}},{key:"DEBUG",get:function(){if("development"==e.BUILD_ENV)return!0;for(var t=!1,i=window.location.search.substring(1).split("&"),n=0;n<i.length;n++){var a=i[n].split("=");"DEBUG"==decodeURIComponent(a[0])&&(t="true"===decodeURIComponent(a[1]))}return t}},{key:"BUILD_ENV",get:function(){return"production"}},{key:"SCENES_LOADED",get:function(){return"scenes_loaded"}},{key:"LOAD_PROGRESS",get:function(){return"load_progress"}},{key:"TRANSITION_IN",get:function(){return"transition_in"}},{key:"TRANSITION_OUT",get:function(){return"transition_out"}},{key:"GLOBAL_STATE",get:function(){return"global_state"}}]),P(e,[{key:"onError",value:function(){}},{key:"init",value:function(){var t=this;this.voPlayer=new d,this.addToTicker(this.voPlayer),x.a.listen(),this.signal.add((function(e,i){return t.gameEventHandler(e,i)})),activitySignal.add((function(e,i){return t.activityEventHandler(e,i)}));var i=new createjs.LoadQueue(!1);i.on("fileload",(function(e){return t.loadConfig(e)})),i.on("complete",(function(e){return t.onConfigLoaded(e)})),i.loadFile({src:this.baseUrl+"assets/config/globalState.json"}),i.loadFile({src:this.baseUrl+"assets/config/animations/anim_global.json"}),i.loadFile({src:this.baseUrl+"assets/config/sound.json"}),!0===this.useSpringroll&&i.loadFile({src:this.baseUrl+"assets/config/captions.json"}),this.isMobile=this.mobilecheck(),!0===this.isMobile&&document.body.classList.add("mobile");var n=document.getElementById(this.canvasParent),a="fit"==this.scaleController?n.clientWidth:this.maxSize.width,s="fit"==this.scaleController?n.clientHeight:this.maxSize.height;if(this.pixiApp=new PIXI.Application({width:a,height:s,backgroundColor:this.background,autoStart:!0,autoDensity:!1,antialias:!0,transparent:!0}),this.pixiApp.renderer.plugins.interaction.moveWhenInside=!0,this.setupLayers(),n.appendChild(this.pixiApp.view),this.scaleManager=new o({canvas:this.pixiApp.view,maxSize:this.maxSize,safeSize:this.safeSize,scaleController:this.scaleController,renderer:this.pixiApp.renderer}),window.addEventListener("resize",(function(e){return t.onResize(e)})),this.onResize(),this.stage=this.pixiApp.stage,this.renderer=this.pixiApp.renderer,e.DEBUG&&(this.stats=new E,document.body.appendChild(this.stats.dom)),void 0===n)throw"Cannot find parent with ID of "+this.canvasParent;switch(this.tickerType){case e.TICKER_CREATEJS:PIXI.ticker.shared.stop(),createjs.Ticker.framerate=this.framerate,createjs.Ticker.on("tick",(function(e){return t.onTick(e)}));break;case e.TICKER_PIXI:this.pixiApp.ticker.add((function(){return t.onTick()}))}this.renderer.render(this.stage),this.assets=PIXI.loader.resources,!0===this.useSpringroll&&this.setupSpringroll()}},{key:"setupSpringroll",value:function(){var e=this;this.springrollApp=new n.a({features:{captions:!0,sound:!0,vo:!0,music:!0,sfx:!0}}),this.springrollApp.state.pause.subscribe((function(t){!0===t?e.pause():e.resume()})),this.springrollApp.state.soundVolume.subscribe((function(t){e.sound.setVolume(t)})),this.springrollApp.state.sfxVolume.subscribe((function(t){e.sound.setVolume(t,"sfx")})),this.springrollApp.state.voVolume.subscribe((function(t){e.sound.setVolume(t,"vo")})),this.springrollApp.state.musicVolume.subscribe((function(t){e.sound.setVolume(t,"music")})),this.springrollApp.soundMuted&&this.springrollApp.state.soundMuted.subscribe((function(t){return e.sound.setMute(t)})),this.springrollApp.sfxMuted&&this.springrollApp.state.sfxMuted.subscribe((function(t){return e.sound.setMute(t,"sfx")})),this.springrollApp.voMuted&&this.springrollApp.state.voMuted.subscribe((function(t){return e.sound.setMute(t,"vo")})),this.springrollApp.musicMuted&&this.springrollApp.state.musicMuted.subscribe((function(t){return e.sound.setMute(t,"music")})),this.springrollApp.state.captionsMuted.subscribe((function(t){e.voPlayer.setCaptionsMuted(t)})),this.onResize()}},{key:"setupLayers",value:function(){PIXI.display&&(this.pixiApp.stage=new PIXI.display.Stage,this.pixiApp.stage.group.enableSort=!1,this.addLayer("bg"),this.addLayer("grid"),PIXI.lights&&(this.addLayer("diffuse",!1,PIXI.lights.diffuseGroup),this.addLayer("normal",!1,PIXI.lights.normalGroup),this.addLayer("light",!1,PIXI.lights.lightGroup)),this.addLayer("sprite",!0),this.addLayer("ui",!0),this.addLayer("overlay"),this.addLayer("debug"))}},{key:"addLayer",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new PIXI.display.Group;this.layers||(this.layers=[]);var n=new PIXI.display.Layer(i);return n.name=e,n.group.enableSort=t,this.pixiApp.stage.addChild(n),this.layers.push(n),n}},{key:"getLayer",value:function(e){return this.layers.find((function(t){return t.name==e}))}},{key:"gameEventHandler",value:function(t,i){switch(t){case e.SCENES_LOADED:this.console.log("All scenes loaded. Now mounting scenes...");var n=k.a.searchByProperty("lazy",!1,this.loadedScenes,!0);for(var a in n){var o=n[a];this.mountScene(o)}}}},{key:"activityEventHandler",value:function(e,t){switch(e){case"start_activity":this.scene.endScene(t.activityName);var i=this.globalState.introText[t.activityName],n=t.providerData.name,a=t.providerData.careerUrl,o=document.getElementById("game-overlay-content"),s=document.getElementById("game-overlay-title"),r=i.title.replace(/{{ldc}}/g,n),l=i.body.replace(/{{ldc}}/g,n);if(l=l.replace(/{{careerurl}}/g,a),s.innerHTML=r,document.getElementById("game-overlay-body").innerHTML=l,document.getElementById("game-overlay-image").src=i.image,""!==i.titleImage){var c=new Image;c.src=i.titleImage,c.id="game-overlay-image",s.appendChild(c),s.classList.add("hasImage")}else s.classList.remove("hasImage");""!=i.image?o.classList.add("hasImage"):o.classList.remove("hasImage");break;case"verify_activity_share":!0===t.isOver13&&("function"==typeof this.scene.shareActivity?this.scene.shareActivity():console.error("Sharing not enabled for current activity"));break;case"end_activity":this.scene.endScene("Title")}}},{key:"sceneEventHandler",value:function(t,i){switch(t){case S.a.SCENE_ENTER:this.console.log("SCENE ENTER"),this.transition?(this.signal.dispatch(e.TRANSITION_OUT),this.transition=!1):this.startScene(i.scene);break;case S.a.SCENE_START:break;case S.a.SCENE_END:this.console.log("SCENE END"),this.nextScene=i.next,i.transition?(this.transition=!0,this.signal.dispatch(e.TRANSITION_IN)):this.gotoNextScene();break;case S.a.TRANSITION_START:break;case S.a.TRANSITION_END:if("in"==i.transition)this.gotoNextScene();else if("out"==i.transition)for(var n=0;n<this.mountedScenes.length;n++)this.mountedScenes[n].active||this.startScene(this.mountedScenes[n].name);break;case S.a.SCENE_EXIT:}}},{key:"loadConfig",value:function(e){var t=e.item.src.split("/").pop().split(".").shift();this.config[t]=e.result}},{key:"onConfigLoaded",value:function(e){var t=this;this.globalState.analytics&&T.a._setup(this.globalState.analytics),this.preload.length?PIXI.loader.add(this.preload).load((function(e,i){return t.onAssetPreloadComplete(e,i)})):this.loadSounds()}},{key:"onAssetPreloadComplete",value:function(e,t){var i=game.assets.CursorDefault.texture,n=game.assets.CursorOver.texture;!this.isMobile&&i&&n&&(this.cursor=new g(i,n),this.stage.addChild(this.cursor),this.addToTicker(this.cursor)),this.loadSounds()}},{key:"loadSounds",value:function(){if(this.useSpringroll){var t=document.getElementById("captions"),i=new n.b(this.config.captions,new n.c(t)),a=!0!==e.DEBUG&&game.springrollApp.state.captionsMuted.value;this.voPlayer.setupCaptions(i,a)}var o=this.getSoundManifest(this.config.sound.music),s=this.getSoundManifest(this.config.sound.sfx),r=this.getSoundManifest(this.config.sound.vo,!0);this.sound.addSounds(o,"music"),this.sound.addSounds(s,"sfx"),this.sound.addSounds(r,"vo"),this.config.sound.music.hasOwnProperty("volume")&&this.sound.setVolume(this.config.sound.music.volume,"music"),this.config.sound.sfx.hasOwnProperty("volume")&&this.sound.setVolume(this.config.sound.sfx.volume,"sfx"),this.config.sound.vo.hasOwnProperty("volume")&&this.sound.setVolume(this.config.sound.vo.volume,"vo"),this.loadInitialScenes()}},{key:"getSoundManifest",value:function(e,t){!0===t&&"string"==typeof this.lang&&"default"!==this.lang&&(e.path=e.path+this.lang+"/");for(var i=e.sounds.length-1;i>=0;i--)e.sounds[i].src=this.baseUrl+e.path+e.sounds[i].src;return e.sounds}},{key:"loadInitialScenes",value:function(){for(var e=0;e<this.initialScenes.length;e++){var t=this.initialScenes[e];this.addScene(t)}this.loadScenes()}},{key:"gotoScene",value:function(e){var t=this.getSceneGroup(e);this.unmountGroup(t);var i=this.getScene(e);i?this.mountScene(i):(this.addScene(e),this.loadScenes())}},{key:"gotoNextScene",value:function(){this.nextScene?(this.gotoScene(this.nextScene),this.nextScene=null):this.console.error("!! Next scene not specified")}},{key:"addScene",value:function(e,t){var i=this.getScene(e);if(i)this.console.log("Scene already loaded:",e);else if(i=k.a.searchByProperty("name",e,this.loadQueue))this.console.log("Scene already in queue:",e);else{this.console.log("Queuing scene to load:",e);var n=this.getSceneData(e);(i=new n.classRef(n.name,n.options,this.baseUrl)).lazy=t||!1,i.boot(),this.loadQueue.push(i)}}},{key:"loadScenes",value:function(){for(var t=this,i=0;i<this.loadQueue.length;i++){var n=this.loadQueue[i];n.loading||(n.loadComplete.addOnce((function(i){t.console.log("Scene load complete:",i.scene.name,t.loadQueue),t.loadedScenes.push(i.scene),k.a.remove(i.scene,t.loadQueue,!0),0==t.loadQueue.length&&(t.console.log("All queued scenes loaded."),t._sceneLoading=!1,t.signal.dispatch(e.SCENES_LOADED,{}))})),n.loadProgress.add((function(i){for(var n=0,a=0,o=t.loadQueue.concat(t.loadedScenes),s=0;s<o.length;s++){n+=o[s].loader.progress||0,a+=100}var r=n/a;t.signal.dispatch(e.LOAD_PROGRESS,{progress:r})})),this.console.log("Loading scene:",n.name),n.preload())}this._sceneLoading=!0}},{key:"mountScene",value:function(e){if(-1==this.mountedScenes.indexOf(e)){var t=this.getSceneGroup(e.name);this.unmountGroup(t),this.console.log("Mounting scene '",e.name,"' in group '",t,"'"),this.stage.addChildAt(e.container,0),this.renderer.render(this.stage),e.signal.add(this.sceneEventHandler,this),e.mounted=!0,e.build(),e.init(),this.mountedScenes.push(e),k.a.remove(e,this.loadedScenes),e.signal.dispatch(S.a.SCENE_ENTER,{scene:e.name})}else console.warn("!! Scene '",e.name,"' already mounted!")}},{key:"startScene",value:function(e){var t=this.getScene(e);t.active=!0,t.start(),t.signal.dispatch(S.a.SCENE_START,{scene:e})}},{key:"getScene",value:function(e){return k.a.searchByProperty("name",e,this.mountedScenes)||k.a.searchByProperty("name",e,this.loadedScenes)}},{key:"getSceneGroup",value:function(e){var t=this.getSceneData(e);for(var i in this.sceneData){if(-1!=this.sceneData[i].indexOf(t))return i}}},{key:"getSceneData",value:function(e){for(var t in this.sceneData){var i=this.sceneData[t],n=k.a.search((function(t){return t.name==e}),i);if(n)return n}return null}},{key:"unmountScene",value:function(e){var t=this.getScene(e);t&&t.mounted&&(t.destroy(),t.mounted=!1,t.active=!1,this.stage.removeChild(t.container),t.container.destroy(!0),k.a.remove(t,this.mountedScenes),this.console.log("Unmounted scene:",e))}},{key:"unmountGroup",value:function(e){var t=this.sceneData[e];this.console.log("Unmounting scenes in group '",e,"'");for(var i=t.length-1;i>=0;i--)this.unmountScene(t[i].name)}},{key:"unloadSceneTextures",value:function(e){var t,i=this.getSceneData(e);if(PIXI.loader.resources[i.options.manifest]){this.console.log("Unloading textures from scene:",e),t=PIXI.loader.resources[i.options.manifest].data.concat();var n=this.scenes,a=[];for(var o in n){var s=n[o];if(s.manifest&&PIXI.loader.resources[s.manifest])for(var r=PIXI.loader.resources[s.manifest].data,l=0;l<r.length;l++)k.a.include(r[l].key,a)}for(l=t.length-1;l>=0;l--)k.a.includes(t[l].key,a)&&(this.console.log("Asset still in use: ",t[l].key),t.splice(l,1));for(l=t.length-1;l>=0;l--){var c=t[l],u=PIXI.loader.resources[c.key];u.texture&&(u.texture.destroy(!0),this.assets[c.key]=null,delete this.assets[c.key],this.console.log("Texture unloaded: ",c.key))}}else this.console.warn("!! Cannot unload scene. Scene has not been loaded",e)}},{key:"refreshLoadedTextures",value:function(){for(var e in this.assets){var t=this.assets[e];t.texture&&t.texture.hasOwnProperty("valid")&&0==t.texture.valid&&(this.assets[e]=null,delete this.assets[e],this.console.log("Texture unloaded: ",e))}}},{key:"transitionIn",value:function(e){(e=e||function(){})()}},{key:"transitionOut",value:function(e){(e=e||function(){})()}},{key:"onResize",value:function(e){this.scaleManager.resize(),this.renderer&&this.stage&&this.renderer.render(this.stage),this.springrollApp&&this.springrollApp.container.send("resizegame",this.scaleManager.visibleDimensions)}},{key:"onTick",value:function(e){if(this.stats&&this.stats.begin(),e||(e={paused:!1,delta:this.pixiApp.ticker.elapsedMS}),!1===e.paused){this.frameCount++;for(var t=0;t<this.mountedScenes.length;t++){var i=this.mountedScenes[t];!0===i.active&&(i.delta=e.delta,i.onTick(e))}for(var n in this.updateList)try{this.updateList[n].update(e)}catch(e){console.error(e),this.console.log(this.updateList[n])}}this.stats&&this.stats.end()}},{key:"onTimestep",value:function(){this._lastStep||(this._lastStep=this.startTime);var e=Date.now(),t=e-this._lastStep;this._lastStep=e,this.activeTime+=t,isNaN(this._stepDifference)?this._stepDifference=0:t>this.timestep&&(this._stepDifference=this._stepDifference+(t-this.timestep));for(var i=this._stepDifference,n=Math.max(1,Math.floor((this.timestep+i)/this.timestep)),a=[],o=0;o<this.mountedScenes.length;o++){var s=this.mountedScenes[o];!0===s.active&&(s.runtime+=t,a.push(s))}for(var r=0;r<n&&r<100;r++){for(var l=0;l<a.length;l++){a[l].onTimestep()}i>=this.timestep&&(i=Math.max(0,i-this.timestep))}this._stepDifference=i}},{key:"pause",value:function(){clearInterval(this._interval),this._interval=null,game.paused.dispatch(),console.log("paused",this._interval),PIXI.spine.Spine.globalAutoUpdate=!1,this.pixiApp.ticker.update(),this.pixiApp.stop(),createjs&&createjs.Ticker&&(createjs.Ticker.paused=!0),c.b&&c.b.globalTimeScale(0),this.sound.pause()}},{key:"resume",value:function(){var t=this;game.resumed.dispatch(),this.console.log("resume"),this._interval||(this._interval=setInterval((function(){return t.onTimestep()}),this.timestep)),this._lastStep=Date.now(),this.tickerType===e.TICKER_PIXI&&(this.pixiApp.start(),PIXI.spine.Spine.globalAutoUpdate=!0),createjs&&createjs.Ticker&&(createjs.Ticker.paused=!1),c.b&&c.b.globalTimeScale(1),this.sound.resume()}},{key:"addToTicker",value:function(e){"object"===A(e)&&e.update?this.updateList.push(e):console.error("Item does not contain an update function!")}},{key:"removeFromTicker",value:function(e){this.updateList.indexOf(e)>-1&&this.updateList.splice(this.updateList.indexOf(e),1)}},{key:"setGlobalState",value:function(t,i){var n=this.config.globalState;n[t]!=i&&(n[t]=i,this.signal.dispatch(e.GLOBAL_STATE))}},{key:"mobilecheck",value:function(){var e,t=!1;return e=navigator.userAgent,/Mobile|iP(hone|od|ad)|Android|BlackBerry|IEMobile/.test(e)&&(t=!0),t}},{key:"iOScheck",value:function(){var e,t=!1;return e=navigator.userAgent,/iP(hone|od|ad)/.test(e)&&(t=!0),t}}]),e}()},18:function(e,t,i){"use strict";function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}i.d(t,"a",(function(){return a}));var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,i,a;return t=e,a=[{key:"listen",value:function(){document.addEventListener("keydown",e._keyDown),document.addEventListener("keyup",e._keyUp),e.keyDown=new signals.Signal,e.keyUp=new signals.Signal,e.map={}}},{key:"_keyDown",value:function(t){e.map[t.key.toLowerCase()]=!0,e.keyDown.dispatch(t)}},{key:"_keyUp",value:function(t){if("Meta"==t.key)for(var i in e.map)e.map[i]=null,delete e.map[i];else e.map[t.key.toLowerCase()]=null,delete e.map[t.key.toLowerCase()];e.keyUp.dispatch(t)}},{key:"isKeyDown",value:function(t){return"space"==t&&(t=" "),e.map[t.toLowerCase()]}},{key:"isModifier",value:function(e){return"shift"==e.toLowerCase()||"control"==e.toLowerCase()||"alt"==e.toLowerCase()||"meta"==e.toLowerCase()}},{key:"executeShortcuts",value:function(t,i,n){t.preventDefault();var a=t.key.toLowerCase();n.forEach((function(t){for(var n=t.command,o=t.keys,s=0;s<o.length;s++){var r=o[s].split("+"),l=!1;for(var c in r){var u=r[c];"plus"==u&&(u="+"),l=!!(e.isModifier(u)?e.isKeyDown(u):u==a)}if(l)return void(i[n]&&i[n]())}}))}}],(i=null)&&n(t.prototype,i),a&&n(t,a),e}()},19:function(e,t,i){"use strict";function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}i.d(t,"a",(function(){return a}));var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,i,a;return t=e,a=[{key:"_setup",value:function(){e.isDesktop=!1,e.isMobile=!1,e.isIOS=!1,e.isAndroid=!1,e.isChromeOS=!1,e.isMacOS=!1,e.isWindows=!1,e.isLinux=!1,e.platformName="",e.pixelRatio=1,e.colorDepth=-1,e.screenWidth=-1,e.screenHeight=-1,e.deviceType="unknown",e.isChrome=!1,e.isFirefox=!1,e.isIE=!1,e.isEdge=!1,e.isSafari=!1,e.isWebApp=!1,e.browserVersion="",e.browserName="",e.browserDetails={},e.url="",e.host="",e.path="",e.port="",e.queryString="",e._checkBrowser(),e._checkPlatform(),e._checkDevice()}},{key:"_checkPlatform",value:function(){var t=navigator.userAgent;/Linux/.test(t)&&(e.platformName="Linux",e.isLinux=!0),/Android/.test(t)&&(e.platformName="Android",e.isAndroid=!0),/CrOS/.test(t)&&(e.platformName="ChromeOS",e.isChromeOS=!0),/iP[ao]d|iPhone/i.test(t)&&(e.platformName="iOS",e.isIOS=!0),/Mac OS/.test(t)&&(e.platformName="Mac",e.isMacOS=!0),/Windows/.test(t)&&(e.platformName="Windows",e.isWindows=!0),(e.isWindows||e.isMacOS||e.isLinux)&&(e.isDesktop=!0),(e.isAndroid||e.isIOS||e.isWebApp)&&(e.isMobile=!0)}},{key:"_checkDevice",value:function(){if(e.pixelRatio=window.devicePixelRatio||1,e.colorDepth=window.screen.colorDepth,e.isMobile){if(e.screenWidth=window.screen.width*e.pixelRatio,e.screenHeight=window.screen.height*e.pixelRatio,e.isIOS){var t,i=document.createElement("canvas"),n=window.screen.width,a=window.screen.height;if(i){var o=i.getContext("webgl")||i.getContext("experimental-webgl");if(o){var s=o.getExtension("WEBGL_debug_renderer_info");s&&(t=o.getParameter(s.UNMASKED_RENDERER_WEBGL))}}if(n/a==1024/768||a/n==1024/768)if(1==window.devicePixelRatio)switch(t){default:e.deviceType="iPad, iPad 2, iPad Mini";case"PowerVR SGX 535":e.deviceType="iPad";case"PowerVR SGX 543":e.deviceType="iPad 2 or Mini"}else switch(t){default:e.deviceType="iPad 3, 4, 5, Mini 2, Mini 3, Mini 4, Air, Air 2";case"PowerVR SGX 543":e.deviceType="iPad 3";case"PowerVR SGX 554":e.deviceType="iPad 4";case"Apple A7 GPU":e.deviceType="iPad Air, Mini 2, Mini 3";case"Apple A8X GPU":e.deviceType="iPad Air 2";case"Apple A8 GPU":e.deviceType="iPad Mini 4";case"Apple A9 GPU":e.deviceType="iPad 5, Pro 9.7"}else if(n/a==1112/834||a/n==1112/834)e.deviceType="iPad Pro 10.5";else if(n/a==1366/1024||a/n==1366/1024)switch(t){default:e.deviceType="iPad Pro 12.9, Pro 12.9 (2nd Gen)";case"Apple A10X GPU":e.deviceType="iPad Pro 12.9 (2nd Gen)";case"Apple A9 GPU":e.deviceType="iPad Pro 12.9"}}}else e.screenWidth=window.screen.width,e.screenHeight=window.screen.height}},{key:"_checkBrowser",value:function(){var t=navigator.userAgent;/Safari/.test(t)&&(e.browserName="Safari",e.isSafari=!0,e.browserVersion=-1!=t.indexOf("Version")?t.substring(t.indexOf("Version")+8):t.substring(t.indexOf("Safari")+7)),/Mobile(.*)Safari/.test(t)&&(e.browserName="MobileSafari",e.isSafari=!0,e.browserVersion=-1!=t.indexOf("Version")?t.substring(t.indexOf("Version")+8):t.substring(t.indexOf("Safari")+7)),/Chrome/.test(t)&&(e.browserName="Chrome",e.isChrome=!0,e.browserVersion=t.substring(t.indexOf("Chrome")+7,t.indexOf(" Safari")||null)),/Firefox/.test(t)&&(e.browserName="Firefox",e.isFirefox=!0,e.browserVersion=t.substring(t.indexOf("Firefox")+8)),/MSIE (\d+\.\d+);/.test(t)&&(e.browserName="MSIE",e.isIE=!0,e.browserVersion=t.substring(t.indexOf("MSIE")+5)),/Edge/.test(t)&&(e.browserName="MSEdge",e.isEdge=!0,e.browserVersion=t.substring(t.indexOf("Edge")+5)),navigator.standalone&&(e.browserName="WebApp",e.isWebApp=!0),navigator.isCocoonJS&&(e.browserName="CocoonJS",e.isCocoonJS=!0),e.url=window.location.href,e.queryString=window.location.search,e.host=window.location.hostname,e.path=window.location.pathname,e.port=window.location.port;var i=e.browserVersion.split(".");switch(i.length){case 1:e.browserDetails.major=parseInt(i[0]);break;case 2:e.browserDetails.major=parseInt(i[0]),e.browserDetails.minor=parseInt(i[1]);break;case 3:e.browserDetails.major=parseInt(i[0]),e.browserDetails.minor=parseInt(i[1]),e.browserDetails.build=parseInt(i[2]);break;case 4:e.browserDetails.major=parseInt(i[0]),e.browserDetails.minor=parseInt(i[1]),e.browserDetails.build=parseInt(i[2]),e.browserDetails.revision=parseInt(i[3])}}},{key:"getURLParameterByName",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];null===i&&(i=!0);var n=new RegExp("[?&]"+t+"=([^&]*)").exec(e.queryString);return i?n&&decodeURIComponent(n[1].replace(/\/+/g,"")):n&&decodeURIComponent(n[1])}}],(i=null)&&n(t.prototype,i),a&&n(t,a),e}()},2:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i(4),a=i(19);function o(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,i,s;return t=e,s=[{key:"getScreenValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!e)return null;var i=game.scaleManager.getStageBounds(),n=game.scaleManager.getSafeBounds(),a=game.scaleManager.getMaxBounds(),o=0;if("string"==typeof e)switch(e){case"centerX":o=i.centerX;break;case"centerY":o=i.centerY;break;case"left":o=i.left;break;case"right":o=i.right;break;case"top":o=i.top;break;case"bottom":o=i.bottom;break;case"screenWidth":o=i.width;break;case"screenHeight":o=i.height;break;case"safeLeft":o=n.left;break;case"safeRight":o=n.right;break;case"safeTop":o=n.top;break;case"safeBottom":o=n.bottom;break;case"safeWidth":o=n.width;break;case"safeHeight":o=n.height;break;case"maxLeft":o=a.left;break;case"maxRight":o=a.right;break;case"maxTop":o=a.top;break;case"maxBottom":o=a.bottom;break;case"maxWidth":o=a.width;break;case"maxHeight":o=a.height;break;case"width":o=t.width;break;case"height":o=t.height;break;case"halfWidth":o=t.width/2;break;case"halfHeight":o=t.height/2;break;default:o=parseFloat(e)}else o=e;return o}},{key:"parseValue",value:function(t,i){if("string"!=typeof t)return t;var a=/\b[+*-/]=/,o=t.split(a)[0],s=t.match(/[+*-/]/)?t.match(/[+*-/]/)[0]:null,r=e.getScreenValue(n.a.reachInto(t.split(a),1),i),l=e.getScreenValue(o,i);if(s)switch(s){case"+":l+=r||0;break;case"-":l-=r||0;break;case"/":l/=r||0;break;case"*":l*=r||0}return l}},{key:"pointer",get:function(){return a.a.isDesktop?game.pixiApp.renderer.plugins.interaction.mouse.global:new PIXI.Point(0,0)}},{key:"centerX",get:function(){return e.getScreenValue("centerX")}},{key:"centerY",get:function(){return e.getScreenValue("centerY")}},{key:"screenWidth",get:function(){return e.getScreenValue("screenWidth")}},{key:"screenHeight",get:function(){return e.getScreenValue("screenHeight")}},{key:"left",get:function(){return e.getScreenValue("left")}},{key:"right",get:function(){return e.getScreenValue("right")}},{key:"top",get:function(){return e.getScreenValue("top")}},{key:"bottom",get:function(){return e.getScreenValue("bottom")}},{key:"safeLeft",get:function(){return e.getScreenValue("safeLeft")}},{key:"safeRight",get:function(){return e.getScreenValue("safeRight")}},{key:"safeTop",get:function(){return e.getScreenValue("safeTop")}},{key:"safeBottom",get:function(){return e.getScreenValue("safeBottom")}},{key:"safeWidth",get:function(){return e.getScreenValue("safeWidth")}},{key:"safeHeight",get:function(){return e.getScreenValue("safeHeight")}},{key:"maxLeft",get:function(){return e.getScreenValue("maxLeft")}},{key:"maxRight",get:function(){return e.getScreenValue("maxRight")}},{key:"maxTop",get:function(){return e.getScreenValue("maxTop")}},{key:"maxBottom",get:function(){return e.getScreenValue("maxBottom")}},{key:"maxWidth",get:function(){return e.getScreenValue("maxWidth")}},{key:"maxHeight",get:function(){return e.getScreenValue("maxHeight")}}],(i=null)&&o(t.prototype,i),s&&o(t,s),e}()},228:function(e,t,i){"use strict";i.r(t);var n=i(1),a=(i(217),i(218),i(219),i(113)),o=(i(220),i(221),i(34)),s=i.n(o);function r(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,i,n;return t=e,n=[{key:"customEvent",value:function(){try{new window.CustomEvent("customEventPolyfillTest")}catch(t){var e=function(e,t){var i;return t=t||{bubbles:!1,cancelable:!1,detail:void 0},(i=document.createEvent("CustomEvent")).initCustomEvent(e,t.bubbles,t.cancelable,t.detail),i};e.prototype=window.Event.prototype,window.CustomEvent=e}}},{key:"objectForEach",value:function(){Object.prototype.forEach||Object.defineProperty(Object.prototype,"forEach",{value:function(e,t){if(null==this)throw new TypeError("Not an object");for(var i in t=t||window,this)this.hasOwnProperty(i)&&e.call(t,this[i],i,this)}})}}],(i=null)&&r(t.prototype,i),n&&r(t,n),e}(),c=i(15),u=i(5);function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function f(e,t){return!t||"object"!==h(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e,t,i){return(p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,i){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=y(e)););return e}(e,t);if(n){var a=Object.getOwnPropertyDescriptor(n,t);return a.get?a.get.call(i):a.value}})(e,t,i||e)}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var v=function(e){function t(e,i){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e=void 0!==e?e:{},f(this,y(t).call(this,e,i))}var i,n,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}(t,e),i=t,(n=[{key:"init",value:function(){}},{key:"start",value:function(){}},{key:"destroy",value:function(){game.voPlayer.stop(),game.voPlayer.clearSignals(),game.sound.stopAll(),this.animator&&this.animator.destroy(),p(y(t.prototype),"destroy",this).call(this)}}])&&d(i.prototype,n),a&&d(i,a),t}(u.a),g=i(2),b=i(10);function w(e){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function k(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function S(e,t){return!t||"object"!==w(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function x(e,t,i){return(x="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,i){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_(e)););return e}(e,t);if(n){var a=Object.getOwnPropertyDescriptor(n,t);return a.get?a.get.call(i):a.value}})(e,t,i||e)}function _(e){return(_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function I(e,t){return(I=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}u.a;var T=i(9);function E(e){return(E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function A(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var O=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=t.sectionWidth,n=t.sectionHeight,a=t.width,o=t.height,s=t.rows,r=t.columns,l=t.x,c=t.y;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.DEFAULT_SECTION_WIDTH=24,this.DEFAULT_SECTION_HEIGHT=24,this.sections=[],this._sectionWidth,this._x=l||0,this._y=c||0,this._sectionHeight,this.generate({width:a,height:o,sectionHeight:n,sectionWidth:i,rows:s,columns:r})}var t,i,n;return t=e,(i=[{key:"setOrigin",value:function(e,t){this._x==e&&this._y==t||(this._x=e,this._y=t,this._calculateCoordinates())}},{key:"generate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.sectionWidth,i=e.sectionHeight,n=e.rows,a=e.columns,o=e.width,s=e.height;t||i?(this._sectionWidth=t,this._sectionHeight=i):"number"==typeof n&&"number"==typeof a&&"number"==typeof o&&"number"==typeof s?(this._sectionWidth=o/a,this._sectionHeight=s/n):(this._sectionWidth=this.DEFAULT_SECTION_WIDTH,this._sectionHeight=this.DEFAULT_SECTION_HEIGHT),o&&s?(this.numRows=Math.ceil(s/i),this.numColumns=Math.ceil(o/t)):(this.numRows=n||1,this.numColumns=a||1),this.sections=[];for(var r=0;r<this.numRows;r++){var l=[];this.sections.push(l);for(var c=0;c<this.numColumns;c++){var u={};u.row=r,u.column=c,u.items=[],u.x=this._x+u.column*this._sectionWidth,u.y=this._y+u.row*this._sectionHeight,u.centerX=u.x+this._sectionWidth/2,u.centerY=u.y+this._sectionHeight/2,u.width=this._sectionWidth,u.height=this._sectionHeight,l.push(u)}}}},{key:"_calculateCoordinates",value:function(){var e=this;this.sections.forEach((function(t){return t.forEach((function(t){t.x=e._x+t.column*e._sectionWidth,t.y=e._y+t.row*e._sectionHeight,t.centerX=t.x+e._sectionWidth/2,t.centerY=t.y+e._sectionHeight/2}))}))}},{key:"getRowAt",value:function(e){return e=Math.max(0,Math.min(e-this._y,this.gridHeight)),Math.floor(e/this._sectionHeight)}},{key:"getColumnAt",value:function(e){return e=Math.max(0,Math.min(e-this._x,this.gridWidth)),Math.floor(e/this._sectionWidth)}},{key:"listItemAtCoords",value:function(e,t,i){var n=this.getColumnAt(t),a=this.getRowAt(i);this.listItem(e,a,n)}},{key:"listItem",value:function(e,t,i){this.getSection(t,i).items.push(e)}},{key:"listItemToArea",value:function(e,t,i,n,a){var o=this;this.getSectionsInArea(t,i,n,a).forEach((function(t){o.listItem(e,t.row,t.column)}))}},{key:"unlistItemAtCoords",value:function(e,t,i){var n=this.getColumnAt(t),a=this.getRowAt(i);this.unlistItem(e,a,n)}},{key:"unlistItemFromArea",value:function(e,t,i,n,a){var o=this;this.getSectionsInArea(t,i,n,a).forEach((function(t){o.unlistItem(e,t.row,t.column)}))}},{key:"unlistItem",value:function(e,t,i){this.sections.forEach((function(t){t.forEach((function(t){t.items=t.items.filter((function(t){return t!=e}))}))}))}},{key:"unlistAll",value:function(){var e,t=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=i.x,a=i.y,o=i.row,s=i.column;"number"==typeof n&&"number"==typeof a?e=this.getSectionAtCoords(n,a):"number"==typeof o&&"number"==typeof s&&(e=this.getSection(o,s)),e?e.items.concat().forEach((function(i){return t.unlistItem(i,e.row,e.column)})):null==n&&null==a&&null==o&&null==s&&this.sections.forEach((function(e){e.forEach((function(e){e.items.length=0}))}))}},{key:"unlistArea",value:function(e,t,i,n){var a=this;this.getSectionsInArea(e,t,i,n).forEach((function(e){a.unlistAll(e)}))}},{key:"hasItem",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=this.getSection(e,t);return!i&&n.items.length>0||null!==n.items.find((function(e){return e==i}))}},{key:"hasItemWithValue",value:function(e,t,i,n){var a=this.getSection(e,t),o=!1;return a.items.forEach((function(e){"object"===E(e)&&e[i]===n&&(o=!0)})),o}},{key:"hasItemAt",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=this.getSectionAtCoords(e,t);return!i&&n.items.length>0||null!==n.items.find((function(e){return e==i}))}},{key:"hasItemInArea",value:function(e,t,i,n,a){for(var o=this.getSectionsInArea(e,t,i,n),s=0;s<o.length;s++){var r=o[s];if(!a&&r.items.length>0||r.items.find((function(e){return e==a})))return!0}return!1}},{key:"getSection",value:function(e,t){return e=e>=this.numRows?this.numRows-1:e<0?0:e,t=t>=this.numColumns?this.numColumns-1:t<0?0:t,this.sections[e][t]}},{key:"getItemSections",value:function(e){var t=[];return this.sections.forEach((function(i){i.forEach((function(i){i.items.find((function(t){return t==e}))&&t.push(i)}))})),t.length>1?t:t[0]}},{key:"getAvailableArea",value:function(e,t){for(var i=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=n.targetX,o=n.targetY,s=Math.ceil(e/this.sectionWidth)||1,r=Math.ceil(t/this.sectionHeight)||1,l=[],c=0;c<=this.sections.length-r;c++)for(var u=this.sections[c],h=0;h<=u.length-s;h++){var d=u[h];if(!this.hasItemInArea(d.x,d.y,e,t)){if(!a&&!o)return this.getSectionsInArea(d.x,d.y,e,t);l.push({x:d.x,y:d.y,row:d.row,column:d.column})}}var f=l[0],p=Number.MAX_SAFE_INTEGER;return l.forEach((function(n,s){var r=i.getAreaPosition(n.x,n.y,e,t,.5,.5),l=Math.abs(r.x-a)+Math.abs(r.y-o);l<=p&&(p=l,f=n)})),f?this.getSectionsInArea(f.x,f.y,e,t):null}},{key:"getAreaPosition",value:function(e,t,i,n){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,s=this.getSectionsInArea(e,t,i,n),r=s[0],l=this.getSectionAtCoords(r.x+i-1,r.y),c=this.getSectionAtCoords(r.x,r.y+n-1),u=l.x-r.x+this.sectionWidth,h=c.y-r.y+this.sectionHeight,d={};return d.x=r.x+u*a,d.y=r.y+h*o,d}},{key:"getSectionAtCoords",value:function(e,t){var i=this.getColumnAt(e),n=this.getRowAt(t);return this.getSection(n,i)}},{key:"getSectionsInArea",value:function(e,t,i,n){for(var a=[],o=this.getSectionAtCoords(e,t),s=this.getSectionAtCoords(e+i-1,t),r=this.getSectionAtCoords(e,t+n-1),l=Math.abs(r.row-o.row),c=Math.abs(s.column-o.column),u=0;u<=l;u++)for(var h=0;h<=c;h++){var d=this.getSection(o.row+u,o.column+h);-1==a.indexOf(d)&&a.push(d)}return a}},{key:"traverse",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;0===a&&(a=this.numColumns-1),0===n&&(n=this.numRows-1);for(var o=t;o<this.sections.length;o++)for(var s=this.sections[o],r=i;r<s.length;r++){var l=s[r];e(l)}}},{key:"traverseArea",value:function(e,t,i,n,a){for(var o=this.getSectionsInArea(t,i,n,a),s=0;s<o.length;s++)e(o[s])}},{key:"hasPathFromTo",value:function(e,t,i,n,a,o){for(var s=[],r=[this.getSection(e,t)];r.length>0;){var l=r.shift(),c=this.exploreInDirection(l,"NORTH",i,n);if("goal"===c.status)return!0;if("valid"===c.status&&!1===s.includes(c.section)&&this.hasItemWithValue(c.section.row,c.section.column,a,o)&&r.push(c.section),"goal"===(c=this.exploreInDirection(l,"SOUTH",i,n)).status)return!0;if("valid"===c.status&&!1===s.includes(c.section)&&this.hasItemWithValue(c.section.row,c.section.column,a,o)&&r.push(c.section),"goal"===(c=this.exploreInDirection(l,"WEST",i,n)).status)return!0;if("valid"===c.status&&!1===s.includes(c.section)&&this.hasItemWithValue(c.section.row,c.section.column,a,o)&&r.push(c.section),"goal"===(c=this.exploreInDirection(l,"EAST",i,n)).status)return!0;"valid"===c.status&&!1===s.includes(c.section)&&this.hasItemWithValue(c.section.row,c.section.column,a,o)&&r.push(c.section),s.push(l)}return!1}},{key:"exploreInDirection",value:function(e,t,i,n){var a={status:"invalid",section:null},o=e.row,s=e.column;switch(t){case"NORTH":(o-=1)>=0&&(a.status="valid",a.section=this.getSection(o,s));break;case"SOUTH":(o+=1)<this.numRows&&(a.status="valid",a.section=this.getSection(o,s));break;case"WEST":(s-=1)>=0&&(a.status="valid",a.section=this.getSection(o,s));break;case"EAST":(s+=1)<this.numColumns&&(a.status="valid",a.section=this.getSection(o,s))}return o===i&&s===n&&(a.status="goal"),a}},{key:"getAxis",value:function(e,t,i,n){var a=i-e,o=n-t;if(0==o&&0==a)return console.logError("Cannot find angle of vector [0, 0]"),"";var s=T.a.polarAngle(o,a);return s<22.5?"NORTH":s<67.5?"NORTHEAST":s<112.5?"EAST":s<157.5?"SOUTHEAST":s<202.5?"SOUTH":s<247.5?"SOUTHWEST":s<292.5?"WEST":s<337.5?"NORTHWEST":"NORTH"}},{key:"getSectionsOnAxis",value:function(e,t,i,n){var a=[],o=!0;if(a.push(this.getSection(e,t)),e===i&&t===n)return a;var s=this.getAxis(e,t,i,n),r=e,l=t,c=0,u=0;for(s.includes("NORTH")&&(u=-1),s.includes("EAST")&&(c=1),s.includes("SOUTH")&&(u=1),s.includes("WEST")&&(c=-1),0!==u&&e!==i&&(o=!1),0!==c&&t!==n&&(o=!1);!1===o;){r+=u,l+=c;var h=this.getSection(r,l);a.push(h),0!==u&&r===i&&(o=!0),0!==c&&l===n&&(o=!0)}return a}},{key:"gridWidth",get:function(){return this.numColumns*this._sectionWidth}},{key:"gridHeight",get:function(){return this.numRows*this._sectionHeight}},{key:"numSections",get:function(){return this.numRows*this.numColumns}},{key:"sectionWidth",get:function(){return this._sectionWidth}},{key:"sectionHeight",get:function(){return this._sectionHeight}},{key:"x",get:function(){return this._x}},{key:"y",get:function(){return this._y}}])&&A(t.prototype,i),n&&A(t,n),e}(),P=i(3),C=i(4),L=i(18),D=i(14);function M(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function j(e,t,i){return t&&M(e.prototype,t),i&&M(e,i),e}var N=function(){function e(t,i){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.items={},this.selectedItems=[],this.console=new D.a(this),this.input=new P.a,this.container=t;t.parent&&t.parent;this.container.interactive=!0,this.container.on("pointerdown",this._onDown,this),this.container.on("pointermove",this._onMove,this),this.container.on("pointerup",this._onUp,this),this._mouseLeave=function(e){return n.input.handleInputEvent(e,P.a.LEAVE)},this._mouseEnter=function(e){return n.input.handleInputEvent(e,P.a.ENTER)},document.body.addEventListener("mouseleave",this._mouseLeave),document.body.addEventListener("mouseenter",this._mouseEnter),this.input.down.add(this._stageDown,this),this.input.up.add(this._stageUp,this),this.input.move.add(this._stageMove,this);if(this.console.log(g.a.getScreenValue("centerX")),this.container.hitArea=new PIXI.Rectangle(g.a.getScreenValue("centerX")-1500,g.a.getScreenValue("centerY")-1500,3e3,3e3),this.itemSelected=new signals.Signal,this.itemDeselected=new signals.Signal,this.itemAdded=new signals.Signal,this.itemRemoved=new signals.Signal,this.itemOver=new signals.Signal,this.itemOut=new signals.Signal,this.toolSelected=new signals.Signal,this.interactTarget=null,this.options={},this.options.clickThreshold=i&&i.hasOwnProperty("clickThreshold")?i.clickThreshold:332,this.options.selectOn=i&&i.hasOwnProperty("selectOn")?i.selectOn:"down",this.options.deselectOn=i&&i.hasOwnProperty("deselectOn")?i.deselectOn:"up",this.options.snapToCursor=!(!i||!i.hasOwnProperty("snapToCursor"))&&i.snapToCursor,this.options.multiSelect=!(!i||!i.hasOwnProperty("multiSelect"))&&i.multiSelect,this.options.spaceMove=!(!i||!i.hasOwnProperty("spaceMove"))&&i.spaceMove,this.selectedTools=i&&i.hasOwnProperty("defaultTool")?[i.defaultTool]:[e.TOOL_MOVE],this.tools={},this.multiTool=!0,i&&i.tools)for(var a in i.tools){var o=i.tools[a];this.tools[a]=o,o.setControls(this)}this._setupInterface(),i&&i.enableKeyboard&&L.a.keyDown.add((function(e){return L.a.executeShortcuts(e,n.interface,n.keyBindings)}))}return j(e,null,[{key:"TOOL_MOVE",get:function(){return"move"}},{key:"TOOL_SCALE",get:function(){return"scale"}},{key:"TOOL_ROTATE",get:function(){return"rotate"}}]),j(e,[{key:"_setupInterface",value:function(){var e=this;this.interface={scaleUp:function(){return e.scale(.05,.05,!0)},scaleDown:function(){return e.scale(-.05,-.05,!0)},rotateLeft:function(){return e.rotate(-4,!0)},rotateRight:function(){return e.rotate(4,!0)},increaseAlpha:function(){return e.alpha(.05,!0)},decreaseAlpha:function(){return e.alpha(-.05,!0)},moveLeft:function(){return e.move(-4,0,!0)},moveRight:function(){return e.move(4,0,!0)},moveUp:function(){return e.move(0,-4,!0)},moveDown:function(){return e.move(0,4,!0)},delete:function(){return e.delete()}},this.keyBindings=[{keys:["meta+="],command:"scaleUp"},{keys:["meta+-"],command:"scaleDown"},{keys:["meta+["],command:"rotateLeft"},{keys:["meta+]"],command:"rotateRight"},{keys:["arrowleft"],command:"moveLeft"},{keys:["arrowright"],command:"moveRight"},{keys:["arrowup"],command:"moveUp"},{keys:["arrowdown"],command:"moveDown"},{keys:["meta+0"],command:"increaseAlpha"},{keys:["meta+9"],command:"decreaseAlpha"},{keys:["delete"],command:"delete"}]}},{key:"enable",value:function(){this.input.enable()}},{key:"disable",value:function(){this.input.disable()}},{key:"hasItem",value:function(e){return null!=this.items[e]}},{key:"add",value:function(e,t){return this.items[e]={name:e,display:t,data:{}},t.interactive=!0,this.input.on(t.name,P.a.DOWN,"_onItemDown",this),this.input.on(t.name,P.a.MOVE,"_onItemMove",this),this.input.on(t.name,P.a.UP,"_onItemUp",this),this.input.on(t.name,P.a.OVER,"_onItemOver",this),this.input.on(t.name,P.a.OUT,"_onItemOut",this),this.itemAdded.dispatch(e),this.items[e]}},{key:"remove",value:function(e){var t=this.items[e];t&&(this.deselect(e),this.input.remove(t.name,P.a.DOWN,"_onItemDown"),this.input.remove(t.name,P.a.MOVE,"_onItemMove"),this.input.remove(t.name,P.a.UP,"_onItemUp"),this.input.remove(t.name,P.a.OVER,"_onItemOver"),this.input.remove(t.name,P.a.OUT,"_onItemOut"),t.data=null,t.display=null,t.name=null,delete t.data,delete t.display,delete t.name,this.items[e]=null,delete this.items[e],this.itemRemoved.dispatch(e))}},{key:"selectTool",value:function(e){var t=this,i=null!=this.selectedTools.find((function(t){return t==e}));if(this.selectedTools=this.selectedTools.filter((function(t){return t!=e})).concat(e),this.console.log("Tool selected: ".concat(e)),this.tools[e]&&!i){var n=this.tools[e];if(!this.multiTool)this.selectedTools.filter((function(t){return t!=e})).forEach((function(e){t.tools[e].deselect(),t.selectedTools=t.selectedTools.filter((function(t){return e!=t}))}));n.select(),this.toolSelected.dispatch(e)}}},{key:"select",value:function(e,t){this.items[e]&&(!this.options.multiSelect&&this.selectedItems.length>0&&this.deselect(),C.a.includes(e,this.selectedItems)||(this.selectedItems.push(e),this.itemSelected.dispatch(e),this.console.log("item selected:",e),t&&(this.interactTarget=e)))}},{key:"deselect",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(t)C.a.remove(t,this.selectedItems),this.console.log("item item deselected:",t),this.itemDeselected.dispatch(t);else{var i=this.selectedItems.concat();this.selectedItems.length=0,i.forEach((function(t){e.console.log("item item deselected:",t),e.itemDeselected.dispatch(t)}))}}},{key:"hasSelected",value:function(e){return e?C.a.includes(e,this.selectedItems):this.selectedItems.length>0}},{key:"getItemByDisplay",value:function(e){for(var t in this.items){var i=this.items[t];if(i.display==e)return i}return null}},{key:"getItem",value:function(e){return this.items[e]}},{key:"handleItem",value:function(e,t){var i=this;if(e){var n=this.items[e];n&&t(n)}else this.selectedItems.forEach((function(e){return t(i.items[e])}))}},{key:"update",value:function(e){this.options.spaceMove&&(L.a.isKeyDown("space")?this.selectTool("hand"):"hand"==this.selectedTools&&this.selectTool(this.prevTool)),this._updateTool("update")}},{key:"delete",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.handleItem(t,(function(t){e.remove(t.name)}))}},{key:"move",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.handleItem(n,(function(n){n.display.x=i?n.display.x+e:e,n.display.y=i?n.display.y+t:t}))}},{key:"scale",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.handleItem(n,(function(n){n.display.scale.x=i?n.display.scale.x+e:e,n.display.scale.y=i?n.display.scale.y+t:t}))}},{key:"rotate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.handleItem(i,(function(i){i.display.rotation=t?i.display.rotation+T.a.toRadians(e):T.a.toRadians(e)}))}},{key:"alpha",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.handleItem(i,(function(i){i.display.alpha=t?i.display.alpha+e:e}))}},{key:"destroy",value:function(){this.container=null,this.itemSelected.removeAll(),this.itemDeselected.removeAll(),this.itemAdded.removeAll(),this.itemRemoved.removeAll(),this.itemOver.removeAll(),this.itemOut.removeAll(),this.toolSelected.removeAll(),this.console.disable()}},{key:"_onDown",value:function(e){this.input.handleInputEvent(e,P.a.DOWN)}},{key:"_onUp",value:function(e){this.input.handleInputEvent(e,P.a.UP)}},{key:"_onMove",value:function(e){this.input.handleInputEvent(e,P.a.MOVE)}},{key:"_stageDown",value:function(e){var t=this.getItem(e.target);this.interactTarget=t?t.name:null,this.console.log(e.target,e.currentTarget),this._updateTool("stageDown")}},{key:"_stageUp",value:function(e){this._updateTool("stageUp")}},{key:"_stageMove",value:function(e){var t=this.getItem(e.target);t?this.interactTarget=t.name:this.input.isDown||(this.interactTarget=null),this._updateTool("move"),this._updateTool("stageMove")}},{key:"_handleInteraction",value:function(e,t){var i=this.getItem(e);i?(this.interactTarget=i.name,this.options.selectOn!=t||this.hasSelected(i.name)||this.select(i.name)):(this.interactTarget=null,this.options.deselectOn==t&&this.deselect()),this._updateTool(t)}},{key:"_validateInteraction",value:function(e){if(!e)return!1;for(var t=e;t;){if(this.getItemByDisplay(t))return!0;t=t.parent}return!1}},{key:"_updateTool",value:function(e){var t=this;this.selectedTools.forEach((function(i){var n=t.tools[i];n&&n[e]&&n[e]()}))}},{key:"_onItemDown",value:function(e){this.input.enabled&&(this._handleInteraction(e.target,"down"),this.itemOver.dispatch(e.target),this.e=e)}},{key:"_onItemUp",value:function(e){this.input.enabled&&(this._handleInteraction(e.target,"up"),this.itemOver.dispatch(e.target))}},{key:"_onItemMove",value:function(e){this.input.enabled&&(this._handleInteraction(e.target,"move"),this.itemOver.dispatch(e.target))}},{key:"_onItemOver",value:function(e){this.input.enabled&&(this._handleInteraction(e.target,"over"),this.itemOver.dispatch(e.target))}},{key:"_onItemOut",value:function(e){this.input.enabled&&(this._handleInteraction(e.target,"out"),this.itemOut.dispatch(e.target))}}]),e}();function R(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var B=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.controls}var t,i,n;return t=e,(i=[{key:"setControls",value:function(e){this.controls=e}},{key:"down",value:function(){}},{key:"up",value:function(){}},{key:"move",value:function(){}},{key:"over",value:function(){}},{key:"out",value:function(){}},{key:"stageUp",value:function(){}},{key:"stageDown",value:function(){}},{key:"stageMove",value:function(){}},{key:"update",value:function(){}},{key:"select",value:function(){}},{key:"deselect",value:function(){}},{key:"items",get:function(){return this.controls.items}},{key:"selectedItems",get:function(){return this.controls.selectedItems}},{key:"interactTarget",get:function(){return this.controls.interactTarget}},{key:"input",get:function(){return this.controls.input}},{key:"options",get:function(){return this.controls.options}}])&&R(t.prototype,i),n&&R(t,n),e}(),U=i(19);function F(e){return(F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function W(e,t){return!t||"object"!==F(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function X(e){return(X=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function H(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function G(e,t,i){return t&&H(e.prototype,t),i&&H(e,i),e}function z(e,t){return(z=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var V=function(e){function t(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=i.stickyDrag,a=i.stickyDragThreshold,o=i.deselectPostDrag,s=i.translateX,r=i.translateY;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=W(this,X(t).call(this)))._stickyDrag=n||!1,e.stickyDragThreshold=a||100,e.deselectPostDrag=o,e.dragStarted=!1,e.moveStart=new signals.Signal,e.moveEnd=new signals.Signal,e.onRelease=new signals.Signal,e.lastInput=null,e._stick=!1,e.translateX=null==s||s,e.translateY=null==r||r,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&z(e,t)}(t,e),G(t,[{key:"canMove",get:function(){return this.stick||this.input.isDown&&this.interactTarget&&this.initialTarget}},{key:"stick",get:function(){return this._stick},set:function(e){this.stickyDrag?this._stick=e:this._stick=!1}},{key:"stickyDrag",get:function(){return this._stickyDrag},set:function(e){this._stickyDrag=e,this._stickyDrag||(this.stick=!1)}}]),G(t,[{key:"down",value:function(){}},{key:"up",value:function(){}},{key:"release",value:function(){var e=this;this.interactTarget&&!this._snapped||(this.stick=!1),!this._snapped&&!this.dragStarted||this.stick||(this._snapped=!1,this.selectedItems.forEach((function(t){e.items[t].data.mouseOffset=null})),this.endDrag(),this.deselectPostDrag&&this.controls.deselect()),this.onRelease.dispatch()}},{key:"stageDown",value:function(){var e=this.input.getLastInput(P.a.DOWN);this.stickyDrag&&this.interactTarget&&(this.stick=!this.stick),this.initialTarget=this.interactTarget,e&&e.touch&&this.lastInput&&this.stickyDrag&&!this.interactTarget&&this.controls.hasSelected()&&!this.dragStarted&&b.a.distance(this.lastInput.position,e.position)>this.stickyDragThreshold&&(this.moveItems(!0),this._snapped=!0),this.lastInput=e}},{key:"startDrag",value:function(){this.dragStarted||(console.log("drag started"),this.dragStarted=!0,this.moveStart.dispatch())}},{key:"endDrag",value:function(){this.dragStarted&&(console.log("drag ended",this._snapped,this.dragStarted),this.dragStarted=!1,this.moveEnd.dispatch())}},{key:"stageMove",value:function(){var e=this.input.getLastInput(P.a.MOVE);this.controls.hasSelected()&&this.canMove&&this.initialTarget&&!this.dragStarted&&(!this.stickyDrag||b.a.distance(e.position,e.initial)>this.stickyDragThreshold)&&this.startDrag()}},{key:"stageUp",value:function(){var e=this.input.getLastInput(P.a.UP);this.controls.hasSelected()||(this.lastInput=null),this.release(),this.stick?this.startDrag():this.initialTarget=null,!this.interactTarget&&b.a.distance(e.position,e.initial)<50&&(console.log("deselect!"),this.controls.deselect())}},{key:"moveItems",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=this.controls,n=this.input.getLastInput(),a=this.input.getLastInput(P.a.DOWN);n&&this.stickyDrag&&n.dragDistance&&n.dragDistance.length>this.stickyDragThreshold&&(this.stick=!1,this._snapped=!1),this.selectedItems.forEach((function(o){var s,r=e.items[o],l=new PIXI.Point;if(!r.data.fixed){if(t&&r.data.mouseOffset?r.data.lastClick=a.timestamp:(s=r.display.parent.toGlobal(r.display.position),r.data.lastClick&&r.data.lastClick==a.timestamp||(r.data.mouseOffset=new b.a(s.x,s.y,n.position.x,n.position.y),r.data.lastClick=a.timestamp)),l.set(n.position.x+(r.data.mouseOffset?r.data.mouseOffset.vx:0),n.position.y+(r.data.mouseOffset?r.data.mouseOffset.vy:0)),l.x=e.translateX?n.position.x+r.data.mouseOffset.vx:s.x,l.y=e.translateY?n.position.y+r.data.mouseOffset.vy:s.y,r.data.bounds){var c=r.data.bounds;l.x>c.right?l.x=c.right:l.x<c.left&&(l.x=c.left),l.y>c.bottom?l.y=c.bottom:l.y<c.top&&(l.y=c.top)}l=r.display.parent.toLocal(l),i.move(l.x,l.y,!1,r.name)}}))}},{key:"update",value:function(){this.canMove&&this.moveItems()}}]),t}(B);function q(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Y=function(){function e(t,i,n,a){switch(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),arguments.length){case 0:this.r=255,this.g=255,this.b=255,this.a=255;break;case 1:this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a;break;case 2:this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this.averageWith(i);break;case 3:this.r=t,this.g=i,this.b=n,this.a=255;break;case 4:this.r=t,this.g=i,this.b=n,this.a=a}}var t,i,n;return t=e,n=[{key:"lerp",value:function(t,i,n){return new e(t.r*(1-n)+i.r*n,t.g*(1-n)+i.g*n,t.b*(1-n)+i.b*n,t.a*(1-n)+i.a*n)}}],(i=[{key:"isWhite",value:function(){return 255===this.r&&255===this.g&&255===this.b&&255===this.a}},{key:"hexPad",value:function(e){return(e=Math.floor(e).toString(16)).length>1?e.substring(0,2):"0"+e}},{key:"averageWith",value:function(e){return this.r=(this.r+e.r)/2,this.g=(this.g+e.g)/2,this.b=(this.b+e.b)/2,this.a=(this.a+e.a)/2,this}},{key:"toHexString",value:function(){var e="#";return e+=this.hexPad(this.r),e+=this.hexPad(this.g),e+=this.hexPad(this.b)}},{key:"toRGBString",value:function(){var e="rgb(";return e+=Math.floor(this.r)+",",e+=Math.floor(this.g)+",",e+=Math.floor(this.b)+")"}},{key:"toRGBAString",value:function(){var e="rgba(";return e+=Math.floor(this.r)+",",e+=Math.floor(this.g)+",",e+=Math.floor(this.b)+",",e+=Math.floor(this.a)+")"}},{key:"toInt",value:function(){var e=this.toHexString(),t="string"==typeof e?e.replace("#","0x"):e;return parseInt(t)}},{key:"fromHexString",value:function(e){return this.r=parseInt(e.substring(1,3),16),this.g=parseInt(e.substring(3,5),16),this.b=parseInt(e.substring(5),16),this}},{key:"fromRGBString",value:function(e){var t=e.split(",");return this.r=parseInt(t[0].substring(4)),this.g=parseInt(t[1]),this.b=parseInt(t[2]),this}},{key:"fromRGBAString",value:function(e){var t=e.split(",");return this.r=parseInt(t[0].substring(5)),this.g=parseInt(t[1]),this.b=parseInt(t[2]),this.a=parseInt(t[3]),this}},{key:"fromString",value:function(e){return 0===e.indexOf("#")?this.fromHexString(e):0===e.indexOf("rgb(")?this.fromRGBString(e):0===e.indexOf("rgba(")&&this.fromRGBAString(e),this}}])&&q(t.prototype,i),n&&q(t,n),e}(),Q=i(25),K=i(21),J=i(12);function $(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Z=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,i,n;return t=e,n=[{key:"between",value:function(e,t){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];e>=0&&t<1&&(i=!1);var n=Math.random()*(t-e+(i?1:0));return i?Math.floor(n)+e:n+e}},{key:"shuffle",value:function(t){for(var i,n=[],a=t.concat(),o=0;o<a.length;o++)i=e.between(0,a.length-1),n.push(a[i]),a.splice(i,1),o--;return n}},{key:"coinFlip",value:function(){return 0==e.between(0,1)}},{key:"position",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0,width:800,height:600},i={};return i.x=e.between(t.x,t.x+t.width),i.y=e.between(t.y,t.y+t.height),i}},{key:"from",value:function(t){return t[Math.floor(e.between(0,t.length-1))]}}],(i=null)&&$(t.prototype,i),n&&$(t,n),e}();function ee(e){return(ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function te(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ie(e,t){return!t||"object"!==ee(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ne(e){return(ne=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ae(e,t){return(ae=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var oe=function(e){function t(e,i){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e=void 0!==e?e:{},ie(this,ne(t).call(this,e,i))}var i,n,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ae(e,t)}(t,e),i=t,(n=[{key:"init",value:function(){var e=this;this.sectionWidth=90,this.halfSection=this.sectionWidth/2;var t=new O({rows:8,columns:7,sectionWidth:90,sectionHeight:90,x:g.a.safeLeft+290,y:g.a.safeTop+24});this.drawGrid(t,t.x,t.y,5592405,5),this.grid=t,this.selectedOutline=new K.a(5,16777215),this.create({name:"pcontainer_connect",type:"pcontainer",assets:[{name:"particles_sheet",frame:"starparticle.png"}],config:"connect_particles",renderLayer:"ui"}),this.connectParticles=this.get("pcontainer_connect"),this.connectParticles.emitter.emit=!1,this.color=new Y,Object.keys(this.sceneData.utilities).forEach((function(t){e.sceneData.utilities[t].color=e.color.fromHexString(e.sceneData.utilities[t].color).toInt()})),this.isDrawing=!1,this.playingExclamation=!1,this.caList=["excl_almost_there","excl_nicely_done","excl_yougotthis"],this.caList=Z.shuffle(this.caList),this.waList=["excl_oopstryagain"],this.crossList=["excl_dntcrosspipes"],this.utilities=Object.assign({},this.sceneData.utilities),Object.keys(this.utilities).forEach((function(t){var i=e.utilities[t],n=e.grid.getSection(i.startPos[0],i.startPos[1]);i.pathHistory=[n],i.pathLine=new Q.a,e.get("pathContainer").addChild(i.pathLine),i.pointArray=[]})),this.currentUtility=this.utilities.water,this.showCurrentSelectedUtility(),this.setupGameBoard(),this.added.add((function(t){return e.onAdded(t)})),this.drawableArea=[],this.grid.traverse((function(t){return e.setupDrawingTile(t)}),0,0,7,6),this.grid.traverse((function(t){t.items.forEach((function(t){e.input.on(t.name,P.a.UP,"onGridReleased",e)}))}),0,0,7,6),this.animator=new J.a(game.config.anim_global)}},{key:"setupGameBoard",value:function(){for(var e=0;e<this.sceneData.boardLayout.length;e++){var t=this.sceneData.boardLayout[e].name,i=this.get(t),n=this.sceneData.boardLayout[e].gridCoords,a=this.grid.getSection(n[0],n[1]);i.x=a.x+5,i.y=a.y+5,"house"===t?i.hitArea=new PIXI.Rectangle(0,0,0,0):this.grid.listItemAtCoords(i,i.x,i.y),this.utilities[t]&&(i.x+=this.halfSection-2.5,i.y+=this.halfSection-2.5,this.input.on(t,P.a.DOWN,"onGridSelected",this))}}},{key:"setupDrawingTile",value:function(e){if(!(e.items.length>0)){var t=this.create({name:"rect_"+e.row+"_"+e.column,type:"rect",width:85,height:85,top:5,left:5,x:e.x,y:e.y,color:16777215,interactive:!0,group:"gridContainer"});t.tint=9217595,t.utilityType="none",this.grid.listItemAtCoords(t,e.x,e.y),this.drawableArea.push(t)}}},{key:"onAdded",value:function(e){this.input.on(e,P.a.DOWN,"onGridSelected",this),this.input.on(e,P.a.MOVE,"onGridMove",this)}},{key:"onGridSelected",value:function(e){var t=this.get(e.target),i=this.grid.getSectionAtCoords(t.x,t.y);this.selectDifferentUtility(t,i),this.canEnterTile(t,i)&&(this.isDrawing=!0,this.onEnterNewTile(t,i))}},{key:"onGridMove",value:function(e){var t=this.get(e.target),i=this.grid.getSectionAtCoords(t.x,t.y);this.isDrawing&&this.canEnterTile(t,i)&&this.onEnterNewTile(t,i)}},{key:"onGridReleased",value:function(e){this.isDrawing=!1}},{key:"selectDifferentUtility",value:function(e,t){var i=this;this.utilities[e.name]?this.currentUtility=this.utilities[e.name]:Object.keys(this.utilities).forEach((function(e){i.utilities[e].pathHistory.includes(t)&&(i.currentUtility=i.utilities[e])})),this.showCurrentSelectedUtility()}},{key:"showCurrentSelectedUtility",value:function(){var e=this;Object.keys(this.utilities).forEach((function(t){e.get(t).filters=[]})),this.get(this.currentUtility.type).filters=[this.selectedOutline]}},{key:"canEnterTile",value:function(e,t){var i=this;if(!0!==this.currentUtility.finalConnection){var n=this.currentUtility.pathHistory.slice(-1)[0],a=n.row,o=n.column,s=t.row,r=t.column,l=null;return Object.keys(this.utilities).forEach((function(e){i.utilities[e].pathHistory.includes(t)&&(l=i.utilities[e])})),null!==l?!!this.currentUtility.pathHistory.includes(t)||(this.showExclamation(this.crossList),!1):!0!==this.checkForEndPosition(n)&&(a!==s||o!==r)&&(a===s||o===r)&&(s===a-1||r===o+1||s===a+1||r===o-1||void 0)}}},{key:"checkForEndPosition",value:function(e){var t=this,i=!1,n=!1;return Object.keys(this.utilities).forEach((function(a){var o=t.utilities[a],s=t.grid.getSection(o.endPos[0],o.endPos[1]),r=t.grid.getSection(o.connectPos[0],o.connectPos[1]);e===s&&(i=!0),e===r&&(n=!0)})),i||n}},{key:"onEnterNewTile",value:function(e,t){var i=this.currentUtility.pathHistory.slice(-1)[0],n=this.grid.getSection(this.currentUtility.connectPos[0],this.currentUtility.connectPos[1]),a=this.grid.getSection(this.currentUtility.endPos[0],this.currentUtility.endPos[1]);if(t===i||t===a);else if(this.currentUtility.pathHistory.includes(t)&&t!==n){for(;i!==t;)this.currentUtility.pathHistory.pop(),i=this.currentUtility.pathHistory.slice(-1)[0];game.sound.play("hookup_square")}else if(t===n&&!1===this.currentUtility.pathHistory.includes(a)){this.currentUtility.pathHistory.push(t),this.currentUtility.pathHistory.push(a),console.log(this.currentUtility.pathHistory);for(var o=!0,s=0;s<this.currentUtility.finalPath.length;s++){var r=this.currentUtility.finalPath[s];this.grid.getSection(r[0],r[1])!==this.currentUtility.pathHistory[s]&&(o=!1)}this.onNewConnection(a,o),this.checkForConnectionsComplete(),game.sound.play("hookup_house")}else!1===this.currentUtility.pathHistory.includes(a)&&(this.currentUtility.pathHistory.push(t),game.sound.play("hookup_square"));this.updatePath()}},{key:"updatePath",value:function(){var e=this;this.currentUtility.pathLine.clear(),this.currentUtility.pathLine.lineStyle(20,this.currentUtility.color);var t=this.currentUtility.pathHistory.map((function(t){return{x:t.x+e.halfSection,y:t.y+e.halfSection}}));this.currentUtility.pointArray=t,this.currentUtility.pathLine.drawPath(t)}},{key:"onNewConnection",value:function(e,t){var i=this;this.isDrawing=!1,this.connectParticles.emitter.updateOwnerPos(e.x+this.halfSection,e.y+this.halfSection),this.connectParticles.emitter.emit=!0,TweenMax.delayedCall(.02,(function(){i.connectParticles.emitter.emit=!1})),t?(this.currentUtility.finalConnection=!0,this.showExclamation(this.caList),game.sound.play("maze_end")):this.showExclamation(this.waList)}},{key:"checkForConnectionsComplete",value:function(){var e=this,t=!0;Object.keys(this.utilities).forEach((function(i){var n=e.utilities[i];n.pathHistory.slice(-1)[0]!==e.grid.getSection(n.endPos[0],n.endPos[1])&&(console.log(i+" not connected"),t=!1)})),t&&this.onAllConnected()}},{key:"onUtilitySelected",value:function(e){this.isDrawing=!0,this.currentUtility=this.sceneData.utilities[e]}},{key:"update",value:function(){}},{key:"drawGrid",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;game.stage.calculateBounds();var o=game.scaleManager.getMaxBounds(),s=(o.width,o.height,new PIXI.Graphics),r=!e;r&&(s.beginFill(11184810,.5),s.drawRect(0,0,8*e.sectionWidth,8*e.sectionHeight),s.endFill());for(var l=0;l<8*e.sectionHeight;l+=e.sectionHeight){var c=l%(8*e.sectionHeight)==0?.65:.5,u=l%(8*e.sectionHeight)==0?3355443:5592405;s.lineStyle(a+.5,n||u,c),s.moveTo(0,l),s.lineTo(8*e.sectionWidth,l)}for(var h=0;h<8*e.sectionWidth;h+=e.sectionWidth){var d=h%(8*e.sectionWidth)==0?.6:.5,f=h%(8*e.sectionWidth)==0?3355443:5592405;s.lineStyle(a+.5,n||f,d),s.moveTo(h,0),s.lineTo(h,8*e.sectionHeight)}var p=new PIXI.Container,y=new PIXI.Sprite;y.addChild(s);var m=game.renderer.generateTexture(y);y.destroy();var v=new PIXI.extras.TilingSprite(m);v.parentLayer=game.getLayer("grid"),v.parentGroup=v.parentLayer.group,r?(v.x=-2048,v.y=-2048,v.width=Math.abs(3*v.x),v.height=Math.abs(3*v.y)):(v.x=t,v.y=i,v.width=e.gridWidth+a,v.height=e.gridHeight+a),p.addChild(v),s.destroy(),this.get("gridContainer").addChild(p)}},{key:"showExclamation",value:function(e){var t=this;if(!0!==this.playingExclamation){this.playingExclamation=!0;var i=C.a.cycleArray(e),n=this.create({name:"exclamation",type:"sprite",asset:i,x:g.a.centerX+60,y:g.a.centerY+40,anchor:.5,alpha:0,scale:.5});this.animator.setupAnimation("exclamationFade","fadeUpOut",n),this.animator.play("exclamationFade",0,(function(){t.remove("exclamation"),t.playingExclamation=!1}))}}},{key:"onAllConnected",value:function(){var e=this;!0!==this.complete&&(this.complete=!0,this.showCompleteMessage(),game.globalState.gameCompletion[this.name]=!0,TweenMax.delayedCall(3,(function(){e.endActivity(!1)})),game.sound.play("general_levelcomplete"))}},{key:"showCompleteMessage",value:function(){this.create({name:"completionContainer",type:"group",x:"centerX",y:"centerY",anchor:.5,elements:[{name:"completionbadge",type:"sprite",asset:"completionbadge",x:0,y:0,anchor:.5},{name:"successtext",type:"text",text:"YOU DID IT!",style:{fontFamily:["BowlerHand","Helvetica","Arial"],fontSize:40,fontWeight:"bold",fill:"#010101"},x:0,y:-10,anchor:.5}]});var e=this.get("completionContainer"),t=this.get("successtext");TweenMax.fromTo(t.scale,.8,{x:0,y:0},{x:1,y:1,delay:.5,ease:Back.easeOut}),TweenMax.fromTo(e.scale,1,{x:0,y:0},{x:1,y:1,ease:Back.easeOut}),this.animator.isPlaying("exclamationFade")&&this.animator.stop("exclamationFade"),this.remove("exclamation")}},{key:"endActivity",value:function(e){TweenMax.killAll(),activitySignal.dispatch("end_activity",{activityName:this.name,activitiesCompleted:game.globalState.gameCompletion}),e&&game.sound.play("general_exit")}},{key:"showHelpMenu",value:function(){activitySignal.dispatch("show_help",{activityName:this.name})}},{key:"downloadActivity",value:function(){activitySignal.dispatch("download",{activityName:this.name})}},{key:"exit",value:function(){TweenMax.killAll()}}])&&te(i.prototype,n),a&&te(i,a),t}(u.a),se=i(58);function re(e){return(re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function le(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ce(e,t){return!t||"object"!==re(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ue(e){return(ue=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function he(e,t){return(he=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var de=function(e){function t(e,i){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e=void 0!==e?e:{},ce(this,ue(t).call(this,e,i))}var i,n,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&he(e,t)}(t,e),i=t,(n=[{key:"init",value:function(){this.activeColor=2724817,this.areasColored=0,game.scaleManager.addItem(this.get("palettebg"),{align:"top-left",x:-150,y:0}),game.scaleManager.addItem(this.get("colorPalette"),{align:"top-left",x:-120,y:0});var e=new O({rows:5,columns:9,sectionWidth:128,sectionHeight:128,x:g.a.safeLeft,y:g.a.safeTop});this.hitRect={x:-64,y:-64,width:128,height:128},this.grid=e,this.items=[],this.playingExclamation=!1,this.caList=["excl_awesome","excl_lookinggood","excl_oohlala"],this.caList=Z.shuffle(this.caList),this.animator=new J.a(game.config.anim_global)}},{key:"start",value:function(){this.generateSwatches(),this.initColoringPage()}},{key:"update",value:function(){}},{key:"generateSwatches",value:function(){var e=this,t=this.sceneData.paletteColors,i=[];t.forEach((function(t,n){t=T.a.hexToInt(t);var a="swatchGroup_"+n,o="color_"+n,s=Z.between(-80,-20),r=42*n;e.create({name:a,type:"group",group:"colorPalette",x:s,y:r}).initialX=s;var l=e.create({name:o,type:"sprite",asset:"pencil_fill",group:a,x:0,y:0,interactive:!0});l.tint=t,l.colorData=t,i.push(l),e.input.on(o,P.a.DOWN,"selectColor",e),e.input.on(o,P.a.OVER,"swatchOver",e),l.on("pointerover",(function(t){return e.input.handleInputEvent(t,P.a.OVER)})),e.input.on(o,P.a.OUT,"swatchOut",e),l.on("pointerout",(function(t){return e.input.handleInputEvent(t,P.a.OUT)})),e.create({name:o+"_outline",type:"sprite",asset:"pencil_outlines",group:a,x:0,y:-2}).hitArea=new PIXI.Rectangle(0,0,0,0);var c=e.create({name:o+"_select",type:"sprite",asset:"pencil_select",group:a,renderLayer:"ui",x:-6,y:-9,alpha:0});c.hitArea=new PIXI.Rectangle(0,0,0,0),l.selectOutline=c})),this.swatches=i,this.activeColor=this.swatches[9].colorData,this.swatches[9].selectOutline.alpha=1}},{key:"initColoringPage",value:function(){this.input.on("bgRect",P.a.DOWN,"fillWithColor",this);for(var e=this.get("coloringGroup").children,t=0;t<e.length;t++){var i=e[t].name.toLowerCase();i.includes("outlines")?e[t].hitArea=new PIXI.Rectangle(0,0,0,0):(se[i]&&(e[t].hitArea=this.getPolygonHitArea(e[t],se[i])),e[t].interactive=!0,this.input.on(e[t].name,P.a.DOWN,"fillWithColor",this))}this.colorables=e}},{key:"getPolygonHitArea",value:function(e,t){var i=t.map((function(t,i){var n=i%2==0?"x":"y";return t-e["x"==n?"width":"height"]*e.anchor[n]}));return new PIXI.Polygon(i)}},{key:"fillWithColor",value:function(e){this.get(e.target).tint=this.activeColor,game.sound.play("color_paint"),this.areasColored++,this.areasColored%4==0&&this.showExclamation(this.caList)}},{key:"selectColor",value:function(e){var t=this.get(e.target);this.activeColor=t.colorData;for(var i=0;i<this.swatches.length;i++)this.swatches[i].selectOutline.alpha=0;t.selectOutline.alpha=1,game.sound.play("color_grab")}},{key:"swatchOver",value:function(e){var t=this.get(e.target);t.parent&&TweenMax.to(t.parent,.2,{x:t.parent.initialX+10,ease:Back.easeOut})}},{key:"swatchOut",value:function(e){var t=this.get(e.target);t.parent&&TweenMax.to(t.parent,.2,{x:t.parent.initialX,ease:Back.easeOut})}},{key:"showExclamation",value:function(e){var t=this;if(!0!==this.playingExclamation){this.playingExclamation=!0;var i=C.a.cycleArray(e),n=this.create({name:"exclamation",type:"sprite",asset:i,x:g.a.centerX,y:g.a.centerY,anchor:.5,alpha:0,scale:.5});this.animator.setupAnimation("exclamationFade","fadeUpOut",n),this.animator.play("exclamationFade",0,(function(){t.remove("exclamation"),t.playingExclamation=!1}))}}},{key:"endActivity",value:function(){game.globalState.gameCompletion[this.name]=!0,activitySignal.dispatch("end_activity",{activityName:this.name,activitiesCompleted:game.globalState.gameCompletion}),game.sound.play("general_levelcomplete")}},{key:"showHelpMenu",value:function(){activitySignal.dispatch("show_help",{activityName:this.name})}},{key:"downloadActivity",value:function(){activitySignal.dispatch("download",{activityName:this.name})}},{key:"downloadFinishedPage",value:function(){var e=this,t=["activityInstructions","palettebg","colorPalette","doneButton","closeButton","helpButton","downloadButton"];t.forEach((function(t){e.get(t).visible=!1})),game.pixiApp.view.width=game.scaleManager.safeSize.width;var i=(game.scaleManager.maxSize.width-game.scaleManager.safeSize.width)/2;game.scene.container.x=-i,game.renderer.render(game.stage);var n=game.pixiApp.view.toDataURL("image/png");game.scene.container.x=0,game.pixiApp.view.width=game.scaleManager.maxSize.width,activitySignal.dispatch("save_image",{title:"SniffyTheSkunkColoring.png",image:n}),t.forEach((function(t){e.get(t).visible=!0})),game.renderer.render(game.stage)}},{key:"requestActivityShare",value:function(){activitySignal.dispatch("request_share",{shareType:"activity_share"})}},{key:"shareActivity",value:function(){console.log("Share this thing!");var e=game.pixiApp.view.toDataURL("image/png");activitySignal.dispatch("activate_social",{body:"Sniffy the Skunk say Smell Gas? Act Fast!",image:e})}},{key:"exit",value:function(){game.scaleManager.removeItem(this.get("palettebg")),game.scaleManager.removeItem(this.get("colorPalette"))}}])&&le(i.prototype,n),a&&le(i,a),t}(u.a);function fe(e){return(fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pe(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ye(e,t){return!t||"object"!==fe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function me(e){return(me=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ve(e,t){return(ve=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ge=function(e){function t(e,i){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e=void 0!==e?e:{},ye(this,me(t).call(this,e,i))}var i,n,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ve(e,t)}(t,e),i=t,(n=[{key:"init",value:function(){var e=this;this.moveTool=new V,this.controls=new N(this.container,{tools:{move:this.moveTool}}),this.controls.itemSelected.add((function(){return e.onBubbleGrabbed()})),this.moveTool.onRelease.add((function(){return e.onBubbleReleased()})),this.controls.selectTool("move"),this.lastSpawnIndex=0,this.bubbleStreamRanges=[[50,150],[200,300],[350,400]],this.questionIndex=0,this.questionData=Array.from(this.sceneData.questionData),this.problems=[],this.excludeAnswers=[],this.currentProblem=null,this.createNewProblem(this.questionData[this.questionIndex]),this.bubbleTimeCount=0,this.bubblesMade=0,this.complete=!1,this.waitingForNextProblem=!1,this.character=this.get("character")}},{key:"start",value:function(){}},{key:"update",value:function(){var e=this;if(!this.complete&&!this.waitingForNextProblem&&(this.controls.update(),this.bubbleTimeCount++,this.bubbleTimeCount>50)){var t=this.questionData[this.questionIndex],i=t.answer;this.bubblesMade%5!=2&&(t.answer<10&&this.excludeAnswers.length<10?i=this.randomIntExclude(this.excludeAnswers,10):t.answer>=10&&this.excludeAnswers.length<100&&(i=this.randomIntExclude(this.excludeAnswers)));var n=this.createBubble(i);TweenMax.to(n,8,{y:50,ease:Sine.easeInOut,onComplete:function(){e.remove(n.name)}}),n.scale.set(0),TweenMax.to(n.scale,.8,{x:1,y:1,ease:Back.easeOut}),TweenMax.to(n.scale,.8,{x:0,y:0,delay:7,ease:Back.easeIn}),this.bubbleTimeCount=0}}},{key:"createNewProblem",value:function(e){var t="questionGroup_"+this.questionIndex,i=this.create({name:t,type:"group",x:"safeLeft+=25",y:"centerY-=100",interactive:!0,group:"problemGroup"});i.squares=[];for(var n=0;n<5;n++){e.answerSpace===n&&this.create({name:"q_"+this.questionIndex+"_bgsquare_"+n,type:"rect",width:100,height:100,top:0,left:0,x:100*n,y:0,anchor:.5,color:16777215,lineWidth:5,lineColor:0,lineAlpha:1,interactive:!0,group:t});var a=this.create({name:"q_"+this.questionIndex+"_square_"+n,type:"rect",width:100,height:100,top:0,left:0,x:100*n,y:0,anchor:.5,color:16777215,lineWidth:5,lineColor:0,lineAlpha:1,interactive:!0,group:t}),o=new PIXI.Text;o.style={fontFamily:["BowlerHand","Helvetica","Arial"],fontSize:60,fill:"#000000"},o.anchor.set(.5),o.position.set(50,50),o.text="",a.addChild(o),i.squares.push(a)}switch(i.squares[3].children[0].text="=",e.operator){case"add":i.squares[1].children[0].text="+";break;case"subtract":i.squares[1].children[0].text="-";break;case"multiply":i.squares[1].children[0].text="";break;case"divide":i.squares[1].children[0].text="";break;default:i.squares[1].children[0].text="?"}i.squares[0].children[0].text=e.firstNumber,i.squares[2].children[0].text=e.secondNumber,i.squares[4].children[0].text=e.total;var s=t+"_question",r=s+"_text",l=this.create({name:s,type:"group",group:t,x:0,y:150,elements:[{name:s+"_rect",type:"rect",top:0,left:0,width:500,height:300,lineWidth:5,lineColor:31162,lineAlpha:1,color:16711422},{name:s+"_questionmark",type:"text",x:50,y:10,anchorX:.5,text:"?",style:{fontFamily:["BowlerHand","Helvetica","Arial"],fontSize:80,fill:"#0079ba"}},{name:r,type:"text",x:90,y:10,text:e.question,style:{fontFamily:["BowlerHand","Helvetica","Arial"],fontSize:24,fill:"#000000",wordWrap:!0,wordWrapWidth:390}}]}),c=this.get(r),u=l.children[0],h=Math.max(c.height+20,120);u.clear(),u.lineStyle(5,31162,1),u.drawRect(0,0,500,h),u.endFill(),i.questionContainer=l,i.questionText=c,i.answerSpace=i.squares[e.answerSpace],i.answerSpace.children[0].text="",TweenMax.fromTo(i,.5,{y:i.y+20,alpha:0},{y:i.y,alpha:1}),this.excludeAnswers=[e.answer],this.problems.push(i),this.currentProblem=i}},{key:"createBubble",value:function(e){var t="numberBubble_"+e+"_"+Date.now();this.lastSpawnIndex=(this.lastSpawnIndex+1)%this.bubbleStreamRanges.length;var i=this.bubbleStreamRanges[this.lastSpawnIndex],n=Math.random()*(i[1]-i[0])+g.a.centerX+i[0],a=(Math.random(),this.create({name:t,type:"group",x:n,y:700,interactive:!0,group:"bubbleGroup"}));a.number=e,a.hitArea=new PIXI.Rectangle(-50,-50,100,100);var o=this.create({name:"b_"+e+"_bubble",type:"circle",circleX:0,circleY:0,radius:50,anchor:.5,color:16777215,lineWidth:5,lineColor:0,lineAlpha:1,interactive:!0,group:t});o.hitArea=new PIXI.Rectangle(0,0,0,0);var s=new PIXI.Text;return s.style={fontFamily:["BowlerHand","Helvetica","Arial"],fontSize:60,fill:"#000000"},s.anchor.set(.5),s.text=e.toString(),s.hitArea=new PIXI.Rectangle(0,0,0,0),o.addChild(s),this.bubblesMade++,this.controls.add(t,a),game.sound.play("math_bubbleappear",{volume:.2}),a}},{key:"randomIntExclude",value:function(e,t){var i=0;t=t||100;for(var n=Math.floor(Math.random()*t);e.indexOf(n)>-1&&i<1e3;)n=Math.floor(Math.random()*t),++i>=1e3&&console.log("MAX ATTEMPTS",e,t);return n}},{key:"onBubbleGrabbed",value:function(){var e=this.controls.selectedItems,t=this.get(e[0]);TweenMax.killTweensOf(t),game.sound.play("math_bubblegrab")}},{key:"onBubbleReleased",value:function(){var e=this,t=this.controls.selectedItems,i=this.get(t[0]);if(i){this.controls.remove(i),i.interactive=!1;var n=this.currentProblem.answerSpace.toGlobal(this.container.position);TweenMax.to(i,.5,{x:n.x+50,y:n.y+50,onComplete:function(){e.checkAnswer(i)}})}}},{key:"checkAnswer",value:function(e){TweenMax.killTweensOf(this.currentProblem.answerSpace),this.currentProblem.answerSpace.alpha=1,this.currentProblem.answerSpace.children[0].text=e.number,e.number===this.questionData[this.questionIndex].answer?this.onCorrectAnswer(e.number):this.onIncorrectAnswer(e.number),this.remove(e.name)}},{key:"onIncorrectAnswer",value:function(e){this.excludeAnswers.push(e),this.currentProblem.answerSpace.tint=16711680,TweenMax.to(this.currentProblem.answerSpace,.5,{alpha:0,delay:2}),game.sound.play("math_error")}},{key:"onCorrectAnswer",value:function(e){var t=this;this.controls.disable(),this.currentProblem.answerSpace.tint=11719221;var i=this.questionData[this.questionIndex].response;TweenMax.to(this.currentProblem.questionContainer,.2,{alpha:0,onComplete:function(){t.currentProblem.questionText.text=i;var e=t.currentProblem.questionContainer.children[1];e.text="A.",e.scale.set(.7);var n=t.currentProblem.questionContainer.children[0],a=Math.max(t.currentProblem.questionText.height+20,120);n.clear(),n.lineStyle(5,31162,1),n.drawRect(0,0,500,a),n.endFill()}}),TweenMax.to(this.currentProblem.questionContainer,.2,{alpha:1,delay:.4}),TweenMax.to(this.character,.6,{y:"-=420",repeatDelay:3.3,repeat:1,yoyo:!0,ease:Back.easeOut}),this.questionIndex++,this.questionIndex>=this.questionData.length?this.onAllProblemsAnswered():(this.waitingForNextProblem=!0,TweenMax.delayedCall(4,(function(){t.nextProblem()}))),game.sound.play("math_correct")}},{key:"nextProblem",value:function(){var e=this;this.controls.enable();var t=this.get(this.problems[this.questionIndex-1].name);TweenMax.fromTo(t,.5,{y:t.y,alpha:1},{y:t.y-20,alpha:0,onComplete:function(){e.remove(t.name),e.createNewProblem(e.questionData[e.questionIndex]),e.waitingForNextProblem=!1}})}},{key:"onAllProblemsAnswered",value:function(){var e=this;!0!==this.complete&&(this.complete=!0,game.globalState.gameCompletion[this.name]=!0,TweenMax.delayedCall(4,(function(){e.showCompleteMessage()})),TweenMax.delayedCall(5,(function(){e.endActivity()})))}},{key:"showCompleteMessage",value:function(){this.create({name:"completionContainer",type:"group",x:"centerX",y:"centerY",anchor:.5,elements:[{name:"completionbadge",type:"sprite",asset:"completionbadge",x:0,y:0,anchor:.5},{name:"successtext",type:"text",text:"YOU DID IT!",style:{fontFamily:["BowlerHand","Helvetica","Arial"],fontSize:40,fontWeight:"bold",fill:"#010101"},x:0,y:-10,anchor:.5}]});var e=this.get("completionContainer"),t=this.get("successtext");TweenMax.fromTo(t.scale,.8,{x:0,y:0},{x:1,y:1,delay:.5,ease:Back.easeOut}),TweenMax.fromTo(e.scale,1,{x:0,y:0},{x:1,y:1,ease:Back.easeOut}),game.sound.play("general_levelcomplete")}},{key:"endActivity",value:function(e){this.complete=!0,TweenMax.killAll(),activitySignal.dispatch("end_activity",{activityName:this.name,activitiesCompleted:game.globalState.gameCompletion}),e&&game.sound.play("general_exit")}},{key:"showHelpMenu",value:function(){activitySignal.dispatch("show_help",{activityName:this.name})}},{key:"downloadActivity",value:function(){activitySignal.dispatch("download",{activityName:this.name})}},{key:"exit",value:function(){}}])&&pe(i.prototype,n),a&&pe(i,a),t}(u.a);function be(e){return(be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function we(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ke(e,t){return!t||"object"!==be(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Se(e){return(Se=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function xe(e,t){return(xe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _e(e){return(_e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ie(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Te(e,t){return!t||"object"!==_e(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ee(e){return(Ee=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ae(e,t){return(Ae=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Oe=function(e){function t(e,i){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i=i||{},(n=Te(this,Ee(t).call(this,e))).minX=void 0!==i.minX?i.minX:-1/0,n.maxX=void 0!==i.maxX?i.maxX:1/0,n.minY=void 0!==i.minY?i.minY:-1/0,n.maxY=void 0!==i.maxY?i.maxY:1/0,n.moveThreshold=void 0!==i.moveThreshold?i.moveThreshold:0,n.invMultiplier=1,!0===i.inverted&&(n.invMultiplier=-1),n.camera=e,n.cameraPos=e.position.clone(),n.didMove=!1,n.onGrab=new signals.Signal,n.onMove=new signals.Signal,n.onRelease=new signals.Signal,n}var i,n,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ae(e,t)}(t,e),i=t,(n=[{key:"stageDown",value:function(){var e=this.controls.input.getLastInput(P.a.DOWN);g.a.getScreenValue("centerX"),g.a.getScreenValue("centerY"),this.travel=new b.a,this.travel.origin=e.position.clone(),this.cameraOrigin=this.camera.position.clone(),this.inputDown=!0,this.onGrab.dispatch()}},{key:"stageUp",value:function(){this.inputDown=!1,this.didMove&&(this.didMove=!1,this.onRelease.dispatch())}},{key:"deselect",value:function(){this.inputDown=!1,this.didMove&&(this.didMove=!1,this.onRelease.dispatch())}},{key:"stageMove",value:function(){if(this.inputDown){var e=this.controls.input.getLastInput();if(this.travel.x=e.position.x,this.travel.y=e.position.y,Math.abs(this.travel.x-this.travel.origin.x)+Math.abs(this.travel.y-this.travel.origin.y)<this.moveThreshold)return;var t=this.cameraOrigin.x-this.travel.vx*this.invMultiplier,i=this.cameraOrigin.y-this.travel.vy*this.invMultiplier;t=Math.max(this.minX,t),t=Math.min(this.maxX,t),i=Math.max(this.minY,i),i=Math.min(this.maxY,i),this.cameraPos.set(t,i),this.updatePos=!0,this.didMove=!0}}},{key:"update",value:function(){this.updatePos&&(this.cameraTween?(this.cameraTween.updateTo({x:this.cameraPos.x,y:this.cameraPos.y,ease:Power4.easeOut},!0),this.updatePos=!1):(this.cameraTween=TweenMax.to(this.camera,.4,{x:this.cameraPos.x,y:this.cameraPos.y,ease:Power4.easeOut}),this.updatePos=!1),this.onMove.dispatch())}}])&&Ie(i.prototype,n),a&&Ie(i,a),t}(function(e){function t(e){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=ke(this,Se(t).call(this))).camera=e,i.cameraPos=e.position.clone(),i}var i,n,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xe(e,t)}(t,e),i=t,(n=[{key:"stageDown",value:function(){var e=this.controls.input.getLastInput(P.a.DOWN);g.a.getScreenValue("centerX"),g.a.getScreenValue("centerY"),this.travel=new b.a,this.travel.origin=e.position.clone(),this.cameraOrigin=this.camera.position.clone(),this.inputDown=!0}},{key:"stageUp",value:function(){this.inputDown=!1}},{key:"deselect",value:function(){this.inputDown=!1}},{key:"stageMove",value:function(){if(this.inputDown){var e=this.controls.input.getLastInput();this.travel.x=e.position.x,this.travel.y=e.position.y,this.cameraPos.set(this.cameraOrigin.x-this.travel.vx,this.cameraOrigin.y-this.travel.vy),this.updatePos=!0}}},{key:"update",value:function(){this.updatePos&&(this.cameraTween?(this.cameraTween.updateTo({x:this.cameraPos.x,y:this.cameraPos.y,ease:Power4.easeOut},!0),this.updatePos=!1):(this.cameraTween=TweenMax.to(this.camera,.4,{x:this.cameraPos.x,y:this.cameraPos.y,ease:Power4.easeOut}),this.updatePos=!1))}}])&&we(i.prototype,n),a&&we(i,a),t}(B));function Pe(e){return(Pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ce(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Le(e){return(Le=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function De(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Me(e,t){return(Me=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var je=function(e){function t(e,i){var n,a,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,(n=!(o=Le(t).call(this))||"object"!==Pe(o)&&"function"!=typeof o?De(a):o).options=i,n.scene=e,n.text=i.text,n.target=i.target,n.targetPos=n.target.toGlobal(new PIXI.Point(0,0)),n.targetPos.y-=n.target.height/2+10,i.hasOwnProperty("renderLayer")?n.parentLayer=game.getLayer(i.renderLayer):n.parentLayer=game.getLayer("sprite"),n.name=i.name,n.position.set(n.targetPos.x,n.targetPos.y),n.scene.builder.add(i,De(n),n.name),n.init(),n}var i,n,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Me(e,t)}(t,PIXI.Container),i=t,(n=[{key:"init",value:function(){this.label=this.scene.create({name:this.name+"_text",type:"text",text:this.text,group:this.name,style:{fontFamily:["BowlerHand","Helvetica","Arial"],fontSize:30,fontWeight:"bold",fill:"#010101"},x:0,y:0,anchor:.5});var e=this.label.width+20,t=this.label.height+10;this.background=this.scene.create({name:this.name+"_bg",type:"roundrect",group:this.name,x:-e/2,y:-t-20,width:e,height:t,anchorY:1,anchorX:.5,color:"#ffffff"}),this.pointer=this.scene.create({name:this.name+"_pointer",type:"polygon",group:this.name,x:0,y:0,points:[-10,-20,10,-20,0,0],color:"#ffffff"}),this.label.y=this.background.y+this.background.height/2,this.removeChild(this.label),this.addChild(this.label),this.scale.set(0)}},{key:"reveal",value:function(){TweenMax.fromTo(this.scale,.3,{x:0,y:0},{x:1,y:1,ease:Back.easeOut})}}])&&Ce(i.prototype,n),a&&Ce(i,a),t}(),Ne=i(115),Re=i.n(Ne);function Be(e){return(Be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ue(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Fe(e,t){return!t||"object"!==Be(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function We(e){return(We=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Xe(e,t){return(Xe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var He=function(e){function t(e,i){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e=void 0!==e?e:{},Fe(this,We(t).call(this,e,i))}var i,n,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xe(e,t)}(t,e),i=t,(n=[{key:"init",value:function(){var e=this;this.onMouseWheel=this.onMouseWheel.bind(this),this.camera=this.create({name:"camera",type:"group",x:0,y:0}),this.correctOutline=new K.a(8,11719221),this.hoverOutline=new K.a(4,16777215),this.currentFloor=3,this.floors=[-350,-100,150,400],this.lowerBounds=this.floors[0],this.upperBounds=this.floors[3],this.camera.y=this.floors[this.currentFloor],this.appliances=[],this.applianceData=this.sceneData.appliances,this.applianceData.forEach((function(t){var i=e.get(t.name);i.found=!1,i.interactive=!0,e.appliances.push(i),e.input.on(t.name,P.a.DOWN,"onApplianceSelected",e),e.input.on(t.name,P.a.OVER,"onApplianceOver",e),i.on("pointerover",(function(t){return e.input.handleInputEvent(t,P.a.OVER)})),e.input.on(t.name,P.a.OUT,"onApplianceLeave",e),i.on("pointerout",(function(t){return e.input.handleInputEvent(t,P.a.OUT)}));var n=new je(e,{name:t.name+"_bubble",target:i,type:"group",group:"applianceScene",text:t.text});i.label=n})),this.get("house_floor2").x=755,this.handTool=new Oe(this.camera,{inverted:!0,minX:0,maxX:0,minY:this.floors[0],maxY:this.floors[3],moveThreshold:15}),this.controls=new N(this.container,{tools:{hand:this.handTool}}),this.controls.selectTool("hand"),this.get("applianceScene").position=this.camera.position,this.signalHandler=function(t,i){return e.handleActivitySignal(t,i)},activitySignal.add(this.signalHandler)}},{key:"update",value:function(){this.controls.update(),this.get("applianceScene").position=this.camera.position}},{key:"setupSceneMovementControls",value:function(){var e=this;this.handTool.onMove.add((function(){return e.onHandMove()})),this.handTool.onRelease.add((function(){return e.snapToNearestFloor()})),L.a.keyDown.add((function(t){38===t.keyCode&&e.onKeyDown("up"),40===t.keyCode&&e.onKeyDown("down")}));var t="mousewheel";!0===U.a.isFirefox&&(t="DOMMouseScroll"),window.addEventListener(t,this.onMouseWheel)}},{key:"handleActivitySignal",value:function(e,t){if("overlay_close"===e){activitySignal.remove(this.signalHandler),this.setupSceneMovementControls(),this.currentFloor=1;var i=this.floors[this.currentFloor];TweenMax.to(this.camera,1.5,{y:i,delay:2.5,ease:Power1.easeInOut})}}},{key:"onKeyDown",value:function(e){"down"===e?this.moveSceneDown():"up"===e&&this.moveSceneUp()}},{key:"onMouseWheel",value:function(e){TweenMax.killTweensOf(this.camera);var t=Re()(e),i=this.camera.position.y-t.pixelY;i=Math.max(this.floors[0],i),i=Math.min(this.floors[3],i),this.camera.position.y=i,this.snapToNearestFloor()}},{key:"onHandMove",value:function(){TweenMax.killTweensOf(this.camera),this.camera.position=this.handTool.cameraPos}},{key:"moveSceneUp",value:function(){var e=Math.min(this.currentFloor+1,this.floors.length-1);if(this.currentFloor!==e){TweenMax.killTweensOf(this.camera),this.currentFloor=e;var t=this.floors[this.currentFloor];TweenMax.to(this.camera,1,{y:t})}}},{key:"moveSceneDown",value:function(){var e=Math.max(this.currentFloor-1,0);if(this.currentFloor!==e){TweenMax.killTweensOf(this.camera),this.currentFloor=e;var t=this.floors[this.currentFloor];TweenMax.to(this.camera,1,{y:t})}}},{key:"snapToNearestFloor",value:function(){var e=this.camera.position.y,t=0,i=1/0;this.floors.forEach((function(n,a){var o=Math.abs(e-n);o<i&&(t=a,i=o)})),this.currentFloor=t}},{key:"onApplianceSelected",value:function(e){var t=this.get(e.target);if(!t.found){t.filters=[this.correctOutline],t.found=!0,t.label.reveal();var i=!0;this.appliances.forEach((function(e){!1===e.found&&(i=!1)})),game.sound.play("appliance_correct"),!0===i&&this.onAllAppliancesFound()}}},{key:"onApplianceOver",value:function(e){var t=this.get(e.target);t.found||(t.filters=[this.hoverOutline])}},{key:"onApplianceLeave",value:function(e){var t=this.get(e.target);t.found||(t.filters=[])}},{key:"onAllAppliancesFound",value:function(){var e=this;!0!==this.complete&&(this.complete=!0,this.showCompleteMessage(),game.globalState.gameCompletion[this.name]=!0,TweenMax.delayedCall(2,(function(){e.endActivity()})),game.sound.play("general_levelcomplete"))}},{key:"showCompleteMessage",value:function(){this.create({name:"completionContainer",type:"group",x:"centerX",y:"centerY",anchor:.5,elements:[{name:"completionbadge",type:"sprite",asset:"completionbadge",x:0,y:0,anchor:.5},{name:"successtext",type:"text",text:"YOU DID IT!",style:{fontFamily:["BowlerHand","Helvetica","Arial"],fontSize:40,fontWeight:"bold",fill:"#010101"},x:0,y:-10,anchor:.5}]});var e=this.get("completionContainer"),t=this.get("successtext");TweenMax.fromTo(t.scale,.8,{x:0,y:0},{x:1,y:1,delay:.5,ease:Back.easeOut}),TweenMax.fromTo(e.scale,1,{x:0,y:0},{x:1,y:1,ease:Back.easeOut})}},{key:"endActivity",value:function(e){TweenMax.killAll(),activitySignal.dispatch("end_activity",{activityName:this.name,activitiesCompleted:game.globalState.gameCompletion}),e&&game.sound.play("general_exit")}},{key:"showHelpMenu",value:function(){activitySignal.dispatch("show_help",{activityName:this.name})}},{key:"downloadActivity",value:function(){activitySignal.dispatch("download",{activityName:this.name})}},{key:"exit",value:function(){window.removeEventListener("mousewheel",this.onMouseWheel)}}])&&Ue(i.prototype,n),a&&Ue(i,a),t}(u.a);function Ge(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var ze=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,i,n;return t=e,n=[{key:"boxIntersect",value:function(e,t){return e.x<t.x+t.width&&e.x+e.width>t.x&&e.y<t.y+t.height&&e.y+e.height>t.y}}],(i=null)&&Ge(t.prototype,i),n&&Ge(t,n),e}();function Ve(e){return(Ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qe(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ye(e,t){return!t||"object"!==Ve(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Qe(e){return(Qe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ke(e,t){return(Ke=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Je=function(e){function t(e,i){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e=void 0!==e?e:{},Ye(this,Qe(t).call(this,e,i))}var i,n,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ke(e,t)}(t,e),i=t,(n=[{key:"init",value:function(){var e=this;this.moveTool=new V({deselectPostDrag:!0}),this.controls=new N(this.container,{tools:{move:this.moveTool}}),this.controls.itemSelected.add((function(){return e.onFlagGrabbed()})),this.moveTool.onRelease.add((function(){return e.onFlagReleased()})),this.controls.selectTool("move"),this.selectedFlag=null,this.flagList=[],this.textList=[],this.correctOutline=new K.a(4,11719221),this.incorrectOutline=new K.a(4,11141120),this.selectedOutline=new K.a(4,48369),this.flagData=Array.from(this.sceneData.flagData),this.textData=Array.from(this.sceneData.textData),this.textData=Z.shuffle(this.textData),this.generateMatchText(),this.generateFlags(),this.playingExclamation=!1,this.caList=["excl_greatjob","excl_youreapro"],this.caList=Z.shuffle(this.caList),this.waList=["excl_oopstryagain"],this.animator=new J.a(game.config.anim_global)}},{key:"update",value:function(){this.controls.update(),null!==this.selectedFlag&&(this.input.getLastInput().position,this.onFlagMove())}},{key:"generateMatchText",value:function(){var e=this;this.textData.forEach((function(t,i){var n="textBg_"+(i+1),a="text_"+(i+1),o=e.create({name:a,type:"text",group:"textGroup",text:t.text,style:{fontFamily:["BowlerHand","Helvetica","Arial"]},x:"centerX+=120",y:150+75*i,interactive:!0});o.hitArea=new PIXI.Rectangle(-50,-20,500,100),o.type=t.type,o.matched=!1,e.textList.push(o);var s=e.create({name:n,type:"roundrect",group:"textBgGroup",width:o.width+20,height:o.height+20,top:-10,left:-10,radius:25,x:o.x,y:o.y,color:16777215});s.hitArea=new PIXI.Rectangle(0,0,0,0),o.background=s}))}},{key:"generateFlags",value:function(){var e=this;this.flagData.forEach((function(t,i){var n="flag"+(i+1),a=e.create({name:n,type:"sprite",asset:n,group:"flagGroup",anchor:.25,x:"centerX-=120",y:50+75*i,rotation:30,interactive:!0});a.type=t.type,a.initialPos={x:a.x,y:a.y},a.matched=!1,e.flagList.push(a),e.controls.add(n,a)}))}},{key:"onFlagGrabbed",value:function(){var e=this.controls.selectedItems;this.selectedFlag=this.get(e[0]),this.selectedFlag.filters=[this.selectedOutline],TweenMax.killTweensOf(this.selectedFlag)}},{key:"onFlagMove",value:function(){this.textList.forEach((function(e){e.background.tint=16777215}));var e=this.findNearestMatch();null!==e&&(TweenMax.killTweensOf(e.background),e.background.alpha=1,e.background.tint=48369)}},{key:"onFlagReleased",value:function(){if(null!==this.selectedFlag){var e=this.findNearestMatch();null===e?this.returnFlagToOrigin(this.selectedFlag):this.selectedFlag.type===e.type?this.completeConnection(this.selectedFlag,e):this.rejectConnection(this.selectedFlag,e),this.selectedFlag=null}}},{key:"findNearestMatch",value:function(){var e=this,t=null,i=1/0;return this.textList.forEach((function(n){if(ze.boxIntersect(e.selectedFlag,n)){var a=T.a.distance(e.selectedFlag,n);a<i&&(t=n,i=a)}})),t}},{key:"rejectConnection",value:function(e,t){e.filters=[this.incorrectOutline],TweenMax.killTweensOf(t.background),t.background.alpha=1,t.background.tint=11141120,TweenMax.to(t.background,.5,{alpha:0,delay:1}),game.sound.play("flag_error"),this.showExclamation(this.waList),this.returnFlagToOrigin(e)}},{key:"returnFlagToOrigin",value:function(e){TweenMax.to(e,1,{x:e.initialPos.x,y:e.initialPos.y,onComplete:function(){e.filters=[]}})}},{key:"completeConnection",value:function(e,t){var i=this;e.filters=[],TweenMax.killTweensOf(t.background),t.background.alpha=1,t.background.tint=11719221,TweenMax.to(e.anchor,.2,{x:0,y:1,ease:Power1.easeIn}),TweenMax.to(e,.2,{x:t.x,y:t.y,ease:Power1.easeIn,onComplete:function(){game.sound.play("flag_correct"),i.showExclamation(i.caList)}}),TweenMax.to(e,1,{rotation:-.8,ease:Elastic.easeOut,delay:.2}),this.controls.remove(e.name);var n=this.textList.indexOf(t);this.textList.splice(n,1),this.textList.length<=0&&this.onAllMatched()}},{key:"showExclamation",value:function(e){var t=this;if(!0!==this.playingExclamation){this.playingExclamation=!0;var i=C.a.cycleArray(e),n=this.create({name:"exclamation",type:"sprite",asset:i,x:g.a.centerX+180,y:g.a.centerY,anchor:.5,alpha:0,scale:.5});this.animator.setupAnimation("exclamationFade","fadeUpOut",n),this.animator.play("exclamationFade",0,(function(){t.remove("exclamation"),t.playingExclamation=!1}))}}},{key:"onAllMatched",value:function(){var e=this;!0!==this.complete&&(this.complete=!0,this.showCompleteMessage(),game.globalState.gameCompletion[this.name]=!0,TweenMax.delayedCall(2,(function(){e.endActivity()})),game.sound.play("general_levelcomplete"))}},{key:"showCompleteMessage",value:function(){this.create({name:"completionContainer",type:"group",x:"centerX",y:"centerY",anchor:.5,elements:[{name:"completionbadge",type:"sprite",asset:"completionbadge",x:0,y:0,anchor:.5},{name:"successtext",type:"text",text:"YOU DID IT!",style:{fontFamily:["BowlerHand","Helvetica","Arial"],fontSize:40,fontWeight:"bold",fill:"#010101"},x:0,y:-10,anchor:.5}]});var e=this.get("completionContainer"),t=this.get("successtext");TweenMax.fromTo(t.scale,.8,{x:0,y:0},{x:1,y:1,delay:.5,ease:Back.easeOut}),TweenMax.fromTo(e.scale,1,{x:0,y:0},{x:1,y:1,ease:Back.easeOut}),this.animator.isPlaying("exclamationFade")&&this.animator.stop("exclamationFade"),this.remove("exclamation")}},{key:"endActivity",value:function(e){TweenMax.killAll(),activitySignal.dispatch("end_activity",{activityName:this.name,activitiesCompleted:game.globalState.gameCompletion}),e&&game.sound.play("general_exit")}},{key:"showHelpMenu",value:function(){activitySignal.dispatch("show_help",{activityName:this.name})}},{key:"downloadActivity",value:function(){activitySignal.dispatch("download",{activityName:this.name})}},{key:"exit",value:function(){}}])&&qe(i.prototype,n),a&&qe(i,a),t}(u.a);function $e(e){return($e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ze(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function et(e,t){return!t||"object"!==$e(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function tt(e){return(tt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function it(e,t){return(it=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var nt=function(e){function t(e,i){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e=void 0!==e?e:{},et(this,tt(t).call(this,e,i))}var i,n,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&it(e,t)}(t,e),i=t,(n=[{key:"init",value:function(){var e=this;this.isSelecting=!1,this.pathHistory=[],this.currentSection=null,this.exitSection=null,this.exitActivated=!1,this.sectionSize=70,this.halfSection=this.sectionSize/2,this.collectables=[],this.collectedCount=0,this.player=this.get("player"),this.player.hitArea=new PIXI.Rectangle(0,0,0,0),this.playingExclamation=!1,this.caList=["excl_almost_there","excl_awesomejob","excl_nicemove"],this.caList=Z.shuffle(this.caList);var t=new O({rows:10,columns:8,sectionWidth:this.sectionSize,sectionHeight:this.sectionSize,x:g.a.centerX-4*this.sectionSize+100,y:g.a.centerY-5*this.sectionSize+30});this.grid=t,this.items=[],this.grid.traverse((function(t){return e.setupWallTile(t)}),0,0,9,7),this.pathLine=new Q.a,this.get("pathContainer").addChild(this.pathLine),this.currentSection=this.grid.getSection(0,1),this.currentSection.items[0].entered=!0,this.exitSection=this.grid.getSection(9,6),this.setupCollectables(),this.player.x=this.currentSection.x+this.halfSection,this.player.y=this.currentSection.y,this.tl=new TimelineMax,this.activateExitTile(),this.animator=new J.a(game.config.anim_global)}},{key:"setupWallTile",value:function(e){var t=e.row*this.grid.numColumns+e.column,i=this.sceneData.boardLayout[t],n="Wall_"+i,a=n+"_"+e.row+"_"+e.column,o=this.create({name:a,type:"sprite",asset:n,group:"mazeContainer",width:this.sectionSize,height:this.sectionSize,x:e.x+35,y:e.y+35,interactive:!0,anchor:.5});o.walls=i,o.entered=!1,this.input.on(a,P.a.DOWN,"onTileSelected",this),this.input.on(a,P.a.MOVE,"onTileMove",this),this.input.on(a,P.a.UP,"onTileReleased",this),this.grid.listItemAtCoords(o,e.x+35,e.y+35)}},{key:"setupCollectables",value:function(){var e=this;this.sceneData.boardCollectables.forEach((function(t){var i=e.grid.getSection(t.y,t.x),n=e.create({name:t.asset,type:"sprite",asset:t.asset,group:"mazeContainer",x:i.x+e.halfSection,y:i.y+e.halfSection,anchor:.5});n.text=t.text,n.hitArea=new PIXI.Rectangle(0,0,0,0),n.data=t,e.collectables.push(n),e.grid.listItem(n,t.y,t.x)}))}},{key:"onTileSelected",value:function(e){var t=this.get(e.target),i=this.grid.getSectionAtCoords(t.x,t.y);i===this.currentSection&&(this.isSelecting=!0),this.canEnterTile(t,this.currentSection,i)&&(this.isSelecting=!0,this.onEnterNewTile(t,i))}},{key:"onTileMove",value:function(e){if(this.isSelecting){var t=this.get(e.target),i=this.grid.getSectionAtCoords(t.x,t.y);this.canEnterTile(t,this.currentSection,i)&&this.onEnterNewTile(t,i)}}},{key:"onTileReleased",value:function(e){this.isSelecting=!1}},{key:"canEnterTile",value:function(e,t,i){var n=t.row,a=t.column,o=i.row,s=i.column;return!!this.pathHistory.includes(i)||(n!==o||a!==s)&&(n===o||a===s)&&(o===n-1?!e.walls.includes("S"):s===a+1?!e.walls.includes("W"):o===n+1?!e.walls.includes("N"):s===a-1?!e.walls.includes("E"):void 0)}},{key:"onEnterNewTile",value:function(e,t){var i=this;if(this.pathHistory.includes(t))for(;this.currentSection!==t;){var n=this.pathHistory.pop();this.currentSection.items[0].entered=!1,this.currentSection=n}else e.entered=!0,this.pathHistory.push(this.currentSection),this.currentSection=t;game.sound.play("maze_move",{volume:.4}),this.updatePath(),this.collectables.forEach((function(e,t){i.currentSection.items.includes(e)&&i.collectItem(e,t)})),0===this.collectables.length&&this.activateExitTile(),this.currentSection==this.exitSection&&!0===this.exitActivated&&this.onMazeCompleted()}},{key:"updatePath",value:function(){var e=this;this.pathLine.clear(),this.pathLine.lineStyle(10,16711680);var t=this.pathHistory.map((function(t){return{x:t.x+e.halfSection,y:t.y+e.halfSection}}));t.push({x:this.currentSection.x+this.halfSection,y:this.currentSection.y+this.halfSection}),this.pathLine.drawPath(t)}},{key:"start",value:function(){}},{key:"update",value:function(){}},{key:"collectItem",value:function(e,t){var i=this.get("itemBank"),n=50+80*this.collectedCount;TweenMax.to(e,1,{x:i.x+60,y:i.y+n}),TweenMax.to(e.scale,1,{x:.8,y:.8}),this.grid.unlistItem(e,e.data.y,e.data.x),this.collectables.splice(t,1),this.collectedCount++,game.sound.play("maze_item"),this.showExclamation(this.caList)}},{key:"activateExitTile",value:function(){!0!==this.exitActivated&&(this.exitActivated=!0,this.create({name:"exitStar",type:"sprite",asset:"star",group:"mazeContainer",x:this.exitSection.x+this.halfSection,y:this.exitSection.y+this.halfSection,scale:.1,anchor:.5}).hitArea=new PIXI.Rectangle(0,0,0,0))}},{key:"showExclamation",value:function(e){var t=this;if(!0!==this.playingExclamation){this.playingExclamation=!0;var i=C.a.cycleArray(e),n=this.create({name:"exclamation",type:"sprite",asset:i,x:g.a.centerX+60,y:g.a.centerY+40,anchor:.5,alpha:0,scale:.5});this.animator.setupAnimation("exclamationFade","fadeUpOut",n),this.animator.play("exclamationFade",0,(function(){t.remove("exclamation"),t.playingExclamation=!1}))}}},{key:"onMazeCompleted",value:function(){var e=this;!0!==this.complete&&(this.complete=!0,game.globalState.gameCompletion[this.name]=!0,game.sound.play("maze_end"),this.grid.traverse((function(t){var i=t.items[0];i&&i.name&&e.input.off(i.name)}),0,0,9,7),this.tl.add(TweenMax.to(this.player.scale,.3,{x:0,y:0})),this.tl.add(TweenMax.set(this.player,{x:this.exitSection.x+this.halfSection,y:this.exitSection.y}),.3),this.tl.add(TweenMax.to(this.player.scale,.4,{x:1,y:1,ease:Back.easeOut}),.4),TweenMax.delayedCall(1,(function(){e.showCompleteMessage()})),TweenMax.delayedCall(3,(function(){e.endActivity()})))}},{key:"showCompleteMessage",value:function(){this.create({name:"completionContainer",type:"group",x:"centerX",y:"centerY",anchor:.5,elements:[{name:"completionbadge",type:"sprite",asset:"completionbadge",x:0,y:0,anchor:.5},{name:"successtext",type:"text",text:"YOU DID IT!",style:{fontFamily:["BowlerHand","Helvetica","Arial"],fontSize:40,fontWeight:"bold",fill:"#010101"},x:0,y:-10,anchor:.5}]});var e=this.get("completionContainer"),t=this.get("successtext");TweenMax.fromTo(t.scale,.8,{x:0,y:0},{x:1,y:1,delay:.5,ease:Back.easeOut}),TweenMax.fromTo(e.scale,1,{x:0,y:0},{x:1,y:1,ease:Back.easeOut}),game.sound.play("general_levelcomplete"),this.animator.isPlaying("exclamationFade")&&this.animator.stop("exclamationFade"),this.remove("exclamation")}},{key:"endActivity",value:function(e){TweenMax.killAll(),activitySignal.dispatch("end_activity",{activityName:this.name,activitiesCompleted:game.globalState.gameCompletion}),e&&game.sound.play("general_exit")}},{key:"showHelpMenu",value:function(){activitySignal.dispatch("show_help",{activityName:this.name})}},{key:"downloadActivity",value:function(){activitySignal.dispatch("download",{activityName:this.name})}},{key:"exit",value:function(){this.tl.kill()}}])&&Ze(i.prototype,n),a&&Ze(i,a),t}(u.a);function at(e){return(at="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ot(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function st(e,t){return!t||"object"!==at(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function rt(e){return(rt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function lt(e,t){return(lt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ct=function(e){function t(e,i){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e=void 0!==e?e:{},st(this,rt(t).call(this,e,i))}var i,n,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&lt(e,t)}(t,e),i=t,(n=[{key:"init",value:function(){var e=this;this.moveTool=new V({translateX:!0,translateY:!1,deselectPostDrag:!0}),this.controls=new N(this.container,{tools:{move:this.moveTool}}),this.controls.itemSelected.add((function(){return e.onLetterGrabbed()})),this.moveTool.onRelease.add((function(){return e.onLetterReleased()})),this.controls.selectTool("move"),this.wordList=Array.from(this.sceneData.wordList),this.wordList=Z.shuffle(this.wordList),this.wordList=this.wordList.slice(0,6),this.generatedWords=[],this.currentWord=null,this.letterSpacing=80,this.lineHeight=100,this.playingExclamation=!1,this.caList=["excl_greatjob","excl_youreapro"];for(var t=0;t<this.wordList.length;t++){var i=this.wordList[t],n="word_"+t,a=this.create({name:n,type:"group",x:"safeLeft+=380",y:150+t*this.lineHeight,interactive:!0,group:"wordGroup"});a.letters=[],a.unscrambled=i.unscrambled,a.correct=!1;for(var o=0;o<i.scrambled.length;o++){var s="word_"+t+"_letter_"+o,r=this.create({name:s,type:"text",text:i.scrambled[o],style:{fontFamily:["BowlerHand","Helvetica","Arial"],fontSize:72,fontWeight:"bold",fill:"#010101"},x:o*this.letterSpacing,y:0,anchor:.5,interactive:!0,group:n});a.letters.push(r),this.controls.add(s,r),this.controls.getItem(s).data.bounds={left:a.x-15,right:a.x+(i.scrambled.length-1)*this.letterSpacing+15}}this.generatedWords.push(a)}this.animator=new J.a(game.config.anim_global)}},{key:"start",value:function(){}},{key:"update",value:function(){this.controls.update();var e=this.controls.selectedItems;null!==this.currentWord&&e.length&&(this.get(e[0]).parent,this.checkLetterOrder())}},{key:"onLetterGrabbed",value:function(){var e=this.controls.selectedItems,t=this.get(e[0]);this.currentWord=t.parent,game.sound.play("scramble_moveletter")}},{key:"onLetterReleased",value:function(){null!==this.currentWord&&this.checkForCorrectWord(),this.currentWord=null}},{key:"checkLetterOrder",value:function(){this.currentWord.letters.sort(this.sortByXPosition);for(var e=this.controls.selectedItems,t=this.get(e[0]),i=0;i<this.currentWord.letters.length;i++)t!=this.currentWord.letters[i]&&(this.currentWord.letters[i].x=i*this.letterSpacing)}},{key:"checkForCorrectWord",value:function(){var e=this;this.checkLetterOrder();var t=this.currentWord.letters.map((function(e){return e.text})).join("");game.sound.play("scramble_moveletter"),t===this.currentWord.unscrambled&&(this.currentWord.correct=!0,this.currentWord.letters.forEach((function(t){e.controls.remove(t),t.interactive=!1,t.style.fill="#B2D235"})),game.sound.play("scramble_wordcomplete"),this.showExclamation(this.caList),this.checkForAllCorrect())}},{key:"checkForAllCorrect",value:function(){var e=!0;this.generatedWords.forEach((function(t){!1===t.correct&&(e=!1)})),!0===e&&this.onAllWordsCompleted()}},{key:"onAllWordsCompleted",value:function(){var e=this;!0!==this.complete&&(this.complete=!0,this.showCompleteMessage(),game.globalState.gameCompletion[this.name]=!0,TweenMax.delayedCall(2,(function(){e.endActivity()})),game.sound.play("general_levelcomplete"))}},{key:"showExclamation",value:function(e){var t=this;if(!0!==this.playingExclamation){this.playingExclamation=!0;var i=C.a.cycleArray(e),n=this.create({name:"exclamation",type:"sprite",asset:i,x:g.a.centerX+60,y:g.a.centerY,anchor:.5,alpha:0,scale:.5});this.animator.setupAnimation("exclamationFade","fadeUpOut",n),this.animator.play("exclamationFade",0,(function(){t.remove("exclamation"),t.playingExclamation=!1}))}}},{key:"showCompleteMessage",value:function(){this.create({name:"completionContainer",type:"group",x:"centerX",y:"centerY",anchor:.5,elements:[{name:"completionbadge",type:"sprite",asset:"completionbadge",x:0,y:0,anchor:.5},{name:"successtext",type:"text",text:"YOU DID IT!",style:{fontFamily:["BowlerHand","Helvetica","Arial"],fontSize:40,fontWeight:"bold",fill:"#010101"},x:0,y:-10,anchor:.5}]});var e=this.get("completionContainer"),t=this.get("successtext");TweenMax.fromTo(t.scale,.8,{x:0,y:0},{x:1,y:1,delay:.5,ease:Back.easeOut}),TweenMax.fromTo(e.scale,1,{x:0,y:0},{x:1,y:1,ease:Back.easeOut}),this.animator.isPlaying("exclamationFade")&&this.animator.stop("exclamationFade"),this.remove("exclamation")}},{key:"sortByXPosition",value:function(e,t){return e.x-t.x}},{key:"endActivity",value:function(e){TweenMax.killAll(),activitySignal.dispatch("end_activity",{activityName:this.name,activitiesCompleted:game.globalState.gameCompletion}),e&&game.sound.play("general_exit")}},{key:"showHelpMenu",value:function(){activitySignal.dispatch("show_help",{activityName:this.name})}},{key:"downloadActivity",value:function(){activitySignal.dispatch("download",{activityName:this.name})}},{key:"exit",value:function(){}}])&&ot(i.prototype,n),a&&ot(i,a),t}(u.a);function ut(e){return(ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ht(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function dt(e,t){return!t||"object"!==ut(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ft(e){return(ft=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function pt(e,t){return(pt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var yt=function(e){function t(e,i){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e=void 0!==e?e:{},dt(this,ft(t).call(this,e,i))}var i,n,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pt(e,t)}(t,e),i=t,(n=[{key:"init",value:function(){var e=this;this.complete=!1,this.isSelecting=!1,this.initialTile=null,this.targetTile=null,this.endTile=null,this.selectedTiles=[],this.selectedLetters=[],this.selectedString="",this.reversedString="",this.selectionContainer=this.get("selectionContainer"),this.tileSize=60,this.halfSize=this.tileSize/2,this.selectionRect=null,this.lastSelectionLength=0,this.lastSelectionRotation=0,this.match=null,this.board=Z.from(this.sceneData.boardVariants),console.log(this.board),this.targetWords=Array.from(this.board.targetWords),this.setupWordBank();var t=new O({rows:8,columns:11,sectionWidth:this.tileSize,sectionHeight:this.tileSize,x:g.a.safeRight-11*this.tileSize-100,y:g.a.safeTop+50});this.grid=t,this.items=[],this.grid.traverse((function(t){return e.setupLetterTile(t)}),0,0,7,10),this.playingExclamation=!1,this.caList=["excl_nicefind","excl_supersleuth","excl_waytogo","excl_yougotthis"],this.caList=Z.shuffle(this.caList),this.animator=new J.a(game.config.anim_global)}},{key:"setupLetterTile",value:function(e){var t=e.row*this.grid.numColumns+e.column,i=this.board.boardLayout[t];"?"===i&&(i=Z.from(this.sceneData.letterPool));var n="rect_"+e.row+"_"+e.column,a=this.create({name:n,type:"sprite",asset:"square",width:this.tileSize,height:this.tileSize,x:e.x+30,y:e.y+30,interactive:!0,anchor:.5,alpha:0});a.letter=i,a.correct=!1,this.input.on(n,P.a.DOWN,"onTileSelected",this),this.input.on(n,P.a.MOVE,"onTileMove",this),this.input.on(n,P.a.UP,"onTileReleased",this),this.grid.listItemAtCoords(a,e.x+30,e.y+30),this.create({name:"letter_"+e.row+"_"+e.column,type:"text",text:i,style:{fontFamily:["BowlerHand","Helvetica","Arial"],fontSize:40,fontWeight:"bold",fill:"#010101"},x:e.x+30,y:e.y+30,anchor:.5}).hitArea=new PIXI.Rectangle(0,0,0,0)}},{key:"setupWordBank",value:function(){for(var e=0;e<this.targetWords.length;e++){var t=110+e%3*210,i=30+65*Math.floor(e/3),n=this.targetWords[e];this.create({name:n,type:"text",text:n,style:{fontFamily:["BowlerHand","Helvetica","Arial"],fontSize:24,fill:"#010101"},x:t,y:i,anchor:.5,group:"wordBank"})}}},{key:"start",value:function(){}},{key:"onTileSelected",value:function(e){if(!0===this.isSelecting)return this.isSelecting=!1,void this.checkSelectionForMatch();this.isSelecting=!0;var t=this.get(e.target);this.initialTile=this.grid.getSectionAtCoords(t.x,t.y),this.selectedTiles=[this.initialTile],this.makeSelectionGraphic(),game.sound.play("search_letter")}},{key:"onTileMove",value:function(e){if(this.isSelecting){var t=this.get(e.target);this.targetTile=this.grid.getSectionAtCoords(t.x,t.y),this.selectedTiles=this.grid.getSectionsOnAxis(this.initialTile.row,this.initialTile.column,this.targetTile.row,this.targetTile.column),this.endTile=this.selectedTiles.slice(-1)[0],this.updateSelectionGraphic()}}},{key:"onTileReleased",value:function(e){this.isSelecting=!1,this.checkSelectionForMatch()}},{key:"checkSelectionForMatch",value:function(){for(var e=this,t=[],i=[],n=0;n<this.selectedTiles.length;n++){var a=this.selectedTiles[n].items[0];void 0!==a&&(this.selectedLetters.push(a.letter),t.push(a))}if(this.selectedString=this.selectedLetters.join(""),this.reversedString=this.selectedLetters.reverse().join(""),this.targetWords.forEach((function(t){return e.checkForWordMatch(t)})),null!=this.match){if(game.sound.play("search_correctword"),this.showExclamation(this.caList),this.targetWords.splice(this.match.index,1),this.match.reversed)for(var o=this.match.startIndex;o>this.match.startIndex-this.match.word.length;o--)t[o].correct=!0,i.push(this.selectedTiles[o]);else for(var s=this.match.startIndex;s<this.match.startIndex+this.match.word.length;s++)t[s].correct=!0,i.push(this.selectedTiles[s]);this.makeFinalSelectionGraphic(this.match,i),this.get(this.match.word).style={fontFamily:["BowlerHand","Helvetica","Arial"],fontSize:24,fill:"#B2D235"}}this.clearSelectionGraphic(),this.selectedTiles=[],this.selectedLetters=[],this.match=null,this.targetWords.length<=0&&this.onAllWordsFound()}},{key:"checkForWordMatch",value:function(e){this.selectedString.includes(e)?this.match={word:e,index:this.targetWords.indexOf(e),reversed:!1,startIndex:this.selectedString.indexOf(e)}:this.reversedString.includes(e)&&(this.match={word:e,index:this.targetWords.indexOf(e),reversed:!0,startIndex:this.reversedString.length-this.reversedString.indexOf(e)-1})}},{key:"makeSelectionShape",value:function(e,t,i,n){var a=this.create({name:e,type:"roundrect",group:t,width:n,height:this.tileSize-10,top:5,left:5,radius:30,x:-1*this.halfSize,y:-1*this.halfSize,color:i});return a.hitArea=new PIXI.Rectangle(0,0,0,0),a}},{key:"makeSelectionGraphic",value:function(){this.clearSelectionGraphic(),this.selectionContainer.x=this.initialTile.x+this.halfSize,this.selectionContainer.y=this.initialTile.y+this.halfSize,this.makeSelectionShape("selectionRect","selectionContainer",48369,this.tileSize-10)}},{key:"updateSelectionGraphic",value:function(){this.clearSelectionGraphic();var e=T.a.polarAngle(this.endTile.x-this.initialTile.x,this.endTile.y-this.initialTile.y);this.selectionContainer.rotation=T.a.toRadians(e-90);var t=T.a.distance(this.endTile,this.initialTile);this.makeSelectionShape("selectionRect","selectionContainer",48369,t-10+this.tileSize),this.lastSelectionLength===t&&this.lastSelectionRotation===e||game.sound.play("search_letter"),this.lastSelectionLength=t,this.lastSelectionRotation=e}},{key:"clearSelectionGraphic",value:function(){this.get("selectionRect")&&this.remove("selectionRect",!0)}},{key:"makeFinalSelectionGraphic",value:function(e,t){this.clearSelectionGraphic();var i=t[0],n=t.slice(-1)[0],a=T.a.polarAngle(n.x-i.x,n.y-i.y),o="selection_"+e.word,s="selectionShape_"+e.word,r=this.create({name:name,type:"group",group:"finalSelections",x:i.x+this.halfSize,y:i.y+this.halfSize,rotation:a-90,anchor:.5}),l=this.makeSelectionShape(s,o,11719221,T.a.distance(n,i)-10+this.tileSize);r.addChild(l),this.lastSelectionLength=0,this.lastSelectionRotation=0}},{key:"update",value:function(){}},{key:"showExclamation",value:function(e){var t=this;if(!0!==this.playingExclamation){this.playingExclamation=!0;var i=C.a.cycleArray(e),n=this.create({name:"exclamation",type:"sprite",asset:i,x:g.a.centerX+60,y:g.a.centerY-100,anchor:.5,alpha:0,scale:.5});this.animator.setupAnimation("exclamationFade","fadeUpOut",n),this.animator.play("exclamationFade",0,(function(){t.remove("exclamation"),t.playingExclamation=!1}))}}},{key:"onAllWordsFound",value:function(){var e=this;!0!==this.complete&&(this.complete=!0,this.showCompleteMessage(),game.globalState.gameCompletion[this.name]=!0,TweenMax.delayedCall(2,(function(){e.endActivity()})),game.sound.play("general_levelcomplete"))}},{key:"showCompleteMessage",value:function(){this.create({name:"completionContainer",type:"group",x:"centerX",y:"centerY",anchor:.5,elements:[{name:"completionbadge",type:"sprite",asset:"completionbadge",x:0,y:0,anchor:.5},{name:"successtext",type:"text",text:"YOU DID IT!",style:{fontFamily:["BowlerHand","Helvetica","Arial"],fontSize:40,fontWeight:"bold",fill:"#010101"},x:0,y:-10,anchor:.5}]});var e=this.get("completionContainer"),t=this.get("successtext");TweenMax.fromTo(t.scale,.8,{x:0,y:0},{x:1,y:1,delay:.5,ease:Back.easeOut}),TweenMax.fromTo(e.scale,1,{x:0,y:0},{x:1,y:1,ease:Back.easeOut}),this.animator.isPlaying("exclamationFade")&&this.animator.stop("exclamationFade"),this.remove("exclamation")}},{key:"endActivity",value:function(e){TweenMax.killAll(),activitySignal.dispatch("end_activity",{activityName:this.name,activitiesCompleted:game.globalState.gameCompletion}),e&&game.sound.play("general_exit")}},{key:"showHelpMenu",value:function(){activitySignal.dispatch("show_help",{activityName:this.name})}},{key:"downloadActivity",value:function(){activitySignal.dispatch("download",{activityName:this.name})}},{key:"exit",value:function(){}}])&&ht(i.prototype,n),a&&ht(i,a),t}(u.a);function mt(e){return(mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vt(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function gt(e,t){return!t||"object"!==mt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function bt(e){return(bt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function wt(e,t){return(wt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var kt=function(e){function t(e,i){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e=void 0!==e?e:{},gt(this,bt(t).call(this,e,i))}var i,n,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wt(e,t)}(t,e),i=t,(n=[{key:"init",value:function(){var e=this,t=game.config.anim_global;this.animator=new J.a(t);var i=this.get("overlay"),n=this.get("loadGroup");this.transition=i,this.animator.setupAnimation("transition","Transition",this.transition,{onLabelEnd:function(t){return e.onLabelEnd(t)}}),this.animator.setupAnimation("fadeInLoader","FadeIn",n,{delay:.8}),this.animator.setupAnimation("fadeOutLoader","FadeOut",n,{onComplete:function(t){e.get("loadGroup")&&(e.get("loadGroup").visible=!1),e.container.visible=!1}}),game.signal.add((function(t,i){return e.onGameEvent(t,i)})),this.hideLoader()}},{key:"start",value:function(){}},{key:"onGameEvent",value:function(e,t){switch(e){case c.a.TRANSITION_IN:this.builder.reset("overlay"),this.container.visible=!0,this.animator.play("transition","in"),this.signal.dispatch(u.a.TRANSITION_START,{name:this.name,transition:"in"});break;case c.a.TRANSITION_OUT:this.hideLoader(),this.animator.play("transition","out");break;case c.a.LOAD_PROGRESS:this.sceneProgress(t);break;case c.a.SCENES_LOADED:this.scenesLoaded()}}},{key:"onLabelEnd",value:function(e){console.log(e),"in"==e?(this.showLoader(),this.signal.dispatch(u.a.TRANSITION_END,{name:this.name,transition:"in"})):"out"==e&&this.signal.dispatch(u.a.TRANSITION_END,{name:this.name,transition:"out"})}},{key:"showLoader",value:function(){var e=this.get("loadGroup");this.builder.reset("loadGroup"),e.visible=!0,e.alpha=0,this.animator.play("fadeInLoader"),this.get("loadMask").scale.x=0}},{key:"hideLoader",value:function(){this.get("loadGroup"),this.animator.stop("fadeInLoader"),this.animator.play("fadeOutLoader")}},{key:"sceneLoadStart",value:function(){this.get("loadMask").scale.x=0}},{key:"sceneProgress",value:function(e){this.get("loadMask").scale.x=e.progress}},{key:"scenesLoaded",value:function(){this.get("loadMask").scale.x=1}},{key:"start",value:function(){}},{key:"update",value:function(){}}])&&vt(i.prototype,n),a&&vt(i,a),t}(u.a),St=(i(57),i(17)),xt=i(26),_t=i.n(xt);function It(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Tt=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),void 0!==(t=void 0!==t?t:{}).downloadButton&&(this.downloadButton=t.downloadButton),void 0!==t.nameElement&&(this.nameElement=t.nameElement),this.init()}var t,i,n;return t=e,(i=[{key:"init",value:function(){this.name="",this.certLoaded=!1,this.downloadInitiated=!1,this.canvas=document.createElement("canvas"),this.canvas.width=1224,this.canvas.height=1584,this.ctx=this.canvas.getContext("2d"),this.loadCertificateImage()}},{key:"downloadCertificate",value:function(){!0!==this.downloadInitiated&&!1!==this.certLoaded&&(this.name=this.nameElement.value,this.downloadInitiated=!0,this.generateCertificateCanvas())}},{key:"loadCertificateImage",value:function(){var e=this;this.certImage=new Image,this.certImage.onload=function(){e.onCertificateLoaded()},this.certImage.src="./assets/images/certificate/CertificateFull.png"}},{key:"onCertificateLoaded",value:function(){this.certLoaded=!0,this.downloadButton.classList.add("enabled")}},{key:"generateCertificateCanvas",value:function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.drawImage(this.certImage,0,0),this.ctx.font="80px BowlerHand",this.ctx.textAlign="center",this.ctx.fillText(this.name,580,920),this.saveToImage()}},{key:"saveToImage",value:function(){var e=this.canvas.toDataURL("image/png");_t()(e,"SafeDiggingChampionCertificate.png","image/png"),this.downloadInitiated=!1,app.trackCertificateDownload()}}])&&It(t.prototype,i),n&&It(t,n),e}();function Et(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var At=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!0===typeof(t=void 0!==t?t:{}).facebook?this.useFacebook=!0:this.useFacebook=!1,this.isOver13=null,this.requestedActivityShare=!1,this.requestedGeneralShare=!1,this.fbScriptLoaded=!1,this.deferredShareData=null,this.init()}var t,i,n;return t=e,(i=[{key:"init",value:function(){var e=this;this.ageGate=document.getElementById("age-gate-overlay"),this.ageButtonNo=document.getElementById("age-button-no"),this.ageButtonYes=document.getElementById("age-button-yes"),this.ageButtonNo.addEventListener("click",(function(){e.respondedUnder13()})),this.ageButtonYes.addEventListener("click",(function(){e.respondedOver13()}))}},{key:"requestAgeRestrictedAction",value:function(e){"activity_share"===e?this.requestedActivityShare=!0:"general_share"===e&&(this.requestedGeneralShare=!0),this.checkAgeVerification()}},{key:"checkAgeVerification",value:function(){null===this.isOver13?this.setAgeGateActive():this.verifiedAge()}},{key:"setAgeGateActive",value:function(){this.ageGate.classList.add("active")}},{key:"setAgeGateInactive",value:function(){this.ageGate.classList.remove("active")}},{key:"respondedUnder13",value:function(){this.setAgeGateInactive(),this.hideFacebookButton(),this.isOver13=!1,this.verifiedAge()}},{key:"respondedOver13",value:function(){this.setAgeGateInactive(),this.isOver13=!0,this.loadFacebook(),this.verifiedAge()}},{key:"verifiedAge",value:function(){this.requestedActivityShare&&activitySignal.dispatch("verify_activity_share",{isOver13:this.isOver13}),this.requestedGeneralShare&&activitySignal.dispatch("verify_share",{isOver13:this.isOver13})}},{key:"loadFacebook",value:function(){var e=this;this.fbScript=document.createElement("script"),this.fbScript.onload=function(){e.onFacebookLoaded()},this.fbScript.src="https://connect.facebook.net/en_US/sdk.js",document.head.appendChild(this.fbScript)}},{key:"onFacebookLoaded",value:function(){FB.init({appId:"629700134283372",autoLogAppEvents:!1,xfbml:!1,version:"v6.0"}),this.fbScriptLoaded=!0,null!==this.deferredShareData&&(this.displayFacebookShare(this.deferredShareData),this.deferredShareData=null)}},{key:"displayFacebookShare",value:function(e){console.log("attempting share..."),!0===this.fbScriptLoaded?(console.log("displaying facebook share!"),console.log(e),FB.ui({method:"share",quote:e.body,href:location.href},(function(e){console.log(e)}))):(console.log("deferring until loaded"),this.deferredShareData=e)}},{key:"hideFacebookButton",value:function(){var e=document.getElementById("activity-share-button");e&&e.classList.add("disabled")}}])&&Et(t.prototype,i),n&&Et(t,n),e}();function Ot(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Pt=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=void 0!==t?t:{},this.game=t.game||{},this.providerLookup={ap:{logo:"alabamapower_logo.png",name:"Alabama Power",careerUrl:"virginianaturalgas.com/careers"},agl:{logo:"atlantagaslight_logo.png",name:"Atlanta Gas Light",careerUrl:"atlantagaslight.com/about-us/careers"},cg:{logo:"chattanoogagas_logo.png",name:"Chattanooga Gas",careerUrl:"chattanoogagas.com/about-us/careers"},gep:{logo:"georgiapower_logo.png",name:"Georgia Power",careerUrl:"virginianaturalgas.com/careers"},gup:{logo:"gulfpower_logo.png",name:"Gulf Power",careerUrl:"virginianaturalgas.com/careers"},mp:{logo:"mississippipower_logo.png",name:"Mississippi Power",careerUrl:"virginianaturalgas.com/careers"},ng:{logo:"nicorgas_logo.png",name:"Nicor Gas",careerUrl:"nicorgas.com/careers"},ps:{logo:"powersecure_logo.png",name:"Power Secure",careerUrl:"virginianaturalgas.com/careers"},sem:{logo:"sequentenergymanagement_logo.png",name:"Sequent Energy Management",careerUrl:"virginianaturalgas.com/careers"},scg:{logo:"southerncompanygas_logo.png",name:"Southern Company Gas",careerUrl:"southerncompanygas.com/careers"},sl:{logo:"southernlinc_logo.png",name:"Southern Linc",careerUrl:"virginianaturalgas.com/careers"},sn:{logo:"southernnuclear_logo.png",name:"Southern Nuclear",careerUrl:"virginianaturalgas.com/careers"},sp:{logo:"southernpower_logo.png",name:"Southern Power",careerUrl:"virginianaturalgas.com/careers"},st:{logo:"southerntelecom_logo.png",name:"Southern Telecom",careerUrl:"virginianaturalgas.com/careers"},vng:{logo:"virginianaturalgas_logo.png",name:"Virginia Natural Gas",careerUrl:"virginianaturalgas.com/careers"}},this.brandedActivityBooks=["agl","cg","ng","vng"],this.currentProvider=this.providerLookup.scg,this.init()}var t,i,n;return t=e,(i=[{key:"init",value:function(){var e=this;this.certificateAwarded=!1,this.gameParentElement=document.getElementById(this.game.canvasParent),this.introElement=document.getElementById("students-parents-intro-wrapper"),this.gameUIElement=document.getElementById("uiContainer"),this.gameUIOverlayContainer=document.querySelector(".overlay-container"),this.certificateElement=document.getElementById("certificate-wrapper"),this.activityLaunchElements=document.getElementsByClassName("activity-launch-button");var t=!0,i=!1,n=void 0;try{for(var a,o=this.activityLaunchElements[Symbol.iterator]();!(t=(a=o.next()).done);t=!0)a.value.addEventListener("click",(function(t){return e.startActivity(t)}))}catch(e){i=!0,n=e}finally{try{t||null==o.return||o.return()}finally{if(i)throw n}}this.introLaunchButton=document.getElementsByClassName("intro-button")[0],this.introLaunchButton.addEventListener("click",(function(t){return e.setIntroOverlayActive(t)})),this.introStartButton=document.getElementById("start-first-activity-button"),this.introStartButton.addEventListener("click",(function(t){return e.nextActivity(t)})),this.gameUIStartButton=document.getElementById("start-game-button"),this.gameUIStartButton.addEventListener("click",(function(t,i){return e.setUIOverlayInactive(t,!0)})),this.gameUIElement.addEventListener("click",(function(t,i){return e.setUIOverlayInactive(t,!0)})),this.gameUIOverlayContainer.addEventListener("click",(function(e){e.stopPropagation()})),this.certCloseButton=document.getElementById("cert-close-button"),this.certCloseButton.addEventListener("click",(function(t){return e.hideCertificate(t)})),this.certPrintButton=document.getElementById("cert-print-button"),this.certPrintButton.addEventListener("click",(function(t){return e.printCertificate(t)})),this.certDownloadButton=document.getElementById("cert-download-button"),this.activityDownloadButton=document.getElementById("activity-download-button"),this.shareButton=document.getElementById("activity-share-button"),activitySignal.add((function(t,i){return e.activityEventHandler(t,i)})),this.schoolName=this.getURLParameterByName("sc"),null===this.schoolName&&(this.schoolName="None"),this.classroomName=this.getURLParameterByName("cl"),null===this.classroomName&&(this.classroomName="None"),this.providerName=this.getURLParameterByName("pr"),null===this.providerName&&(this.providerName="None"),this.cheatCert=document.getElementById("certificate-button"),this.cheatCert&&this.cheatCert.addEventListener("click",(function(t){return e.showCertificate(t)})),this.setProviderLogo(),"vng"!==this.providerName&&this.certificateElement.classList.add("no-kidscorner"),this.certExporter=new Tt({downloadButton:this.certDownloadButton,nameElement:document.getElementById("certificate-name")}),this.socialHandler=new At({facebook:!0}),this.certDownloadButton.addEventListener("click",(function(){return e.certExporter.downloadCertificate()})),this.activityDownloadButton.addEventListener("click",(function(){return e.downloadAllActivities()})),this.shareButton.addEventListener("click",(function(){return e.shareOnSocial()}))}},{key:"setProviderLogo",value:function(){var e=document.getElementById("ldc-logo");"None"!==this.providerName&&(this.currentProvider=this.providerLookup[this.providerName]);var t="./assets/images/logos/"+this.currentProvider.logo;e.src=t}},{key:"activityEventHandler",value:function(e,t){switch(e){case"start_activity":this.setGameActive(),this.trackActivityStart(t.activityName);break;case"show_help":this.setUIOverlayActive();break;case"download":this.downloadActivitySheet(t.activityName);break;case"request_share":this.socialHandler.requestAgeRestrictedAction(t.shareType);break;case"verify_share":!0===t.isOver13&&this.socialHandler.displayFacebookShare({body:"Check out these cool activities, and become a safe digging champion like me!"});break;case"activate_social":this.socialHandler.displayFacebookShare(t);break;case"save_image":this.saveActivityImage(t);break;case"end_activity":this.setGameInactive(),this.trackActivityComplete(t.activityName),t.activitiesCompleted&&this.setCompletionStates(t.activitiesCompleted)}}},{key:"startActivity",value:function(e){var t=e.target.getAttribute("data-activity");activitySignal.dispatch("start_activity",{activityName:t,providerData:this.currentProvider})}},{key:"nextActivity",value:function(){var e=!1,t=!0,i=!1,n=void 0;try{for(var a,o=this.activityLaunchElements[Symbol.iterator]();!(t=(a=o.next()).done);t=!0){var s=a.value.getAttribute("data-activity");if(0==game.globalState.gameCompletion[s]){console.log("Launching",s),activitySignal.dispatch("start_activity",{activityName:s,providerData:this.currentProvider}),e=!0;break}}}catch(e){i=!0,n=e}finally{try{t||null==o.return||o.return()}finally{if(i)throw n}}!1===e&&this.showCertificate()}},{key:"setGameActive",value:function(){this.setIntroOverlayInactive(),this.gameParentElement.classList.add("active"),document.body.classList.add("overlay-active"),document.documentElement.scrollTop=0,document.querySelectorAll(".overlay-container").forEach((function(e){e.scrollTop=0})),this.setUIOverlayActive()}},{key:"setGameInactive",value:function(){this.gameParentElement.classList.remove("active"),document.body.classList.remove("overlay-active"),this.setUIOverlayInactive(null,!1)}},{key:"toggleGameActive",value:function(){this.gameParentElement.classList.toggle("active")}},{key:"setUIOverlayActive",value:function(){this.gameUIElement.classList.add("active")}},{key:"setUIOverlayInactive",value:function(e,t){this.gameUIElement.classList.remove("active"),activitySignal.dispatch("overlay_close",{}),t&&game.sound.play("general_select")}},{key:"toggleUIOverlay",value:function(){this.gameUIElement.classList.toggle("active")}},{key:"setIntroOverlayActive",value:function(){document.body.classList.add("overlay-active"),document.documentElement.scrollTop=0,document.querySelectorAll(".overlay-container").forEach((function(e){e.scrollTop=0})),this.introElement.classList.add("active")}},{key:"setIntroOverlayInactive",value:function(){document.body.classList.remove("overlay-active"),this.introElement.classList.remove("active")}},{key:"toggleIntroOverlay",value:function(){this.introElement.classList.toggle("active")}},{key:"setCompletionStates",value:function(e){var t=!0,i=!0,n=!1,a=void 0;try{for(var o,s=this.activityLaunchElements[Symbol.iterator]();!(i=(o=s.next()).done);i=!0){var r=o.value;1==e[r.getAttribute("data-activity")]?r.parentElement.classList.add("completed"):t=!1}}catch(e){n=!0,a=e}finally{try{i||null==s.return||s.return()}finally{if(n)throw a}}!0===t&&this.unlockCertificate()}},{key:"forceCompletionStates",value:function(){var e=!0,t=!1,i=void 0;try{for(var n,a=this.activityLaunchElements[Symbol.iterator]();!(e=(n=a.next()).done);e=!0){var o=n.value,s=o.getAttribute("data-activity");game.globalState.gameCompletion[s]=!0,o.parentElement.classList.add("completed")}}catch(e){t=!0,i=e}finally{try{e||null==a.return||a.return()}finally{if(t)throw i}}this.setCompletionStates(game.globalState.gameCompletion),this.showCertificate()}},{key:"unlockCertificate",value:function(){var e=document.getElementById("certificate-button"),t=e.getElementsByTagName("input")[0];e.classList.remove("disabled"),t.disabled=!1}},{key:"showCertificate",value:function(){this.certificateElement.classList.add("active"),document.documentElement.scrollTop=0,this.setIntroOverlayInactive();var e=document.getElementsByClassName("star")[0];St.b.fromTo(e,1.6,{rotation:1e3,scale:0},{rotation:-13,scale:1,ease:Back.easeOut,delay:.5}),document.getElementById("certificate-name"),!1===this.certificateAwarded&&(this.certificateAwarded=!0,this.trackCertificateAward())}},{key:"hideCertificate",value:function(){this.certificateElement.classList.remove("active")}},{key:"printCertificate",value:function(){window.print(),this.trackCertificatePrint()}},{key:"downloadAllActivities",value:function(){var e="assets/images/downloadable_activities/default/SafeDiggingActivities.pdf";this.brandedActivityBooks.includes(this.providerName)&&(e="assets/images/downloadable_activities/"+this.providerName+"/"+this.providerName+"_SafeDiggingActivities.pdf");var t=location.href.split("?")[0];_t()(t+e),this.trackAllActivitiesDownloaded()}},{key:"downloadActivitySheet",value:function(e){var t="./assets/images/downloadable_activities/"+this.providerName+"/"+e+".png";_t()(t),this.trackActivityDownloaded(e)}},{key:"saveActivityImage",value:function(e){_t()(e.image,e.title,"image/png")}},{key:"shareOnSocial",value:function(){this.socialHandler.requestAgeRestrictedAction("general_share")}},{key:"trackActivityStart",value:function(e){var t=game.globalState.gameNamesForAnalytics[e];ga("send",{hitType:"event",eventCategory:this.schoolName,eventAction:this.classroomName,eventLabel:"START "+t,eventValue:1})}},{key:"trackActivityComplete",value:function(e){var t=game.globalState.gameNamesForAnalytics[e];ga("send",{hitType:"event",eventCategory:this.schoolName,eventAction:this.classroomName,eventLabel:"FINISH "+t,eventValue:1})}},{key:"trackActivityDownloaded",value:function(e){var t=game.globalState.gameNamesForAnalytics[e];ga("send",{hitType:"event",eventCategory:this.schoolName,eventAction:this.classroomName,eventLabel:"DOWNLOADED "+t,eventValue:1})}},{key:"trackAllActivitiesDownloaded",value:function(){ga("send",{hitType:"event",eventCategory:this.schoolName,eventAction:this.classroomName,eventLabel:"DOWNLOADED All Activities",eventValue:1})}},{key:"trackCertificateAward",value:function(){ga("send",{hitType:"event",eventCategory:this.schoolName,eventAction:this.classroomName,eventLabel:"AWARDED Certificate",eventValue:1})}},{key:"trackCertificatePrint",value:function(){ga("send",{hitType:"event",eventCategory:app.schoolName,eventAction:app.classroomName,eventLabel:"PRINTED Certificate",eventValue:1})}},{key:"trackCertificateDownload",value:function(){ga("send",{hitType:"event",eventCategory:app.schoolName,eventAction:app.classroomName,eventLabel:"DOWNLOADED Certificate",eventValue:1})}},{key:"getURLParameterByName",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];null===t&&(t=!0);var i=new RegExp("[?&]"+e+"=([^&]*)").exec(window.location.search);return t?i&&decodeURIComponent(i[1].replace(/\/+/g,"")):i&&decodeURIComponent(i[1])}}])&&Ot(t.prototype,i),n&&Ot(t,n),e}();window.PIXI=n,n.particles=a,window.signals=s.a,l.objectForEach();var Ct=function e(){var t;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),U.a._setup(),window.Environment=U.a,window.Vector=b.a,"http:"===location.protocol||"https:"===location.protocol){var i=location.pathname.split("/"),n=location.pathname;i[i.length-1].indexOf(".html")>-1&&(i.pop(),n=i.join("/")+"/"),t=location.protocol+"//"+location.host+n}else t="./";var a=document.getElementsByTagName("html")[0].getAttribute("lang");"string"!=typeof a&&(a=null);var o={activities:[{name:"Title",classRef:v,options:{manifest:"assets/config/manifests/title.json",setup:"assets/config/scenes/title.json",next:"ConnectPipes"}},{name:"ConnectPipes",classRef:oe,options:{manifest:"assets/config/manifests/connectpipes.json",setup:"assets/config/scenes/connectpipes.json",next:"Title"}},{name:"WordScramble",classRef:ct,options:{manifest:"assets/config/manifests/wordscramble.json",setup:"assets/config/scenes/wordscramble.json",next:"Title"}},{name:"MatchFlags",classRef:Je,options:{manifest:"assets/config/manifests/matchflags.json",setup:"assets/config/scenes/matchflags.json",next:"Title"}},{name:"Crossword",classRef:ge,options:{manifest:"assets/config/manifests/crossword.json",setup:"assets/config/scenes/crossword.json",next:"Title"}},{name:"Coloring",classRef:de,options:{manifest:"assets/config/manifests/coloring.json",setup:"assets/config/scenes/coloring.json",next:"Title"}},{name:"Maze",classRef:nt,options:{manifest:"assets/config/manifests/maze.json",setup:"assets/config/scenes/maze.json",next:"Title"}},{name:"ISpy",classRef:He,options:{manifest:"assets/config/manifests/ispy.json",setup:"assets/config/scenes/ispy.json",next:"Title"}},{name:"WordSearch",classRef:yt,options:{manifest:"assets/config/manifests/wordsearch.json",setup:"assets/config/scenes/wordsearch.json",next:"Title"}}],overlays:[{name:"GameOverlay",classRef:kt,options:{manifest:"assets/config/manifests/game_overlay.json",setup:"assets/config/scenes/game_overlay.json",next:"Title"}}]},r=U.a.getURLParameterByName("SCENE")||"Title";window.activitySignal=new s.a.Signal;var l=new c.a({framerate:60,baseUrl:t,canvasParent:"canvas-wrapper",maxSize:{width:1536,height:768},safeSize:{width:1024,height:768},background:7829367,initialScenes:[r,"GameOverlay"],scenes:o,language:a,scaleController:"default",springroll:!1,preload:[]}),u=new Pt({game:l});window.game=l,window.app=u};window.onload=function(){new Ct},window.onbeforeunload=function(){}},25:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i(10);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function r(e){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var c=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),s(this,r(t).call(this))}var i,a,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(t,PIXI.Graphics),i=t,(a=[{key:"dashedLineTo",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:20,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:30,o=this.currentPath.shape.points,s=o[o.length-2],r=o[o.length-1],l=new n.a(e,t,s,r),c=!0,u=l.length,h=0;for(l.normalize(.1);h<u;)c?((h+=i)>u&&(h=u),l.normalize(h),this.lineTo(l.x,l.y),c=!1):((h+=a)>u&&(h=u),l.normalize(h),this.moveTo(l.x,l.y),c=!0)}},{key:"drawDashedCircle",value:function(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:20,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:30,o=2*Math.PI,s=o*i,r=this.lineWidth,l=this.lineColor,c=this.lineAlpha,u=this.lineAlignment,h=this.fillColor,d=this.fillAlpha,f=this.filling,p=n/s*o,y=a/s*o,m=0,v=!0;for(f&&(this.lineStyle(0,0,0),this.drawCircle(e,t,i),this.endFill());m<o;){var g=void 0;v?(this.lineStyle(r,l,c,u),(g=m+p)>o&&(g=o),this.arc(e,t,i,m,g),m=g,v=!1):(this.lineStyle(0,0,0),(g=m+y)>o&&(g=o),this.arc(e,t,i,m,g),m=g,v=!0)}f&&this.beginFill(h,d),this.lineStyle(r,l,c,u)}},{key:"drawPath",value:function(e){var t,i=this,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:20,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:30,r=0,l=!a;e.forEach((function(e,c){if(0!=c&&l?i.lineTo(e.x,e.y):i.moveTo(e.x,e.y),a&&t){var u=new n.a(e.x,e.y,t.x,t.y);r+=u.length,l?r>o&&(l=!1,r=0):r>s&&(l=!0,r=0)}t=e}))}},{key:"drawArrow",value:function(e,t){this.drawPolygon([e.x+e.vy*(t/e.length),e.y-e.vx*(t/e.length),e.x-e.vy*(t/e.length),e.y+e.vx*(t/e.length),e.x+e.vx*(t/e.length),e.y+e.vy*(t/e.length)])}}])&&o(i.prototype,a),c&&o(i,c),t}()},3:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i(10),a=i(14);function o(e){return function(e){if(Array.isArray(e)){for(var t=0,i=new Array(e.length);t<e.length;t++)i[t]=e[t];return i}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t,i){return t&&r(e.prototype,t),i&&r(e,i),e}var c=function(){function e(){s(this,e),this.inputs={},this.historyLength=10,this.pinchScale=.9,this.spreadScale=1.1,this._drag=!1,this._lastInputTime=Date.now(),this._idList=[],this.inputs[e.ALL]=[],this.inputs[e.DOWN]=[],this.inputs[e.UP]=[],this.inputs[e.MOVE]=[],this.inputs[e.OVER]=[],this.inputs[e.OUT]=[],this.inputs[e.LEAVE]=[],this.inputs[e.ENTER]=[],this.down=new signals.Signal,this.up=new signals.Signal,this.move=new signals.Signal,this.enter=new signals.Signal,this.leave=new signals.Signal,this.pinch=new signals.Signal,this.spread=new signals.Signal,this._enabled=!0,this.console=new a.a(this),this.allowMultitouch=!0,this._interactions={},this._listenerCount=0}return l(e,null,[{key:"ALL",get:function(){return 0}},{key:"DOWN",get:function(){return 1}},{key:"UP",get:function(){return 2}},{key:"MOVE",get:function(){return 3}},{key:"OVER",get:function(){return 4}},{key:"OUT",get:function(){return 5}},{key:"LEAVE",get:function(){return 6}},{key:"ENTER",get:function(){return 7}},{key:"TYPE_NAMES",get:function(){return["all","onPress","onUp","onMove","onOver","onOut"]}}]),l(e,[{key:"enable",value:function(){this._enabled=!0}},{key:"disable",value:function(){this._enabled=!1}},{key:"getLastInput",value:function(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.ALL,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;if(n>-1){var a=this._idList.find((function(e){return e.id==n}));t=a?a.inputs[i]:[]}else t=this.inputs[i]||[];return t[t.length-1]}},{key:"getPrevInput",value:function(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.ALL,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;if(n>-1){var a=this._idList.find((function(e){return e.id==n}));t=a?a.inputs[i]:[]}else t=this._idList[0]?this._idList[0].inputs[i]:[];return t[t.length-2]}},{key:"hasInputID",value:function(e){return this._idList.findIndex((function(t){return t.id==e}))>-1}},{key:"handleInputEvent",value:function(e,t){if(this._enabled)if(e.data&&e.data.originalEvent){var i=e.data.originalEvent;if(i.changedTouches){for(var n=0;n<i.changedTouches.length;n++){var a=i.changedTouches[n];!this.allowMultitouch&&this._idList.length>0&&!this.hasInputID(a.identifier)||this.registerInput(t,new PIXI.Point(a.globalX,a.globalY),e.target?e.target.name:null,e.currentTarget.name,a.identifier,!0)}var o=[];for(n=0;n<i.touches.length;n++){var s=i.touches[n];o.push(s.identifier)}this._idList=this._idList.filter((function(e){return o.indexOf(e.id)>-1})),this._checkDrag()}else{var r=null;e.target?r=e.target.name:e.currentTarget&&(r=e.currentTarget.name),this.registerInput(t,e.data.global.clone(),r,e.currentTarget.name,1)}}else e instanceof MouseEvent&&this.registerInput(t,new PIXI.Point(e.clientX/game.scaleManager.scale,e.clientY/game.scaleManager.scale),null,null,1)}},{key:"_saveInput",value:function(t){var i=this._idList.find((function(e){return e.id==t.id})),n=this.inputs[e.ALL],a=this.inputs[t.type];if(i){var o=i.inputs[e.ALL],s=i.inputs[t.type];o.push(t),o.length>this.historyLength&&o.shift(),s.push(t),s.length>this.historyLength&&s.shift()}n.push(t),n.length>this.historyLength&&n.shift(),a.push(t),a.length>this.historyLength&&a.shift()}},{key:"on",value:function(t,i,n,a,s){var r=this;if(!i&&!n&!a){var l=function(e){var t=r._interactions[e];t&&(t.disabled=!1)};Array.isArray(t)?t.forEach(l):l(t)}else{if("string"!=typeof n||!a||a[n]){"number"==typeof i&&(i=e.TYPE_NAMES[i]),this.console.log("binding call",n,"to object",t,"on interaction",i,"with arguments",s);var c,u=function(e){if(!r._interactions[e]){r._interactions[e]={onPress:[],onMove:[],onOver:[],onUp:[],onOut:[],disabled:!1}}var t=r._interactions[e],l="string"==typeof n?n:"".concat(e,"_").concat(r._listenerCount);return t[i]&&(t[i].push({name:l,call:"string"==typeof n?function(e){return a[n].apply(a,o([].concat(null!=s?[].concat(s,e):e)))}:n}),r._listenerCount++),l};return Array.isArray(t)?(c=[],t.forEach((function(e){c.push(u(e))}))):c=u(t),this.console.log(c),c}console.warn("!! cannot bind",n,"to",t.name,"call does not exist in scope")}}},{key:"off",value:function(e){var t=this,i=function(e){var i=t._interactions[e];i&&(i.disabled=!0)};Array.isArray(e)?e.forEach(i):i(e)}},{key:"remove",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;"number"==typeof i&&(i=e.TYPE_NAMES[i]),this.console.log("removing interactions on",t,"for type",i);var a=this._interactions[t];if(a)if(i){var o=a[i];a[i]=null==typeof n?[]:o.filter((function(e){return e.name!=n}))}else for(var s in a)Array.isArray(a[s])&&(a[s]=[])}},{key:"_handleInteractions",value:function(t){var i=e.TYPE_NAMES[t.type];if(i){var n=this._interactions[t.target];n&&!n.disabled&&n[i].forEach((function(e){e.call(t)}))}}},{key:"registerInput",value:function(t,i,a,o){var s=this,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,l=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(this._enabled){var c,h=new u({position:i,initial:i,rotation:0,travel:null,dragDistance:null,type:t,timestamp:Date.now(),target:a,currentTarget:o,id:r,touch:l});this.hasInputID(r)?((c=this._idList.find((function(e){return e.id==r}))).currentPos=h.position,h.type==e.UP&&(c.ended=!0),h.type==e.DOWN&&(c.initialPos=h.position)):((c={id:r,initialPos:h.position.clone(),currentPos:h.position.clone(),inputs:[],ended:!1}).inputs[e.ALL]=[],c.inputs[e.DOWN]=[],c.inputs[e.UP]=[],c.inputs[e.MOVE]=[],c.inputs[e.OVER]=[],c.inputs[e.OUT]=[],c.inputs[e.LEAVE]=[],c.inputs[e.ENTER]=[],this._idList.push(c)),h.initial=c.initialPos;var d=this.getLastInput(e.ALL,h.id);if(d){var f=Math.atan2(d.position.y-h.position.y,d.position.x-h.position.x);h.rotation=f;var p=new n.a(i.x,i.y,d.position.x,d.position.y);h.travel=p,this.isDown&&(h.dragDistance=new n.a(h.position.x,h.position.y,c.initialPos.x,c.initialPos.y))}this._idList.forEach((function(e){if(e.id!=h.id){var t=c.initialPos,i=e.initialPos,a=e.currentPos,o={id:e.id,initialDistance:new n.a(i.x,i.y,t.x,t.y),currentDistance:new n.a(a.x,a.y,h.position.x,h.position.y)};h.touchSpaces.push(o),(!h.farthestSpace||o.currentDistance.length>h.farthestSpace.currentDistance.length)&&(h.farthestSpace=o),(!h.closestSpace||o.currentDistance.length<h.closestSpace.currentDistance.length)&&(h.closestSpace=o)}})),this._lastInputTime=h.timestamp,this._saveInput(h),h.type==e.ENTER&&this.enter.dispatch(h),h.type==e.LEAVE&&(this._drag=!1,this.leave.dispatch(h)),h.type==e.DOWN&&(this._drag=!0,this.down.dispatch(h)),h.type==e.UP&&(l&&(this._idList=this._idList.filter((function(e){return e.id!=h.id}))),this._checkDrag(),this.up.dispatch(h)),h.type==e.MOVE&&(this.move.dispatch(h),h.touchSpaces.length>0&&h.touchSpaces.forEach((function(e){e.currentDistance.length/e.initialDistance.length>s.spreadScale&&s.spread.dispatch(h),e.currentDistance.length/e.initialDistance.length<s.pinchScale&&s.pinch.dispatch(h)}))),this._handleInteractions(h)}}},{key:"_checkDrag",value:function(){for(var e in this._idList){if(!this._idList[e].ended)return void(this._drag=!0)}this._drag=!1}},{key:"enabled",get:function(){return this._enabled}},{key:"multitouch",get:function(){return this._idList.length>1}},{key:"isDown",get:function(){return this._drag}},{key:"inputList",get:function(){var e=[];return this._inputList.forEach((function(t){return e.push(t.id)})),e}}]),e}(),u=function e(t){var i=t.position,n=t.initial,a=t.rotation,o=t.travel,r=t.dragDistance,l=t.type,c=t.target,u=t.currentTarget,h=t.id,d=t.touch;s(this,e),this.position=i,this.initial=n,this.rotation=a||0,this.travel=o,this.dragDistance=r,this.type=l,this.timestamp=Date.now(),this.target=c,this.currentTarget=u,this.id=h,this.touch=d,this.touchSpaces=[],this.closestSpace,this.farthestSpace}},4:function(e,t,i){"use strict";function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}i.d(t,"a",(function(){return a}));var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,i,a;return t=e,a=[{key:"shuffle",value:function(e){var t,i,n=e.length;if(0!==n)for(;--n;)t=Math.floor(Math.random()*(n+1)),i=e[n],e[n]=e[t],e[t]=i}},{key:"randFromArray",value:function(e){return e[Math.floor(Math.random()*e.length)]}},{key:"cycleArray",value:function(e,t){var i=t?e.pop():e.shift();return t?e.unshift(i):e.push(i),i}},{key:"reachInto",value:function(e,t){return t>=e.length?e[e.length-1]:e[t]}},{key:"remove",value:function(e,t){for(var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=t.length-1;n>=0;n--)if(e==t[n]&&(t.splice(n,1),!i))return}},{key:"search",value:function(e,t){for(var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=[],a=0;a<t.length;a++)if(e(t[a])){if(!i)return t[a];n.push(t[a])}return n.length?n:null}},{key:"searchByProperty",value:function(t,i,n){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return e.search((function(e){return e[t]==i}),n,a)}},{key:"include",value:function(e,t){-1==t.indexOf(e)&&t.push(e)}},{key:"includes",value:function(e,t){return-1!=t.indexOf(e)}}],(i=null)&&n(t.prototype,i),a&&n(t,a),e}()},5:function(e,t,i){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var l=function(e){function t(e,i){var a,r,l;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,a=!(l=o(t).call(this))||"object"!==n(l)&&"function"!=typeof l?s(r):l,console.log(e),a.textures={},e.hasOwnProperty("spritesheet"))for(var c in e.spritesheet.textures)c.toLowerCase().match(/up(?!\w[up|down|over])/)&&(a.textures.up=e.spritesheet.textures[c]),c.toLowerCase().match(/over(?!\w[up|down|over])/)&&(a.textures.over=e.spritesheet.textures[c]),c.toLowerCase().match(/down(?!\w[up|down|over])/)&&(a.textures.down=e.spritesheet.textures[c]);else e.up&&e.over&&e.down?(a.textures.up=e.up,a.textures.over=e.over,a.textures.down=e.down):(a.textures.up=e.texture,a.textures.over=e.texture,a.textures.down=e.texture);return a.selectionSprite=null,a.interactive=!0,a.cursor="pointer",a.callback=void 0!==i?i:function(){},a.onHighlight=a.onHighlight.bind(s(a)),a.onUnhighlight=a.onUnhighlight.bind(s(a)),a.onPress=a.onPress.bind(s(a)),a.onRelease=a.onRelease.bind(s(a)),a.destroy=a.destroy.bind(s(a)),a.init(),a}var i,l,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}(t,PIXI.Sprite),i=t,(l=[{key:"init",value:function(){this.texture=this.textures.up,this.on("pointerdown",this.onPress).on("pointerup",this.onRelease).on("pointerupoutside",this.onUnhighlight).on("mouseover",this.onHighlight).on("mouseout",this.onUnhighlight)}},{key:"addSelectionSprite",value:function(e){this.selectionSprite=new PIXI.Sprite(e),this.selectionSprite.visible=!1,this.addChild(this.selectionSprite)}},{key:"onHighlight",value:function(){this.texture=this.textures.over,this.selectionSprite&&(this.selectionSprite.visible=!0)}},{key:"onUnhighlight",value:function(){this.texture=this.textures.up,this.selectionSprite&&(this.selectionSprite.visible=!1)}},{key:"onPress",value:function(){this.texture=this.textures.down,this.selectionSprite&&(this.selectionSprite.visible=!0)}},{key:"onRelease",value:function(e){this.onUnhighlight(),this.callback&&this.callback(e)}}])&&a(i.prototype,l),c&&a(i,c),t}(),c=i(9),u=i(4),h=i(2);function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function p(e,t){return!t||"object"!==d(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var g=function(e){function t(e,i){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=p(this,y(t).call(this,i))).cssRule=e,n.fromCSS(),n}var i,n,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}(t,PIXI.TextStyle),i=t,(n=[{key:"fromCSS",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.cssRule,t=document.styleSheets[0],i=u.a.searchByProperty("selectorText",e,t.cssRules);if(i){var n=i.style;n&&(n["text-align"]&&(this.align=n["text-align"]),n.textAlign&&(this.align=n.textAlign),n["font-family"]&&(this.fontFamily=n["font-family"].replace(/['"]+/g,"")),n.fontFamily&&(this.fontFamily=n.fontFamily.replace(/['"]+/g,"")),n.color&&(this.fill=n.color),n["line-height"]&&(this.lineHeight=parseInt(n["line-height"])),n.lineHeight&&(this.lineHeight=parseInt(n.lineHeight)),n["font-variant"]&&(this.fontVariant=n["font-variant"]),n.fontVariant&&(this.fontVariant=n.fontVariant),n["font-size"]&&(this.fontSize=parseInt(n["font-size"])),n.fontSize&&(this.fontSize=parseInt(n.fontSize)),n["font-style"]&&(this.fontStyle=n["font-style"]),n.fontStyle&&(this.fontStyle=n.fontStyle),n["font-weight"]&&(this.fontWeight=n["font-weight"]),n.fontWeight&&(this.fontWeight=n.fontWeight),"normal"==n["word-wrap"]&&(this.wordWrap=!0),"normal"==n.wordWrap&&(this.wordWrap=!0))}else console.warn("[TextStyle] !! Cannot find CSS decleration for",e)}}])&&f(i.prototype,n),a&&f(i,a),t}(),b=i(14),w=i(25);function k(e){return function(e){if(Array.isArray(e)){for(var t=0,i=new Array(e.length);t<e.length;t++)i[t]=e[t];return i}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function S(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function x(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _(e,t,i){return t&&x(e.prototype,t),i&&x(e,i),e}var I=function(){function e(t,i){S(this,e),this.container=t,this.elements={},this.responsiveElements={},this.currentGroup=this.container,this._setAssets(i),this.added=new signals.Signal,this.removed=new signals.Signal,this.console=new b.a(this),this.comps=[],this._commands={}}return _(e,[{key:"init",value:function(){game.scaleManager.onResize.add(this._onResize,this),this.addCommand("sprite",this.makeSprite),this.addCommand("tsprite",this.makeTileSprite),this.addCommand("button",this.makeButton),this.addCommand("group",this.makeGroup),this.addCommand("spine",this.makeSpine),this.addCommand("rect",this.makeRect),this.addCommand("roundrect",this.makeRoundedRect),this.addCommand("circle",this.makeCircle),this.addCommand("polygon",this.makePoly),this.addCommand("text",this.makeText),this.addCommand("graphics",this.makeGraphics),this.addCommand("pcontainer",this.makeParticleContainer)}},{key:"_setAssets",value:function(e){this.assets=e||game.assets}},{key:"addCommand",value:function(e,t){this._commands[e]=t.bind(this)}},{key:"addCompoundElement",value:function(e){var t=this;if(Array.isArray(e))this.comps=this.comps.concat(e.filter((function(e){return!t.comps.find((function(t){return t.name==e.name}))})));else{var i=this.comps.find((function(t){return t.name==e.name}));i?this.console.warn("!! Comp with name",e.name,"has already been added"):this.comps.push(i)}}},{key:"create",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.container;if(Array.isArray(e))return this._createElements(e,t),null;if(!e.debug||GameManager.DEBUG){var i;if(this.console.log("creating element: ",e.name,e.type),this.currentGroup=t,this._commands[e.type])return i=this._commands[e.type](e);if("comp"==e.type){var n=this.comps.find((function(t){return t.name==e.comp}));n?(i=this.create(n),this._setDisplayObjectProperties(e,i)):this.console.warn("!! Could not find comp with name",e.comp)}else this.console.warn("!! No instructions exist to create element of type",e.type)}}},{key:"setupInteractions",value:function(e,t){for(var i=0;i<e.length;i++){var n=e[i],a=this.get(n.object);a?a instanceof l?this._bindInteraction("onPress",a,n.onPress,t,n.args):(this._bindInteraction("onPress",a,n.onPress,t,n.args),this._bindInteraction("onMove",a,n.onMove,t,n.args),this._bindInteraction("onOver",a,n.onOver,t,n.args),this._bindInteraction("onUp",a,n.onUp,t,n.args),this._bindInteraction("onOut",a,n.onOut,t,n.args)):console.warn("!! cannot add interaction to object:",n.object,"- object not found -")}}},{key:"disableInteractions",value:function(e){for(var t=0;t<e.length;t++){var i=e[t],n=this.get(i.object);n?this._removeInteraction(n):console.warn("!! cannot remove interaction from object:",i.object,"- object not found -")}}},{key:"makeGroup",value:function(e){var t=new PIXI.Container;return this._add(e,t),e.elements&&this.create(e.elements,t),this._setDisplayObjectProperties(e,t),t}},{key:"getTexture",value:function(e,t){var i,n,a=this.assets[e];if(!a)for(var o in this.assets)if(o.match(e)&&o.match(/-\d+$/)){if(t)if("number"==typeof t)this.assets[o].data.frames&&(a=this.assets[o]);else for(var s=parseInt(o.match(/\d+(?!-)$/)[0]),r=this.assets[e+"-"+s];r;){if(r.data&&r.data.frames&&r.data.frames[t]){a=r;break}s++,r=this.assets[e+"-"+s]}else a=this.assets[o];if(a)break}if(a||(a=PIXI.utils.TextureCache[e]),a){if(a.textures){if(t){if("number"==typeof t)i=Object.entries(a.data.frames)[t][0];else i=t}else{for(var o in a.data.frames){i=o;break}this.console.warn("No frame specified for this spritesheet. Defaulting to first frame: ".concat(i))}n=a.textures[i]}else n=a.texture;return n}this.console.warn("No textures found relating to asset and frame: ".concat(e,", ").concat(t))}},{key:"makeSprite",value:function(e){var t=this.getTexture(e.asset,e.frame);if(t){var i,n=new PIXI.Sprite(t);if(e.normals){this.console.log("Adding normals for element: ",e.name,e.type);var a=this._getAsset(e.normals),o=new PIXI.Sprite(a.texture);n.parentGroup=PIXI.lights.diffuseGroup,o.parentGroup=PIXI.lights.normalGroup,o.name=e.name+"_n",(i=new PIXI.Container).addChild(n),i.addChild(o)}return this._add(e,i||n),this._setDisplayObjectProperties(e,i||n),i||n}this.console.warn("!! texture not found:",e.asset,e.frame)}},{key:"makeTileSprite",value:function(e){var t=this.getTexture(e.asset,e.frame);if(t){var i,n=new PIXI.extras.TilingSprite(t,100,100);if(e.hasOwnProperty("tileScale")&&n.tileScale.set(e.tileScale),e.hasOwnProperty("tileScaleX")&&(n.tileScale.x=e.tileScaleX),e.hasOwnProperty("tileScaleY")&&(n.tileScale.y=e.tileScaleY),e.hasOwnProperty("tileX")&&(n.tilePosition.x=e.tileX),e.hasOwnProperty("tileY")&&(n.tilePosition.y=e.tileY),e.width&&(n.width=h.a.parseValue(e.width,n)||100),e.height&&(n.height=h.a.parseValue(e.height,n)||100),e.normals){this.console.log("Adding normals for element: ",e.name,e.type);var a=this._getAsset(e.normals),o=new PIXI.Sprite(a.texture);n.parentGroup=PIXI.lights.diffuseGroup,o.parentGroup=PIXI.lights.normalGroup,o.name=e.name+"_n",(i=new PIXI.Container).addChild(n),i.addChild(o)}return n.uvRespectAnchor=!0,this._add(e,i||n),this._setDisplayObjectProperties(e,i||n),i||n}this.console.warn("!! texture not found:",e.asset,e.frame)}},{key:"makeButton",value:function(e){var t=this._getAsset(e.asset),i={};t?(i.spritesheet=t.spritesheet,i.texture=t.texture,i.up=e.up,i.down=e.down||e.up,i.over=e.over||e.up,i.prefix=e.prefix):(i.up=this.getTexture(e.up),i.down=this.getTexture(e.down),i.over=this.getTexture(e.over),i.up||this.console.warn("Asset not specified and no 'up' texture found for :",e.up),i.down||this.console.warn("Asset not specified and no 'down' texture found for :",e.down),i.over||this.console.warn("Asset not specified and no 'over' texture found for :",e.over));var n=new l(i,null);return n.parentLayer=game.getLayer("sprite"),this._add(e,n,null,game.spriteGroup),this._setDisplayObjectProperties(e,n),n}},{key:"makeText",value:function(e){var t=new g(e.cssRule,e.style),i=new PIXI.Text(t);return i.text=e.text,i.style=t,this._add(e,i),this._setDisplayObjectProperties(e,i),i}},{key:"makeSpine",value:function(e){var t=this._getAsset(e.asset);if(t){var i=new PIXI.heaven.spine.Spine(t.spineData);return this._add(e,i,null),this._setDisplayObjectProperties(e,i),e.skin&&i.skeleton.setSkinByName(e.skin),e.animation?(i.state.hasAnimation(e.animation.name)?i.state.setAnimation(0,e.animation.name,e.animation.loop):console.warn("!! Animation",e.animation.name,"not found on element",e.name),e.animation.pause&&(i.state.timeScale=0)):i.state.setEmptyAnimation(0),i}}},{key:"makeRect",value:function(e){var t=new PIXI.Graphics,i=e.width?h.a.parseValue(e.width):1,n=e.height?h.a.parseValue(e.height):1,a=e.top?h.a.parseValue(e.top):0,o=e.left?h.a.parseValue(e.left):0;return t.beginFill(c.a.hexToInt(e.color)||16711680),t.lineStyle(e.lineWidth,e.lineColor,e.lineAlpha),t.drawRect(o,a,i,n),t.endFill(),this._add(e,t),this._setDisplayObjectProperties(e,t),t}},{key:"makeRoundedRect",value:function(e){var t=new PIXI.Graphics,i=e.width?h.a.parseValue(e.width):1,n=e.height?h.a.parseValue(e.height):1,a=e.top?h.a.parseValue(e.top):0,o=e.left?h.a.parseValue(e.left):0,s=e.radius||5;return t.beginFill(c.a.hexToInt(e.color)||16711680),t.lineStyle(e.lineWidth,e.lineColor,e.lineAlpha),t.drawRoundedRect(o,a,i,n,s),t.endFill(),this._add(e,t),this._setDisplayObjectProperties(e,t),t}},{key:"makeCircle",value:function(e){var t=new PIXI.Graphics;return t.beginFill(c.a.hexToInt(e.color)||16711680),t.lineStyle(e.lineWidth,e.lineColor,e.lineAlpha),t.drawCircle(e.circleX||0,e.circleY||0,e.radius||5),t.endFill(),this._add(e,t),this._setDisplayObjectProperties(e,t),t}},{key:"makePoly",value:function(e){var t=new PIXI.Graphics;return t.beginFill(c.a.hexToInt(e.color)||16711680),t.lineStyle(e.lineWidth,e.lineColor,e.lineAlpha),t.drawPolygon(e.points),t.endFill(),this._add(e,t),this._setDisplayObjectProperties(e,t),t}},{key:"makeGraphics",value:function(e){var t=new w.a;return this._add(e,t),this._setDisplayObjectProperties(e,t),t}},{key:"makeParticleContainer",value:function(e){var t=this,i=new PIXI.Container,n=[];if(e.asset){var a=this.getTexture(e.asset,e.frame);a&&n.push(a)}else e.assets&&e.assets.forEach((function(e){var i=t.getTexture(e.name,e.frame);i&&n.push(i)}));var o=new PIXI.particles.Emitter(i,n,"string"==typeof e.config?this._getAsset(e.config).data:e.config);return i.emitter=o,o.emit=!1,o.autoUpdate=!0,this._add(e,i),this._setDisplayObjectProperties(e,i),i}},{key:"get",value:function(e){var t=this.elements[e];if(t)return t.display}},{key:"getData",value:function(e){var t=this.elements[e];if(t)return t.data}},{key:"destroy",value:function(){for(var e in this.elements)this.remove(e,!0,!0);this.container=null,game.scaleManager.onResize.remove(this._onResize)}},{key:"reset",value:function(e){var t=this.elements[e];t&&this._setDisplayObjectProperties(t.data,t.display)}},{key:"remove",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=this.elements[e];if(n){this.console.log("removing element: ",n.name,n.type);var a=n.display;a.spineData&&(a.autoUpdate=!1),(a instanceof PIXI.Sprite||a instanceof PIXI.Container||a instanceof l)&&a.removeAllListeners(),a.emitter&&a.emitter.destroy(),a.parent&&a.parent.removeChild(a),t&&a.destroy({texture:i,baseTexture:i}),this.removed.dispatch(e),this.elements[e]=null,delete this.elements[e],this.responsiveElements[e]=null,delete this.responsiveElements[e]}else console.warn("!! Cannot remove",e,". element does not exist")}},{key:"addResponsive",value:function(e){var t=this.elements[e];t&&(this.responsiveElements[e]=t)}},{key:"removeResponsive",value:function(e){this.responsiveElements[e]=null,delete this.responsiveElements[e]}},{key:"add",value:function(e,t,i){this._add(e,t,i)}},{key:"_add",value:function(e,t,i){var n=e.group?this.get(e.group):this.currentGroup;n||(console.warn("!! Group '"+e.group+"' does not exist. It may not have been created yet"),n=this.container),n.addChild(t);var a={data:e,display:t},o=i||e.name;if(this.elements[o]){for(var s,r=this.elements[o],l=2;r;)s=o+l,r=this.elements[s],l++;o=s}e.name=o,this.elements[o]=a,t.name=o,e.responsive&&(this.responsiveElements[o]=a),this.added.dispatch(o)}},{key:"_bindInteraction",value:function(e,t,i,n,a){i&&(n[i]?t instanceof l?"onPress"==e&&(this.console.log("binding call",i,"to button",t.name,"with arguments",a),t.callback=function(e){return n[i].apply(n,k([].concat(null!=a?[].concat(a,e):e)))}):(this.console.log("binding call",i,"to object",t.name,"on interaction",e,"with arguments",a),t.on(T.TYPES[e],(function(e){return n[i].apply(n,k([].concat(null!=a?[].concat(a,e):e)))}))):console.warn("!! cannot bind",i,"to",t.name,"call does not exist in scope"))}},{key:"_removeInteraction",value:function(e){this.console.log("disabling interactions on",e.name),e instanceof l?e.callback=null:e.removeAllListeners()}},{key:"_createElements",value:function(e,t){for(var i=0;i<e.length;i++){var n=e[i];this.create(n,t)}}},{key:"_setDisplayObjectProperties",value:function(e,t){var i={x:0,y:0};game.scaleManager.getStageBounds();for(var n in t.scale&&t.scale.set(e.scale||e.scaleX||t.scale.x,e.scale||e.scaleY||t.scale.y),i)if("string"==typeof e[n]){var a=h.a.parseValue(e[n],t);i[n]=a}else i[n]=e[n];if(t.position.set(i.x,i.y),t.interactive=e.interactive,t.visible="boolean"!=typeof e.visible||0!=e.visible,t.name=e.name,e.hasOwnProperty("renderLayer")?t.parentLayer=game.getLayer(e.renderLayer):t.parentLayer=game.getLayer("sprite"),e.hasOwnProperty("renderGroup")){var o=game.getLayer(e.renderGroup);o&&(t.parentGroup=o.group)}if(e.hasOwnProperty("zIndex")&&(t.zIndex=e.zIndex),e.hasOwnProperty("zOrder")&&(t.zOrder=e.zOrder),e.hasOwnProperty("alpha")&&(t.alpha=e.alpha),e.hasOwnProperty("mask")){var s=this.get(e.mask);s||console.warn("!! Mask not applied. Could not find ",e.mask,". Make sure it is added before this display object"),t.mask=s}if(t.anchor&&t.anchor.set(e.anchorX||e.anchor||t.anchor.x,e.anchorY||e.anchor||t.anchor.y),e.hasOwnProperty("rotation")&&(t.rotation=c.a.toRadians(e.rotation)),e.hitArea){var r;switch(e.hitArea.type){case"rect":r=new PIXI.Rectangle(h.a.parseValue(e.hitArea.x,t),h.a.parseValue(e.hitArea.y,t),h.a.parseValue(e.hitArea.width,t),h.a.parseValue(e.hitArea.height,t));break;case"rounded_rect":r=new PIXI.RoundedRectangle(h.a.parseValue(e.hitArea.x,t),h.a.parseValue(e.hitArea.y,t),h.a.parseValue(e.hitArea.width,t),h.a.parseValue(e.hitArea.height,t),h.a.parseValue(e.hitArea.radius,t));break;case"circle":r=new PIXI.Circle(h.a.parseValue(e.hitArea.x,t),h.a.parseValue(e.hitArea.y,t),h.a.parseValue(e.hitArea.radius,t));break;case"ellipse":r=new PIXI.Ellipse(h.a.parseValue(e.hitArea.x,t),h.a.parseValue(e.hitArea.y,t),h.a.parseValue(e.hitArea.halfWidth,t),h.a.parseValue(e.hitArea.halfHeight,t));break;case"polygon":var l=e.hitArea.points.map((function(e,i){var n=i%2==0?"x":"y";return e+t[n]-t["x"==n?"width":"height"]/t.scale[n]*t.anchor[n]}));r=new PIXI.Polygon(l)}t.hitArea=r}}},{key:"_getAsset",value:function(e){var t=this.assets[e];if(t)return t;console.warn("!! No asset found with id: ",e)}},{key:"_onResize",value:function(e){for(var t in this.responsiveElements){var i=this.responsiveElements[t];this._setDisplayObjectProperties(i.data,i.display)}}}]),e}(),T=function(){function e(){S(this,e)}return _(e,null,[{key:"TYPES",get:function(){return{onPress:"pointerdown",onMove:"pointermove",onOver:"pointerover",onUp:"pointerup",onOut:"pointerout"}}}]),e}();function E(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var A=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.container=new PIXI.Container,this.container.name="debug",this.textLayout={fontFamily:"Courier New",fontSize:"11px",fill:"black",align:"center",fontWeight:"bold"},this.marker=new PIXI.Container,this.safeGuide=new PIXI.Container,this.boundsDisplay=new PIXI.Container,this.vectorDisplay=new PIXI.Graphics,this.grid=new PIXI.Container,this.lineDisplay=new PIXI.Graphics,this.pointDisplay=new PIXI.Container,this.safeGuide.name="safeguide",this.boundsDisplay.name="boundsDisplay",this.vectorDisplay.name="vectorDisplay",this.lineDisplay.name="lineDisplay",this.pointDisplay.name="pointDisplay",this.width=game.stage.width,this.height=game.stage.height,this.sectionWidth=16,this.sectionHeight=16,this.linePoints=[],this.grid.parentLayer=game.getLayer("grid"),this.grid.parentGroup=this.grid.parentLayer.group,this.grid.name="grid",this.container.interactive=!0,this.container.parentLayer=game.getLayer("debug"),this.container.parentGroup=this.container.parentLayer.group,this.boundsDisplay.interactive=!1,this.vectorDisplay.interactive=!1,this.grid.interactive=!1,this.marker.interactive=!1,this.lineDisplay.interactive=!1,this.container.on("pointerdown",(function(e){return t.onDown(e)})),this.container.on("pointerup",(function(e){return t.onUp(e)})),this.container.on("pointermove",(function(e){return t.onMove(e)}))}var t,i,n;return t=e,(i=[{key:"onDown",value:function(e){}},{key:"onUp",value:function(e){}},{key:"onMove",value:function(e){if(this.markerText){var t=game.scaleManager.getStageBounds();this.marker.position.copy(this.marker.parent.toLocal(e.data.global));var i=this.container.parent.toLocal(e.data.global);this.markerText.text="x : "+Math.floor(i.x)+", y : "+Math.floor(i.y);var n=t.right-t.left,a=t.bottom-t.top;e.data.global.x>t.left+n/2?(this.markerText.anchor.x=1,this.markerText.x=-16):(this.markerText.anchor.x=0,this.markerText.x=16),e.data.global.y>t.top+a/2?(this.markerText.anchor.y=1,this.markerText.y=-5):(this.markerText.anchor.y=0,this.markerText.y=5)}}},{key:"drawGrid",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;game.stage.calculateBounds();var o=game.scaleManager.getMaxBounds(),s=o.width,r=o.height,l=new PIXI.Graphics,c=!e;e||(e={gridWidth:s,gridHeight:r,sectionWidth:this.sectionWidth,sectionHeight:this.sectionHeight}),c&&(l.beginFill(11184810,.5),l.drawRect(0,0,8*e.sectionWidth,8*e.sectionHeight),l.endFill());for(var u=0;u<8*e.sectionHeight;u+=e.sectionHeight){var h=u%(8*e.sectionHeight)==0?.65:.5,d=u%(8*e.sectionHeight)==0?3355443:5592405;l.lineStyle(a+.5,n||d,h),l.moveTo(0,u),l.lineTo(8*e.sectionWidth,u)}for(var f=0;f<8*e.sectionWidth;f+=e.sectionWidth){var p=f%(8*e.sectionWidth)==0?.6:.5,y=f%(8*e.sectionWidth)==0?3355443:5592405;l.lineStyle(a+.5,n||y,p),l.moveTo(f,0),l.lineTo(f,8*e.sectionHeight)}var m=new PIXI.Sprite;m.addChild(l);var v=game.renderer.generateTexture(m);m.destroy();var g=new PIXI.extras.TilingSprite(v);g.parentLayer=game.getLayer("grid"),g.parentGroup=g.parentLayer.group,c?(g.x=-2048,g.y=-2048,g.width=Math.abs(3*g.x),g.height=Math.abs(3*g.y)):(g.x=t,g.y=i,g.width=e.gridWidth+a,g.height=e.gridHeight+a),this.grid.addChild(g),this.grid.alpha=.5,this.grid.blendMode=PIXI.BLEND_MODES.MULTIPLY,l.destroy(),this.container.addChild(this.grid)}},{key:"drawSafeArea",value:function(){var e=game.scaleManager.getSafeBounds(),t=game.scaleManager.getMaxBounds(),i=new PIXI.Graphics,n=new PIXI.Graphics;i.cacheAsBitmap=!0,n.cacheAsBitmap=!0;var a=new PIXI.Text("SAFE AREA\n"+e.width+" x "+e.height,{fontFamily:"Courier New",fontSize:"14px",fill:16711935,align:"left"}),o=new PIXI.Text("MAX SIZE\n"+t.width+" x "+t.height,{fontFamily:"Courier New",fontSize:"20px",fill:16711680,align:"left",fontWeight:"bold"});a.x=e.left+5,a.y=e.top+5,a.alpha=.5,o.x=t.left+5,o.y=t.top+5,o.alpha=.5,this.safeGuide.addChild(i),this.safeGuide.addChild(n),this.safeGuide.addChild(a),this.safeGuide.addChild(o),i.lineStyle(1.1,16711935,.5),i.drawRect(e.left,e.top,e.width,e.height),n.lineStyle(1.1,16711680,.5),n.drawRect(t.left,t.top,t.width,t.height);var s=game.renderer.generateTexture(this.safeGuide),r=new PIXI.Sprite(s);r.parentLayer=game.getLayer("debug"),r.interactive=!1,r.hitArea=new PIXI.Rectangle(0,0,1,1),this.safeGuide.removeChild(i),this.safeGuide.removeChild(n),this.safeGuide.removeChild(a),this.safeGuide.removeChild(o),i.destroy(!0),n.destroy(!0),a.destroy(!0),o.destroy(!0),this.safeGuide.addChild(r),this.safeGuide.interactive=!1,this.safeGuide.parent||this.container.addChild(this.safeGuide)}},{key:"drawMarker",value:function(){new PIXI.Graphics,this.markerText=new PIXI.Text("x : 0000 , y : 0000",this.textLayout),this.markerText.interactive=!1,this.markerText.anchor.set(1,1),this.markerText.position.set(10,-5),this.marker.addChild(this.markerText),this.markerText.blendMode=PIXI.BLEND_MODES.DIFFERENCE,this.container.addChild(this.marker)}},{key:"drawBounds",value:function(e){if(Array.isArray(e))for(var t=e.length-1;t>=0;t--)i(e[t],this.boundsDisplay);else i(e,this.boundsDisplay);function i(e,t){var i=new PIXI.Graphics;e.hitArea&&(i.lineStyle(1,16776960),i.drawShape(e.hitArea));var n=e.anchor?e.width*-e.anchor.x:0,a=e.anchor?e.height*-e.anchor.y:0;i.lineStyle(2,16711680,.5,.5,!0),i.drawRect(n,a,e.width,e.height);var o=e.parent?e.parent.toGlobal(e.position):new PIXI.Point(e.x,e.y);i.drawCircle(0,0,5),i.x=o.x,i.y=o.y,t.addChild(i)}this.container.addChild(this.boundsDisplay)}},{key:"clearBounds",value:function(){this.boundsDisplay.removeChildren()}},{key:"drawVector",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:65535,n=10057591,a=7838105,o=.2,s=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,o=5;t.lineStyle(1,n,a),t.moveTo(e.origin.x,e.origin.y),t.lineTo(e.x,e.y),t.beginFill(n,a),t.drawCircle(e.origin.x,e.origin.y,5),t.endFill(),t.beginFill(n,a),t.drawPolygon([e.x+e.vy*(o/e.length),e.y-e.vx*(o/e.length),e.x-e.vy*(o/e.length),e.y+e.vx*(o/e.length),e.x+e.vx*(o/e.length),e.y+e.vy*(o/e.length)]),t.endFill()};s(e,this.vectorDisplay),t&&(s(e.leftNormal,this.vectorDisplay,n,o),s(e.rightNormal,this.vectorDisplay,a,o)),this.vectorDisplay.parent||this.container.addChild(this.vectorDisplay)}},{key:"clearVector",value:function(){this.vectorDisplay.clear()}},{key:"startLine",value:function(){this.lineDisplay.clear(),this.linePoints.length=0,console.log("starting line")}},{key:"addPoint",value:function(e,t){this.linePoints.push({position:e,color:t||255})}},{key:"drawLine",value:function(){this.lineDisplay.clear(),this.lineDisplay.parent||this.container.addChild(this.lineDisplay);for(var e=0;e<this.linePoints.length;e++){var t=this.linePoints[e].position,i=this.linePoints[e].color;this.lineDisplay.lineStyle(4,i),0==e?this.lineDisplay.moveTo(t.x,t.y):this.lineDisplay.lineTo(t.x,t.y)}}},{key:"drawCoordinate",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16711680,n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this.pointDisplay.parent||this.container.addChild(this.pointDisplay);var a=new PIXI.Container,o=new PIXI.Graphics;if(o.beginFill(i),o.drawCircle(e,t,2),o.interactive=!1,o.parentLayer=game.getLayer("debug"),a.addChild(o),a.parentLayer=game.getLayer("debug"),n){var s=new PIXI.Text("x : ".concat(Math.floor(e)," , y : ").concat(Math.floor(t)),this.textLayout);s.interactive=!1,s.anchor.set(1,1),s.position.set(e+10,t-5),s.alpha=.5,a.addChild(s),s.blendMode=PIXI.BLEND_MODES.DIFFERENCE,s.parentLayer=game.getLayer("debug")}this.pointDisplay.addChild(a)}},{key:"clearCoordinates",value:function(){this.pointDisplay.removeChildren()}},{key:"hide",value:function(){this.container.visible=!1}},{key:"show",value:function(){this.container.visible=!0}},{key:"destroy",value:function(){this.container.destroy(!0)}},{key:"update",value:function(){}}])&&E(t.prototype,i),n&&E(t,n),e}(),O=i(3),P=i(15),C=i(12);function L(e){return(L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function D(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function M(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function j(e,t,i){return t&&M(e.prototype,t),i&&M(e,i),e}var N=function(){function e(){D(this,e),this.trigger=new signals.Signal,this.eventSignal=new signals.Signal,this._events={},this._eventQueue=[],this._triggers={},this._queueBusy=!1,this._activities={},this._inactiveFrames=0,this._frameCount=0,this._inactiveTimesteps=0,this._timesteps=0,this._trackInactive=!0,this.trigger.add(this.handleTriggers,this),this.console=new b.a(this),e.DEBUG?this.console.enable():this.console.disable()}return j(e,null,[{key:"DEBUG",get:function(){return!1}}]),j(e,[{key:"hasActivity",value:function(e){return!!this._activities[e]&&(this._activities[e].count>0||this._activities[e].targets.length>0)}},{key:"logActivity",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=this._activities[e];if(i||(i={name:e,count:0,targets:[]},this._activities[e]=i),i.count++,t){var n=i.targets.find((function(e){return e.name==t}));n||(n={name:t,count:0},i.targets.push(t)),n.count++}this._inactiveFrames=0,this._inactiveTimesteps=0,this.handleTriggers(R.ACTIVITY,i)}},{key:"clearActivity",value:function(e){this._activities[e]&&(this._activities[e]=null,delete this._activities[e])}},{key:"getActivityCount",value:function(e,t){var i=this._activities[e];if(!i)return 0;if(t){var n=i.targets.find((function(e){return e.name==t}));return n?n.count:0}return i.count}},{key:"addEvent",value:function(e){var t=e.id,i=e.onStart,n=e.onEnd,a=e.onUpdate,o=e.onTimestep,s=e.trigger,r=e.context,l=e.queue,c=e.maxInstances,u=e.priority,h=e.endImmediately,d=e.removeOnEnd,f={id:t,handler:i,onEnd:n,onUpdate:a,onTimestep:o,trigger:s,context:r,queue:l,maxInstances:c,endImmediately:h,end:this.endEvent.bind(this,t),priority:u||0,count:0,activeTime:0,frameCount:0,timesteps:0,removeOnEnd:d};if(this.console.log("adding event: ",f.id),this._events[t]=f,s){var p=this._triggers[s.type]||[];p.push(t),this._triggers[s.type]=p}return this}},{key:"clearEvent",value:function(e){this._events[e]=null,delete this._events[e]}},{key:"executeEvent",value:function(e){var t=this._events[e];t?(t.active=!0,t.context?t.handler.call(t.context,t):t.handler(t),t.count++,t.active&&t.endImmediately&&t.end()):console.warn("No event with ID: ",e)}},{key:"queueEvent",value:function(e,t){var i=this,n=this._events[e];if(n){if(t)this._eventQueue.push(e);else{if(n.priority<0&&this._eventQueue.length>0)return;this._eventQueue.push(e),this._eventQueue.sort((function(e,t){var n=i._events[e],a=i._events[t],o=-1==n.priority?0:n.priority,s=-1==a.priority?0:a.priority;return o>s?1:o<s?-1:0}))}return this}console.warn("No event with ID: ",e)}},{key:"wait",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=t.onStart,n=t.onEnd,a=t.useFrames,o=t.useTimesteps;this.__waitcount=(this.__waitcount||0)+1;var s={id:"wait".concat(Math.trunc(e)),queue:!0,onStart:i,onEnd:n,removeOnEnd:!0,onUpdate:function(e){e._useFrames&&e.frameCount>=e._targetTime&&e.end()},onTimestep:function(e){e._targetTime||e.end(),e._useTimesteps?e.timesteps>=e._targetTime&&e.end():e.activeTime>=e._targetTime&&e.end()}};this._events[s.id]&&(s.id="wait".concat(Math.trunc(e)).concat(this.__waitcount)),this.addEvent(s);var r=this._events[s.id];return r._useFrames=a,r._useTimesteps=o,r._targetTime=e,this.queueEvent(s.id),this}},{key:"startQueue",value:function(){this.console.log("starting queue..."),this._queueBusy||this.startNextEvent()}},{key:"clearQueue",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this._eventQueue[0];if(this._eventQueue.length=0,e&&t){var i=this._events[t];i.end()}}},{key:"startEvent",value:function(e){var t=this._events[e];if(t)if(t.active)console.warn("Event is already active: ",e);else if(t.queue){if(t.maxInstances&&this._eventQueue.filter((function(t){return t==e})).length>=t.maxInstances)return;this.queueEvent(t.id),this._queueBusy||this.startQueue()}else this.executeEvent(t.id);else console.warn("No event with ID: ",e)}},{key:"startNextEvent",value:function(){var e=this._eventQueue[0];this._events[e]?(this.console.log("next event: ",e),this._queueBusy=!0,this.executeEvent(e)):(this.console.log("no more events. ending queue"),this._queueBusy=!1)}},{key:"endEvent",value:function(e){var t=this._events[e];t&&(this.console.log("ending event: ",e),t.active?(t.onEnd&&t.onEnd(t),t.active&&(t.active=!1,t.timesteps=0,t.frameCount=0,t.activeTime=0,t.removeOnEnd&&this.clearEvent(e),this._eventQueue[0]==t.id&&(this._eventQueue.shift(),this.startNextEvent()))):this.console.warn("!! cannot end event as it is not active:",e))}},{key:"isActive",value:function(e){var t=this._events[e];return!!t&&t.active}},{key:"clear",value:function(){this._events={},this._eventQueue=[],this._triggers={},this._queueBusy=!1}},{key:"destroy",value:function(){this.clear()}},{key:"haltInactive",value:function(){this._trackInactive=!1}},{key:"trackInactive",value:function(){this._trackInactive=!0}},{key:"update",value:function(){for(var e in this._frameCount++,this._trackInactive&&this._inactiveFrames++,this._events){var t=this._events[e];t.active&&(t.frameCount++,t.onUpdate&&t.onUpdate(t))}}},{key:"fixedUpdate",value:function(){for(var e in this._timesteps++,this._trackInactive&&(this._inactiveTimesteps++,this.handleTriggers(R.INACTIVITY)),this.handleTriggers(R.IDLE),this._events){var t=this._events[e];t.active&&(t.timesteps++,t.activeTime=t.timesteps*game.timestep,t.onTimestep&&t.onTimestep(t))}}},{key:"handleTriggers",value:function(e,t){var i=this;e!=R.TIME&&e!=R.INACTIVITY&&e!=R.IDLE&&this.console.log("handling trigger: ",e);var n=this._triggers[e];if(n){n=n.filter((function(e){var n=i._events[e];return n.trigger.type==R.INACTIVITY||n.trigger.type==R.TIME||n.trigger.type==R.INACTIVITY||n.trigger.type==R.IDLE||n.trigger.type==R.ACTIVITY&&(n.trigger.name==t.name||n.trigger.list&&n.trigger.list.find((function(e){return function e(i){return i==t.name||i.name==t.name||Array.isArray(i)&&i.find((function(t){return e(t)}))}(e)})))}));for(var a=0;a<n.length;a++){var o=this._events[n[a]];if(e!=R.TIME&&e!=R.INACTIVITY&&e!=R.IDLE&&this.console.log("checking trigger for event: ",o.id),e==R.ACTIVITY)!function(){var e=!0,n=o.trigger.list||[];!o.trigger.list&&o.trigger.hasOwnProperty("name")&&n.push({name:o.trigger.name,count:o.trigger.hasOwnProperty("count")?o.trigger.count:1,targets:o.trigger.targets});var a=function(e){if("string"!=typeof e){if(0===e.count&&i.hasActivity(e.name))return!1;if(n.length>1&&!i.hasActivity(e.name))return!1;if(1==n.length&&e.name!=t.name)return!1;if(!i._compare(t.count,e.count))return!1;if(e.targets){var a=function(){var n=e.targets[o],a=t.targets.find((function(e){return e.name==n||e.name==n.name}));return a||0!==n.count?a&&("string"==typeof n||i._compare(a.count,n.count))?"continue":{v:!1}:"continue"};for(var o in e.targets){var s=a();switch(s){case"continue":continue;default:if("object"===L(s))return s.v}}}return!0}if(i.hasActivity(e))return!0};n.forEach((function(t,i){if(Array.isArray(t)){for(var n=!1,o=0;o<t.length;o++)if(a(t[o])){n=!0;break}n||(e=!1)}else a(t)||(e=!1)})),e&&(i.console.log("!! event triggered",o.id),i.startEvent(o.id))}();else if(e==R.INACTIVITY){var s=!1;o.trigger.hasOwnProperty("time")?s=this._checkTime(o.trigger.time,!0):o.trigger.hasOwnProperty("frames")&&(s=this._checkFrames(o.trigger.frames,!0)),s&&(this.console.log("!! event triggered",o.id),this.startEvent(o.id))}else if(e==R.IDLE){var r=!1;o.trigger.hasOwnProperty("time")?r=this._checkTime(o.trigger.time):o.trigger.hasOwnProperty("frames")&&(r=this._checkFrames(o.trigger.frames)),r&&(this.console.log("!! event triggered",o.id),this.startEvent(o.id))}else o.trigger.check&&!o.trigger.check(t)||(this.console.log("!! event triggered",o.id),this.startEvent(o.id))}}}},{key:"_checkTime",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=game.timestep,n=Math.ceil(("string"==typeof e&&e.match(/\d+/)?e.match(/\d+/)[0]:e)/i);return this._compare(t?this._inactiveTimesteps:this._timesteps,"string"==typeof e?e.replace(/\d+/,n):n)}},{key:"_checkFrames",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._compare(t?this._inactiveFrames:this._frameCount,e)}},{key:"_compare",value:function(e,t){if("number"==typeof t){if(e%t==0)return!0}else if("string"==typeof t){var i=/<=|<|>=|>|==/,n=t.split(i),a=t.match(i)[0],o=parseFloat(n[1]);switch(a){case">":if(e>o)return!0;break;case">=":if(e>=o)return!0;break;case"<":if(e<o)return!0;break;case"<=":if(e<=o)return!0;break;case"==":if(e==o)return!0}}return!1}}]),e}(),R=function(){function e(){D(this,e)}return j(e,null,[{key:"TIME",get:function(){return"time"}},{key:"INTERACT",get:function(){return"interact"}},{key:"ACTIVITY",get:function(){return"activity"}},{key:"INACTIVITY",get:function(){return"inactivity"}},{key:"IDLE",get:function(){return"idle"}}]),e}(),B=i(18);function U(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function F(e,t,i){return t&&U(e.prototype,t),i&&U(e,i),e}i.d(t,"a",(function(){return W}));var W=function(){function e(t,i,n){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ready=!1,this.active=!1,this.name=t,this.baseUrl=void 0!==n?n:"",this.manifest=i.manifest||null,this.setup=i.setup||null,this.container=new PIXI.Container,this.container.name=this.name,this.next=void 0!==i.next?i.next:null,this.destroy=this.destroy.bind(this),this.runtime=0,this.delta=0,this.frameCount=0,this.loader=new PIXI.loaders.Loader,this.builder=new I(this.container,this.loader.resources),this.debug=new A(this.container),this.console=new b.a(this),this.input=new O.a,this.animator=new C.a(game.config.anim_global),this.events=new N,this.mounted=!1,this.loading=!1,this._tickMode=e.TICK_NORMAL,this._optionalAssets=[],this._loadedTextures=[],this._additionalAssets=[],this.signal=new signals.Signal,this.loadProgress=new signals.Signal,this.loadComplete=new signals.Signal,this.keyBindings=[{keys:["."],command:"tick"}],this.interface={tick:function(){console.log("hey",a.frameCount),a.tick(),a.timestep()}},this.keyCommand=function(e){return B.a.executeShortcuts(e,a.interface,a.keyBindings)},this.container.interactive=!0,this.container.on("pointerdown",(function(e){return a.input.handleInputEvent(e,O.a.DOWN)})),this.container.on("pointerup",(function(e){return a.input.handleInputEvent(e,O.a.UP)})),this.container.on("pointermove",(function(e){return a.input.handleInputEvent(e,O.a.MOVE)})),this._mouseLeave=function(e){return a.input.handleInputEvent(e,O.a.LEAVE)},this._mouseEnter=function(e){return a.input.handleInputEvent(e,O.a.ENTER)},document.body.addEventListener("mouseleave",this._mouseLeave),document.body.addEventListener("mouseenter",this._mouseEnter)}return F(e,[{key:"added",get:function(){return this.builder.added}},{key:"removed",get:function(){return this.builder.removed}},{key:"elements",get:function(){return this.builder.elements}},{key:"tickMode",get:function(){return this._tickMode},set:function(e){this._tickMode=e}}],[{key:"SCENE_ENTER",get:function(){return"enter"}},{key:"SCENE_START",get:function(){return"start"}},{key:"SCENE_END",get:function(){return"end"}},{key:"SCENE_EXIT",get:function(){return"exit"}},{key:"SCENE_BUILT",get:function(){return"built"}},{key:"TRANSITION_START",get:function(){return"transition_start"}},{key:"TRANSITION_END",get:function(){return"transition_end"}},{key:"TICK_NORMAL",get:function(){return 0}},{key:"TICK_FRAMESTEP",get:function(){return 1}}]),F(e,[{key:"preload",value:function(){var e=this;null===this.manifest||this.loader.resources[this.manifest]?this._onManifestLoaded():(this.loader.add(this.manifest),this.setup&&this.loader.add(this.setup),this.loading=!0,this.loader.load((function(t,i){return e._onManifestLoaded(t,i)})))}},{key:"addToPreload",value:function(e){this._optionalAssets.some((function(t){return t==e}))||this._optionalAssets.push(e)}},{key:"unload",value:function(){if(this.loader){for(var e in this.assets){var t=this.assets[e];if(t&&(t.texture&&t.texture.valid&&(t.texture.destroy(!0),console.log("[Scene] Destroying unused texture:",t.name)),t.data.frames))for(var i in t.data.frames){t.data.frames[i];var n=PIXI.utils.TextureCache[i];n&&n.valid&&(console.log("[Scene] Destroying cached texture:",i),n.destroy(!0))}}this.loader.reset()}}},{key:"_onManifestLoaded",value:function(){for(var e=this,t=this.loader.resources[this.manifest].data,i=function(i){var n=t[i];if(e.loader.resources.hasOwnProperty(n.key))return console.warn(n.key+" already loaded"),"continue";if(!n.optional||e._optionalAssets.some((function(e){return e==n.key}))){var a={key:n.key,url:e._getURL(n)};e.loader.add(a)}},n=0;n<t.length;n++)i(n);this.loading=!0,this.loader.onProgress.add((function(t,i){return e._onLoadProgress(t,i)})),this.loader.onLoad.add((function(t,i){return e._onAssetLoad(t,i)})),this.loader.load((function(t,i){return e._onLoadComplete(t,i)}))}},{key:"_getURL",value:function(e){var t,i,n=e.filename,a=e.ext,o=e.path;if(e.variants){var s=e.variants.find((function(e){return e.scale==game.deviceScale}))||e.variants[0];i=s,e.filename&&(n+=1!=s.scale?"@"+v.scale+"x":"")}else i=e;return i.url?t=i.url:(i.localize&&(o="".concat(o,"/").concat(game.lang)),t="".concat(o,"/").concat(n).concat(a)),t}},{key:"_onLoadComplete",value:function(e,t){var i=this;if(this._additionalAssets.length>0){for(;this._additionalAssets.length;)this.loader.add(this._additionalAssets.shift());this.loader.load((function(e,t){return i._onLoadComplete(e,t)}))}else this.assets=t,this.loading=!1,this.loadComplete.dispatch({scene:this})}},{key:"_onLoadProgress",value:function(e,t){this.loadProgress.dispatch({name:this.name,progress:c.a.constrain(this.loader.progress-this._additionalAssets.length,0,100)})}},{key:"_onAssetLoad",value:function(e,t){var i=this;if(t.data.meta&&t.data.meta.related_multi_packs){var n=t.data.meta.related_multi_packs.concat(),a=t.url.match(/\S+\//)[0];n.forEach((function(t,n){var o=t.split(".")[0];e.resources[o]||i._additionalAssets.find((function(e){return e.key==o}))||(i._additionalAssets.push({key:o,url:"".concat(a).concat(t)}),console.log(o))}))}}},{key:"build",value:function(){this.assets[this.setup]&&(this.sceneData=this.assets[this.setup].data),this.sceneData?(this.builder.init(),this.sceneData.comps&&this.builder.addCompoundElement(this.sceneData.comps),this.sceneData.elements&&this.builder.create(this.sceneData.elements),this.sceneData.interactions&&this.setupInteractions(this.sceneData.interactions,this),this.setupDebug()):console.warn("[Scene] !! No setup file specified for this scene",this.name)}},{key:"create",value:function(e,t){return this.builder.create(e,t)}},{key:"remove",value:function(e){this.builder.remove(e)}},{key:"get",value:function(e){return this.builder.get(e)}},{key:"setupDebug",value:function(){this.sceneData&&this.sceneData.debug?(this.container.addChild(this.debug.container),this.sceneData.showGrid&&this.debug.drawGrid(),this.sceneData.showSafeArea&&this.debug.drawSafeArea(),this.sceneData.showCoords&&this.debug.drawMarker(),!P.a.DEBUG||!this.sceneData.logging&&this.sceneData.hasOwnProperty("logging")?this.console.disable():this.console.enable()):this.debug.hide()}},{key:"setupInteractions",value:function(e){for(var t=0;t<e.length;t++){var i=e[t],n=this.get(i.object);n?(i.onPress&&this.input.on(n.name,"onPress",i.onPress,this,i.args),i.onMove&&this.input.on(n.name,"onMove",i.onMove,this,i.args),i.onOver&&this.input.on(n.name,"onOver",i.onOver,this,i.args),i.onUp&&this.input.on(n.name,"onUp",i.onUp,this,i.args),i.onOut&&this.input.on(n.name,"onOut",i.onOut,this,i.args)):console.warn("!! cannot add interaction to object:",i.object,"- object not found -")}}},{key:"disableGroup",value:function(e){var t=this.get(e).children.map((function(e){return e.name})).filter((function(e){return null!=e}));t.push(e),this.input.off(t)}},{key:"enableGroup",value:function(e){var t=this.get(e).children.map((function(e){return e.name})).filter((function(e){return null!=e}));t.push(e),this.input.on(t)}},{key:"setTickMode",value:function(t){switch(this._tickMode=t,this._tickMode){case e.TICK_FRAMESTEP:B.a.keyDown.add(this.keyCommand);break;default:B.a.keyDown.remove(this.keyCommand)}}},{key:"onTick",value:function(t){switch(this._tickMode){case e.TICK_FRAMESTEP:break;default:this.tick(t)}}},{key:"tick",value:function(e){this.frameCount++,this.update(e),this.events.update()}},{key:"onTimestep",value:function(){switch(this._tickMode){case e.TICK_FRAMESTEP:break;default:this.timestep()}}},{key:"timestep",value:function(){this.fixedUpdate(),this.events.fixedUpdate()}},{key:"boot",value:function(){}},{key:"init",value:function(){}},{key:"start",value:function(){}},{key:"update",value:function(e){}},{key:"fixedUpdate",value:function(e){}},{key:"end",value:function(){}},{key:"exit",value:function(){}},{key:"endScene",value:function(t){var i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.end(),this.sceneData.interactions&&this.builder.disableInteractions(this.sceneData.interactions),this.signal.dispatch(e.SCENE_END,{name:this.name,next:t,transition:i})}},{key:"nextScene",value:function(){this.endScene(this.next,!0)}},{key:"destroy",value:function(t){this.exit(),this.signal.dispatch(e.SCENE_EXIT,{name:this.name}),this.builder.destroy(),this.debug.destroy(),this.console.disable(),this.console.destroy(),this.animator.destroy(),this.events.destroy(),this.unload(),this.loader=null,this.assets=null,this.signal.removeAll(),this.loadProgress.removeAll(),this.loadComplete.removeAll(),this.loadProgress=null,this.loadComplete=null,document.body.removeEventListener("mouseleave",this._mouseLeave),document.body.removeEventListener("mouseenter",this._mouseEnter),delete this.loader,delete this.assets,void 0!==t&&t()}}]),e}()},57:function(e,t,i){"use strict";(function(e){i.d(t,"a",(function(){return o}));var n=i(15);function a(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,i,o;return t=e,o=[{key:"_setup",value:function(t){e._data=t,t&&(e._events=t.events,e._DLevents=t.DLevents)}},{key:"setupLAEvents",value:function(t,i,a,o){e._emitter=t,e._globals=o,t.addMap(a),t.spec=i,e._map=Object.entries(t.catalog.events).map((function(e){return{id:e[0],name:e[1]}})),"development"==n.a.BUILD_ENV&&t.enableLogging()}},{key:"track",value:function(t,i){e._events&&e._events[t]&&e.trackEvent(t,i.value,i,i.labelIndex),e._DLEvents&&e._DLevents[t]&&e.trackDLEvent(t,i),e._emitter&&e.trackLAEvent(t,i)}},{key:"trackLAEvent",value:function(t,i){var n,a=e._emitter,o=e._map,s=e._globals,r=o.find((function(e){return e.name==t}));if(r){var l=a.spec.events[r.id];if(l){var c=[];l.args.forEach((function(e){if(!s.find((function(t){return t==e.name}))){var n=i[e.name];!i.hasOwnProperty(e.name)||e.type.match(/int/)&&isNaN(n)||null===n?console.warn("!! Event for",t," is missing property",e.name):c.push(n)}})),(n=console).log.apply(n,["LAEvent:",t].concat(c)),a[t].apply(a,c)}else console.warn("!! Event id ",r.id," for event ",t,"is not listed in spec")}else console.warn("!! Could not find call for ",t,". Event call is not mapped or not a default event")}},{key:"trackEvent",value:function(t,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=e._events[t];if(o){var s=function(t){var i=t,a=t.match(/\${\w+}/g);return a&&a.forEach((function(t){var a=t.match(/\w+/)[0],o=n[a]||e._data[a];i=i.replace(t,o)})),i},r=s(o.action),l=Array.isArray(o.label)?s(o.label[a]):s(o.label);console.log("GAEvent:",r,l,i),GA_obj.trackEvent(r,l,i)}else console.warn("!! Could not track event",t,". Event not defined")}},{key:"trackDLEvent",value:function(t,i){var n=window.dataLayer||[],a=e._DLevents[t];if(a){var o={};o.event=t,a.forEach((function(n){o[n]=i[n]||e._data[n],o[n]||console.warn("!! Event for",t," is missing property",n)})),n.push(o),console.log("GTMEvent:",o)}else console.warn("!! Could not track GTM event",t,". Event not defined")}}],(i=null)&&a(t.prototype,i),o&&a(t,o),e}()}).call(this,i(84))},58:function(e){e.exports=JSON.parse('{"badge":[2,2,65,1,65,29,1,34],"belt3":[35,35,71,40,99,40,157,33,199,22,210,16,215,15,216,13,222,11,223,9,229,7,230,5,240,0,243,0,248,6,259,29,259,31,249,35,248,37,244,38,235,45,227,48,226,50,219,52,206,59,203,59,201,61,171,71,131,81,117,87,96,91,71,91,31,83,31,81,27,78,24,72,18,67,18,65,6,54,1,52,0,27,13,31],"belt2":[1,1,9,0,21,3,26,7,26,11,24,13,15,13,5,10,0,6],"bangs":[13,13,16,5,20,1,22,14,24,18,30,22,39,22,45,18,46,20,56,21,77,28,95,37,96,39,100,40,108,47,110,47,133,69,133,71,136,74,117,63,105,60,80,61,43,73,32,73,22,70,15,66,7,58,1,44,1,35,4,38,13,42,23,42,23,40,16,38,11,31,10,20],"belt1":[6,6,13,1,24,1,29,5,27,9,21,11,18,21,13,21,11,23,11,27,17,32,18,37,22,41,35,48,36,53,34,56,26,57,21,55,11,46,11,44,3,36,0,24,1,16],"bodyshadow1":[18,18,21,15,28,1,39,2,34,9,31,26,24,34,21,42,22,50,24,53,22,72,25,78,33,85,41,88,65,92,79,96,95,104,96,106,100,107,101,109,107,111,110,114,66,98,24,95,4,74,1,73,1,63,5,45,4,30,11,24,16,22],"bodyshadow2":[7,7,8,2,10,1,15,12,17,13,18,17,20,18,21,22,23,23,24,27,26,28,27,32,29,33,30,37,32,38,33,42,35,43,36,47,38,48,39,52,41,53,42,57,48,65,48,67,39,70,25,78,22,78,12,84,10,83,17,76,20,65,19,59,7,38,1,21,2,15],"bodyshadow3":[13,13,9,5,5,2,18,0,29,13,29,29,9,50,1,49,1,47,6,43,6,41,8,40,12,33,14,27],"bodyshadow4":[97,97,100,90,106,64,107,32,104,22,100,15,91,7,82,4,93,1,99,1,120,11,122,21,128,37,94,152,88,157,88,159,82,165,59,169,5,153,1,149,3,148,8,151,12,151,19,154,41,157,61,157,65,155,65,153,66,155,68,155,74,150,76,145,81,146,83,144],"beltshadow":[43,43,51,33,52,24,50,20,46,17,40,17,36,19,32,18,66,1,81,35,34,58,1,69,5,65,29,54],"cheekshadow":[61,61,65,47,64,33,61,24,59,23,57,18,48,10,39,6,33,6,31,4,45,1,69,11,79,20,85,35,84,60,74,78,60,90,48,96,33,101,5,106,7,104,13,103,30,95,31,93,39,89,41,86,43,86,55,73],"cloud2":[44,44,45,42,53,38,70,37,77,39,87,45,87,36,90,25,96,17,96,15,102,9,104,9,108,5,120,1,140,2,152,8,161,17,167,29,168,39,186,38,196,42,207,53,210,60,211,68,213,70,230,72,240,77,246,85,247,96,243,103,241,103,239,106,228,110,218,110,211,108,207,105,204,105,202,112,198,116,189,121,179,124,155,124,140,119,137,116,131,114,125,120,116,125,98,130,83,130,68,126,59,121,58,119,56,119,50,113,46,104,42,105,37,109,25,113,16,113,7,109,1,100,2,90,7,84,9,84,11,81,22,75,37,74,35,70,35,57,40,47],"eyeoutlineleft":[8,8,12,1,26,1,26,23,21,39,4,31,1,31,0,29,2,19],"eyeoutlineright":[17,17,22,8,25,5,31,3,45,0,57,0,69,4,72,7,74,17,74,39,72,49,70,51,65,51,53,55,48,59,44,60,43,62,39,63,38,65,34,66,33,68,25,72,21,72,9,60,7,60,1,55,9,29,12,23,14,22,15,18],"cloud1":[56,56,60,51,76,45,89,46,99,50,102,53,106,33,113,20,121,11,137,2,147,0,157,1,168,7,178,17,185,31,198,27,210,27,218,29,231,36,239,44,239,46,242,48,246,56,248,63,247,82,272,83,285,86,293,90,298,95,301,101,301,109,298,116,293,122,277,130,260,131,245,126,245,132,240,142,230,151,217,156,187,157,167,154,152,148,143,139,138,139,129,148,109,157,77,157,58,148,48,137,44,125,33,128,17,127,10,124,4,118,1,111,1,102,3,98,8,92,17,87,25,85,37,85,48,89,47,73,52,60],"flower2bud":[3,3,5,1,15,2,21,10,20,17,11,18,4,15,1,11,1,5],"flower2petals":[10,10,11,6,15,3,24,5,31,12,39,27,39,14,42,7,47,2,58,1,63,5,64,17,54,33,59,31,69,31,77,34,84,43,84,49,79,54,62,54,62,56,65,58,69,65,71,74,70,80,67,85,58,87,51,84,45,76,43,67,41,68,39,74,29,81,20,82,12,77,11,70,13,66,20,59,27,55,9,54,2,50,1,42,2,40,8,37,32,36,19,29,12,22,10,17],"flower3bud":[4,4,8,1,13,0,22,1,30,7,30,11,27,14,27,16,21,20,8,21,4,19,1,15,1,7],"flower2leafstalk":[2,2,4,1,4,5,10,19,14,47,20,36,22,36,25,33,36,31,39,29,37,40,31,48,27,50,18,50,14,48,17,76,16,86,13,79,7,29,3,12,0,6],"flower3petals":[33,33,36,34,36,32,32,29,29,22,27,21,25,15,25,9,29,2,38,1,43,5,46,11,48,27,52,15,57,10,65,8,71,12,72,23,65,33,74,30,81,30,86,32,91,40,90,45,87,49,81,52,68,52,75,60,77,66,76,74,73,77,68,79,61,78,57,76,49,68,42,82,34,89,28,89,27,87,25,87,23,83,23,75,28,66,18,69,7,69,3,66,4,56,8,52,16,50,17,48,11,47,3,41,1,37,2,28,6,25,14,24,21,26,24,29],"flower3stalk":[9,9,12,1,14,0,12,21,7,33,7,51,12,70,7,80,5,81,5,66,1,53,1,37,6,20,6,11,8,11],"furforehead":[6,6,6,4,29,0,22,9,13,26,7,46,1,43,1,40,7,29,9,19,8,10],"furtailbottom":[70,70,77,48,95,15,123,1,120,7,118,8,117,12,115,13,114,17,112,18,102,38,102,41,99,45,93,63,87,96,88,139,94,168,103,195,122,235,124,236,126,242,128,243,130,249,137,258,147,277,147,280,151,286,151,289,153,291,160,311,167,345,167,384,160,413,148,438,141,446,141,448,137,451,137,453,116,473,114,473,101,483,85,491,65,498,38,503,8,503,8,500,4,494,1,485,19,485,30,483,56,473,57,471,61,470,62,468,70,464,73,460,75,460,86,449,86,447,89,445,89,443,96,435,106,413,112,387,114,365,113,330,118,338,119,344,122,349,126,368,126,378,128,376,130,367,131,341,127,316,123,306,123,302,120,297,117,286,115,284,115,281,110,273,110,270,82,215,82,212,80,210,80,207,78,205,71,185,67,169,63,142,63,106,65,90],"furtailshadow":[49,49,50,38,57,55,58,63,60,63,67,52,73,22,78,7,81,3,85,37,95,72,96,93,93,109,88,120,88,123,78,143,76,144,75,148,73,149,69,157,81,149,87,147,91,148,80,162,74,174,67,212,62,224,58,229,72,228,84,225,86,223,87,224,76,233,62,240,48,244,41,244,26,207,33,165,13,156,0,143,0,141,3,123,11,116,14,109,16,108,23,89,24,71,22,60,18,50,24,52,30,58,32,58,40,67,46,78,49,59],"furtailshadow2":[36,36,40,34,42,31,44,31,46,28,48,28,50,25,52,25,54,22,56,22,58,19,60,19,62,16,64,16,66,13,68,13,70,10,72,10,74,7,76,7,78,4,84,1,75,19,72,32,64,53,65,55,91,29,93,29,94,27,98,26,99,24,103,23,107,19,111,18,112,16,126,8,115,30,115,33,106,49,106,52,96,61,96,63,89,69,89,71,85,74,85,76,76,86,76,88,64,104,63,108,61,109,60,113,58,114,57,118,55,119,48,134,48,124,53,99,57,87,65,72,56,74,44,80,26,96,25,93,28,83,34,71,39,66,39,64,20,72,2,86,7,77,9,76,9,74,11,73,11,71,13,70,13,68,15,67,15,65,17,64,18,60,24,53,24,51,32,41,32,39],"furtorso2":[150,150,161,147,163,145,166,145,179,139,180,137,192,131,199,124,201,124,211,111,216,97,215,77,207,62,199,54,197,54,195,51,187,47,180,45,169,45,172,35,172,17,169,1,175,1,188,7,202,20,202,22,207,26,207,28,210,30,210,32,213,34,213,36,215,37,215,39,218,41,221,48,225,52,226,56,228,57,229,61,232,64,231,67,241,63,250,63,258,66,264,74,263,88,250,107,242,111,235,111,227,107,224,107,223,113,221,115,219,124,214,135,213,146,218,144,233,160,233,162,235,163,239,172,242,175,242,178,248,190,251,206,248,225,282,256,281,260,279,261,276,268,274,269,271,276,266,282,267,286,270,288,270,290,273,292,276,298,286,309,286,313,283,315,283,317,279,319,276,323,274,323,272,326,243,340,211,349,208,339,204,336,196,339,177,339,166,337,104,309,34,293,17,285,3,273,1,269,1,258,5,250,7,249,5,243,5,236,11,222,20,213,24,204,34,197,46,198,55,203,59,208,62,208,62,205,79,172,79,166,83,151,85,147,89,145,107,149,129,151,116,177,113,178,112,172,108,180,108,183,105,186,101,195,99,194,98,189,86,207,84,222,86,228,86,243,89,250,93,255,100,259,117,259,126,261,137,266,140,266,156,275,162,243,157,197,146,197,144,195,144,188,140,190,144,169,142,169,139,173,136,174,142,157,147,151],"furtail":[70,70,75,65,75,63,86,53,86,51,89,48,91,48,101,37,103,37,111,29,113,29,119,23,121,23,122,21,124,21,125,19,127,19,135,13,136,15,133,18,122,41,116,60,115,70,138,45,140,45,146,38,148,38,159,28,161,28,171,20,177,18,178,16,198,6,213,1,213,3,209,6,209,8,206,10,204,15,198,22,197,26,195,27,179,64,171,104,171,141,177,173,184,193,186,195,186,198,199,224,201,225,207,238,209,239,214,250,219,256,226,271,228,272,246,311,251,328,254,346,253,386,245,416,235,437,233,438,232,442,225,450,225,452,221,455,221,457,205,473,203,473,200,477,198,477,196,480,194,480,184,488,168,496,151,502,131,506,107,506,90,501,87,485,85,482,81,466,64,429,62,428,61,424,59,423,51,409,45,403,45,401,32,388,33,332,30,314,24,297,20,292,19,288,11,279,11,277,1,268,10,239,24,236,40,229,42,226,45,225,45,223,49,219,51,212,51,203,45,185,49,153,49,128,46,105,50,100,51,96,53,95,54,91,58,87,58,85,61,83,63,78],"hairshadow":[1,1,15,17,30,24,44,24,52,21,53,19,61,15,81,8,105,8,130,33,127,33,114,26,91,23,77,25,74,27,67,28,65,30,61,30,46,35,23,36,13,32,6,24,3,16],"hardhat":[8,8,14,0,31,3,50,1,80,1,114,6,123,9,139,18,154,35,162,52,167,72,167,101,160,126,143,125,135,128,129,116,127,115,121,104,118,102,116,97,109,90,109,88,82,60,80,60,72,52,70,52,64,46,49,38,48,36,18,22,2,18,1,16],"hardhatshadow1":[1,1,3,0,20,7,27,15,31,23,39,55,39,81,37,78,32,57,24,41,24,38,20,33,17,25,13,21,12,17,10,16,10,14,1,4],"irisleft":[6,6,11,1,16,1,19,5,19,18,15,30,12,30,0,23,3,10],"hardhatshadow2":[1,1,21,4,39,12,44,17,46,17,60,33,70,56,74,77,74,95,69,120,52,122,52,113,56,98,56,77,53,62,43,38,41,37,37,29,34,27,34,25,21,12],"irisright":[10,10,16,3,25,0,31,3,35,13,35,30,31,50,18,57,8,57,4,55,0,50,2,28,6,16],"grass":[63,63,64,41,67,27,71,15,73,13,74,38,79,61,86,81,96,101,102,108,100,79,94,49,103,59,103,61,109,68,110,72,112,73,127,105,127,86,129,76,135,61,137,60,138,56,144,49,141,64,141,86,145,107,148,113,150,93,158,72,162,96,168,110,170,111,174,82,174,47,177,53,179,54,181,61,185,67,193,99,203,78,216,64,220,62,217,71,215,85,217,109,223,83,230,69,238,60,235,73,235,94,238,110,241,117,246,111,249,104,251,103,254,96,256,95,257,91,261,87,262,83,264,82,265,78,269,74,277,59,279,62,283,83,285,111,287,108,290,93,299,77,303,74,301,92,305,112,307,111,310,102,312,101,313,97,318,92,318,90,331,77,333,77,335,74,341,71,342,88,339,102,340,105,359,83,369,64,372,72,378,104,380,107,381,94,384,84,393,68,399,63,393,80,393,100,396,110,399,106,404,89,406,68,408,70,409,76,413,84,419,110,430,87,438,78,438,76,446,69,443,80,443,104,445,107,448,94,451,88,453,87,454,83,464,72,466,72,468,69,472,67,468,75,463,93,462,113,464,119,471,105,471,102,473,100,479,83,485,57,485,50,488,53,494,73,497,99,500,91,502,76,501,52,509,70,514,98,521,83,528,75,528,73,541,61,552,55,547,66,542,85,543,108,546,96,551,85,553,84,558,74,571,60,572,62,570,69,570,87,572,98,574,97,589,70,595,53,597,40,599,39,600,68,597,80,598,84,598,82,605,74,612,60,617,44,618,33,620,38,622,55,623,84,625,72,630,57,633,53,633,50,638,40,642,35,639,82,641,135,646,127,654,104,659,83,662,54,665,62,668,82,668,116,674,108,674,106,676,105,676,103,678,102,688,83,688,80,690,78,690,75,695,64,699,47,699,41,701,42,705,67,705,109,708,106,715,91,724,80,724,78,750,50,751,52,748,58,748,62,745,68,739,92,736,113,741,109,741,107,750,97,751,93,753,92,754,88,756,87,759,81,763,68,765,69,765,89,761,110,765,107,765,105,772,97,780,80,784,57,788,66,791,79,792,103,801,90,806,71,807,3,809,3,812,12,821,48,825,75,826,100,834,69,842,53,844,52,848,44,852,41,847,62,847,90,853,113,858,107,858,105,871,92,873,92,874,90,876,90,877,88,881,87,884,84,897,80,890,101,890,117,902,103,910,89,917,68,919,49,921,53,924,74,923,103,935,77,937,76,938,72,940,71,944,63,949,58,944,71,940,89,939,122,941,122,950,112,961,92,966,69,965,54,971,72,973,101,983,79,991,70,991,68,996,64,990,77,986,96,993,88,1001,71,1005,50,1006,115,1017,89,1019,88,1024,78,1035,67,1037,63,1038,64,1035,67,1029,80,1026,93,1026,107,1033,93,1035,92,1036,88,1041,83,1041,81,1044,79,1044,77,1061,60,1063,60,1069,54,1087,44,1096,41,1084,53,1084,55,1080,58,1080,60,1077,62,1072,72,1070,73,1060,95,1057,109,1081,84,1083,84,1092,76,1105,71,1116,71,1108,82,1101,107,1098,137,1096,205,16,205,1,97,42,139,43,137,34,101,28,84,20,69,10,56,16,59,21,64,23,64,25,67,27,67,37,77,39,77,59,97,59,99,71,112,64,85],"mouth":[11,11,16,6,27,0,46,3,70,14,79,22,81,22,84,26,86,26,96,36,106,33,121,25,122,23,137,16,154,16,167,19,177,24,188,37,191,47,190,74,183,87,172,98,170,98,163,104,153,109,132,116,114,119,90,119,74,115,69,111,62,113,52,113,42,110,35,104,33,104,23,92,14,72,12,71,9,65,9,62,3,50,1,42,1,28,5,17],"overalls1":[5,5,5,0,22,0,45,4,64,12,83,27,135,44,149,45,159,43,165,40,165,42,171,49,176,61,170,65,79,67,54,64,20,56,1,49],"overalls2":[3,3,29,10,58,12,60,11,63,2,76,0,79,16,72,44,64,41,63,39,51,33,8,24,0,6,1,3],"overalls3":[20,20,36,5,45,1,56,0,60,2,60,4,65,8,65,10,71,15,71,17,76,22,63,18,51,19,43,22,42,24,34,28,32,31,30,31,18,43,17,46,1,45],"pantsleftshadow":[43,43,43,38,52,33,61,22,67,1,73,22,68,37,66,39,58,66,56,68,48,91,43,95,39,96,38,98,30,101,30,81,26,75,26,72,24,71,16,57,14,56,13,52,11,51,11,49,9,48,1,34,7,34,12,36,31,54,38,54,42,50],"background":[0,0,1068,0,1068,909,0,909],"overalls4":[20,20,27,13,27,11,32,6,34,6,39,0,54,2,42,16,35,30,33,31,32,36,26,47,20,65,20,69,17,69,0,64,0,62,7,41],"overallsshadow":[4,4,8,1,28,1,42,23,32,22,25,18,11,20,15,16,17,16,19,12,16,9,10,7,3,7,2,5],"pants":[33,33,34,29,41,22,50,18,62,18,67,20,92,46,94,46,97,50,99,50,101,53,105,54,110,58,119,61,134,63,154,62,206,53,256,39,258,37,267,35,286,26,289,26,313,14,314,12,318,11,326,1,328,1,334,20,336,33,336,52,340,64,345,69,353,71,360,69,373,61,384,62,391,70,398,84,398,115,392,134,387,143,385,144,385,146,383,147,383,149,381,150,380,154,378,155,375,162,373,173,368,180,364,180,362,178,361,174,358,172,358,170,352,163,340,169,339,171,320,179,301,180,287,176,273,168,263,158,261,158,239,133,237,133,228,125,220,122,153,120,135,121,131,123,127,128,111,176,109,178,107,187,101,200,94,207,82,210,83,193,81,185,70,164,65,159,65,157,58,149,58,147,55,145,55,143,48,136,48,134,44,131,44,129,36,121,33,115,29,112,29,110,21,102,18,96,14,93,14,91,9,87,9,85,4,80,1,79,9,79,8,74,10,70,13,68,20,67,27,69,28,44,30,37],"pantsrightshadow1":[42,42,72,12,74,6,77,3,75,12,68,27,66,28,65,32,63,33,59,41,56,43,56,45,45,57,42,64,43,76,53,101,1,63,1,61,10,58],"pantsrightshadow2":[13,13,10,6,4,1,11,1,15,3,19,10,30,59,32,81,35,91,40,97,44,97,51,91,51,89,57,82,60,74,64,76,68,76,69,74,71,74,78,65,80,59,82,60,83,65,89,72,94,73,97,71,96,86,88,89,79,89,74,96,69,96,52,114,50,114,47,117,37,117,34,114,32,114,25,103,20,83,17,29],"outlines_fg":[153,153,159,140,153,137,151,134,149,134,139,123,134,110,134,98,135,94,140,94,144,97,147,97,147,76,153,65,157,62,161,63,164,66,169,80,174,79,178,69,184,63,193,59,264,58,290,62,310,69,313,72,320,75,336,90,336,92,342,98,343,102,345,102,354,86,357,84,357,82,363,76,363,74,367,71,367,69,372,65,372,63,400,36,402,36,405,32,407,32,413,26,415,26,425,18,429,17,430,15,434,13,439,13,441,19,437,23,435,29,433,30,429,38,422,59,442,40,444,40,447,36,449,36,451,33,453,33,455,30,457,30,470,20,511,0,515,0,518,2,519,7,512,16,512,18,510,19,510,21,508,22,508,24,506,25,506,27,504,28,503,32,501,33,493,49,484,75,478,106,478,148,484,177,489,188,490,194,494,200,494,203,501,217,503,218,506,226,508,227,510,233,512,234,516,243,518,244,527,262,529,263,532,271,534,272,545,294,545,297,548,301,548,304,550,306,556,323,562,354,562,382,559,401,551,427,538,452,530,461,530,463,526,466,526,468,511,483,509,483,498,493,477,505,448,515,430,518,413,518,397,514,398,531,400,537,404,541,412,541,425,533,436,531,442,533,450,541,456,553,482,553,488,555,491,559,494,579,495,604,492,613,488,616,490,644,489,670,484,686,481,689,478,696,461,711,447,716,428,716,416,712,415,710,408,707,402,701,395,687,394,669,398,657,407,646,404,646,403,648,399,649,398,651,388,656,376,660,359,661,349,659,331,651,321,642,319,642,289,609,287,609,281,604,270,601,191,601,185,609,166,666,157,682,145,689,134,689,129,685,126,685,124,695,120,703,111,711,99,716,82,715,69,706,69,704,64,700,64,698,61,696,57,688,51,682,49,677,37,663,35,658,32,656,30,651,27,649,22,639,18,635,17,631,15,630,4,607,0,591,0,578,6,563,16,554,26,550,52,549,62,551,62,547,67,542,80,541,80,520,83,509,87,502,93,496,101,492,118,492,116,478,119,473,119,443,121,427,107,424,105,422,98,420,97,418,93,417,83,407,78,395,78,384,80,375,79,364,82,355,88,349,95,345,103,331,110,324,117,321,125,321,135,325,140,330,143,330,149,316,151,315,152,311,160,301,160,291,162,283,165,278,149,276,137,268,132,258,130,257,128,251,126,250,124,245,117,239,111,228,111,225,106,214,103,199,103,189,106,177,110,169,119,160,132,155,152,158],"pantsrightshadow3":[19,19,56,1,63,28,65,58,68,61,70,61,73,65,75,65,77,68,81,68,83,66,86,66,99,60,112,59,122,77,124,90,123,98,121,100,117,100,111,94,107,86,100,100,98,100,95,103,87,102,82,113,73,123,65,123,59,108,56,79,44,32,39,28,2,28],"screwdriverhandle":[4,4,9,1,18,1,22,5,34,34,40,34,42,36,42,40,37,45,19,53,11,52,11,48,13,48,15,44,1,16,0,10,1,6],"screwdrivermetal":[1,1,6,0,9,2,26,37,28,38,33,36,37,47,36,52,30,54,19,43,21,38,18,32,16,31,15,27,9,20,9,18,3,12,1,7],"screwdrivershadow":[2,2,12,1,17,5,17,8,20,12,27,32,37,36,37,41,33,45,26,48,27,44,22,39,19,33,18,27,16,25,15,19,11,11,4,4,2,4],"shoeleft":[10,10,14,6,27,1,52,2,84,35,84,37,93,46,93,48,96,50,96,52,105,62,105,64,117,80,125,96,127,97,133,112,134,133,130,133,127,130,121,128,118,131,117,140,112,150,108,154,99,159,81,160,73,156,64,147,64,145,61,143,61,141,56,136,54,131,51,129,49,124,46,122,44,117,41,115,39,110,36,108,34,103,31,101,29,96,26,94,26,92,20,85,19,81,15,77,6,59,1,43,0,28,5,14],"shoeleftshadow":[1,1,4,4,6,4,16,15,21,25,23,26,25,32,27,33,30,41,35,47,36,51,41,56,41,58,46,62,47,65,49,65,52,69,56,71,60,71,65,63,74,61,80,63,89,70,94,70,96,68,98,87,96,88,82,86,78,103,56,115,58,103,36,83],"shoeright":[50,50,54,35,54,11,52,3,55,7,69,6,74,10,74,4,88,6,90,8,92,19,94,52,92,60,88,64,85,64,84,61,87,100,84,126,75,143,63,154,49,160,30,160,17,155,7,146,1,133,1,117,6,105,14,97,19,97,23,101,25,100,33,85,35,84,38,76,40,75],"outlines_bg":[103,103,103,91,110,83,112,83,114,80,122,76,128,74,137,74,136,59,139,51,147,42,159,37,171,37,181,40,188,44,190,29,198,15,207,7,223,1,241,2,255,9,265,20,270,32,270,37,264,21,251,8,238,3,221,3,215,5,206,10,196,21,191,32,190,47,173,39,158,39,146,45,138,58,138,72,140,76,124,77,113,83,106,90,104,94,104,101,108,108,118,113,127,113,137,110,146,104,149,104,150,109,152,110,154,115,162,122,180,129,200,130,213,127,223,122,224,120,229,118,233,113,253,123,273,125,285,123,297,118,303,112,306,104,317,109,331,110,341,106,345,102,348,96,348,90,345,83,340,78,327,73,314,72,312,70,311,62,308,55,297,44,287,40,274,40,269,42,268,40,270,38,288,38,300,43,309,52,313,60,314,68,316,70,328,71,341,76,347,82,350,89,350,97,348,102,343,107,335,111,320,112,307,107,305,113,296,121,286,125,275,127,264,127,249,124,233,116,230,120,216,128,200,132,186,132,170,128,159,122,151,114,151,112,148,109,148,106,131,114,119,115,109,111],"shoerightshadow":[66,66,67,55,64,29,58,10,53,2,57,0,64,0,69,2,73,6,76,13,83,113,78,123,76,124,70,138,66,139,65,141,58,144,57,146,55,146,54,148,50,149,49,151,42,155,37,155,9,148,7,146,1,128,7,134,14,136,22,136,33,133,50,122,57,108,59,85,64,78],"stripechest":[28,28,29,24,30,28,32,28,33,25,36,23,44,9,46,1,64,0,64,2,59,7,54,20,54,24,61,20,57,40,61,40,63,47,66,51,66,54,73,67,73,70,77,76,79,90,83,90,73,126,65,120,61,119,60,117,42,110,24,107,14,107,8,103,5,97,1,74,2,61,10,45,16,40,17,47,26,29],"stripetail":[48,48,50,40,57,33,57,31,74,14,76,14,83,7,94,1,93,4,90,6,89,10,87,11,86,15,84,16,79,26,79,29,76,33,71,48,66,73,66,110,71,135,75,144,76,108,79,91,83,79,86,73,88,72,88,102,93,123,96,128,99,89,107,52,119,23,121,22,122,18,124,17,128,9,131,7,126,32,127,67,133,97,151,153,154,171,154,194,152,208,147,226,145,228,145,231,142,235,140,242,138,243,136,249,130,256,130,258,127,260,127,262,135,258,138,258,139,256,148,252,155,245,157,245,170,230,167,242,161,254,157,258,155,263,151,266,151,268,134,285,132,285,128,290,126,290,118,298,112,301,118,302,128,299,140,293,141,291,143,291,144,289,146,289,147,287,149,287,151,284,158,280,154,299,147,312,137,323,135,323,126,331,111,338,88,344,80,343,76,335,73,333,67,322,64,320,60,312,57,310,53,302,50,300,46,292,43,290,43,288,35,278,33,260,25,226,15,196,15,192,1,153,10,121,39,115,44,66]}')},9:function(e,t,i){"use strict";function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}i.d(t,"a",(function(){return a}));var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,i,a;return t=e,a=[{key:"constrain",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return e>i&&(e=i),e<t&&(e=t),e}},{key:"loopSum",value:function(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return t>0?(t+(e-n))%(i+1-n)+n:i-(Math.abs(t)+(i-e))%(i+1-n)}},{key:"loopDif",value:function(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=Math.abs(i-e)<Math.abs(i-t)?e:t,o=Math.abs(n-e)<Math.abs(n-t)?e:t,s=t-e,r=i-a+(o-n),l=Math.abs(s);return r<l?e==a?r:-r:s}},{key:"bounceSum",value:function(e,t,i){for(var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=e+t;a>i||a<n;)a>i&&(a=i-(a-i)),a<=n&&(a=n+(n-a));return a}},{key:"toRadians",value:function(e){return e*(Math.PI/180)}},{key:"toDegrees",value:function(e){return 180*e/Math.PI}},{key:"hexToInt",value:function(e){var t="string"==typeof e?e.replace("#","0x"):e;return parseInt(t)}},{key:"polarAngle",value:function(e,t){var i=Math.atan2(t,e);return e>=0&&t<=0?i+=Math.PI/2:e<=0&&t<0?i+=2.5*Math.PI:e<=0&&t>=0?i+=Math.PI/2:e>=0&&t>=0&&(i+=Math.PI/2),this.toDegrees(i)}},{key:"distance",value:function(e,t){var i=e.x-t.x,n=e.y-t.y;return Math.sqrt(i*i+n*n)}}],(i=null)&&n(t.prototype,i),a&&n(t,a),e}()}});